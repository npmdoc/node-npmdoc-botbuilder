<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/Microsoft/BotBuilder#readme"

    >botbuilder (v3.7.0)</a>
</h1>
<h4>Bot Builder is a dialog system for building rich bots on virtually any platform.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder">module botbuilder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AnimationCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>AnimationCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AudioCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>AudioCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>BotConnectorBot
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardAction
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardImage
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardMedia
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector">
            function <span class="apidocSignatureSpan">botbuilder.</span>ChatConnector
            <span class="apidocSignatureSpan">(settings)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>CommandDialog
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector">
            function <span class="apidocSignatureSpan">botbuilder.</span>ConsoleConnector
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>Dialog
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction">
            function <span class="apidocSignatureSpan">botbuilder.</span>DialogAction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>EntityRecognizer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact">
            function <span class="apidocSignatureSpan">botbuilder.</span>Fact
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.HeroCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>HeroCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>IntentDialog
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet">
            function <span class="apidocSignatureSpan">botbuilder.</span>IntentRecognizerSet
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Keyboard">
            function <span class="apidocSignatureSpan">botbuilder.</span>Keyboard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library">
            function <span class="apidocSignatureSpan">botbuilder.</span>Library
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>LuisDialog
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>LuisRecognizer
            <span class="apidocSignatureSpan">(models)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>MediaCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MemoryBotStorage">
            function <span class="apidocSignatureSpan">botbuilder.</span>MemoryBotStorage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message">
            function <span class="apidocSignatureSpan">botbuilder.</span>Message
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Middleware">
            function <span class="apidocSignatureSpan">botbuilder.</span>Middleware
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts">
            function <span class="apidocSignatureSpan">botbuilder.</span>Prompts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem">
            function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptItem
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.RegExpRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>RegExpRecognizer
            <span class="apidocSignatureSpan">(intent, expressions)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session">
            function <span class="apidocSignatureSpan">botbuilder.</span>Session
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SigninCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>SigninCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>SimpleDialog
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimplePromptRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>SimplePromptRecognizer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>TextBot
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>ThumbnailCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>UniversalBot
            <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.VideoCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>VideoCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>AnimationCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>AttachmentLayout</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>AudioCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>BotConnectorBot.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>CardAction.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>CardImage.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>CardMedia.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Channel</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ChatConnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>CommandDialog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ConsoleConnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>DefaultLocalizer</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Dialog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Fact.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>HeroCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>IntentDialog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>IntentRecognizerSet.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Keyboard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Library.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ListStyle</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>LuisDialog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>LuisRecognizer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>MediaCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>MemoryBotStorage.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Message.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>PromptType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Prompts.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ReceiptCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ReceiptItem.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>RecognizeMode</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>RecognizeOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>RegExpRecognizer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ResumeReason</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>Session.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>SigninCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>SimpleDialog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>SimplePromptRecognizer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>TextBot.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>TextFormat</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>ThumbnailCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>UniversalBot.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>VideoCard.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>logger</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.AnimationCard">module botbuilder.AnimationCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AnimationCard.AnimationCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>AnimationCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.AnimationCard.prototype">module botbuilder.AnimationCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AnimationCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.AnimationCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.AudioCard">module botbuilder.AudioCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AudioCard.AudioCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>AudioCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.AudioCard.prototype">module botbuilder.AudioCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.AudioCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.AudioCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.BotConnectorBot">module botbuilder.BotConnectorBot</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.BotConnectorBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>BotConnectorBot
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.BotConnectorBot.prototype">module botbuilder.BotConnectorBot.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.add">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>add
            <span class="apidocSignatureSpan">(id, dialog)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.beginDialog">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>beginDialog
            <span class="apidocSignatureSpan">(address, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.configure">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>configure
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.listen">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>listen
            <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.on">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>on
            <span class="apidocSignatureSpan">(event, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.BotConnectorBot.prototype.verifyBotFramework">
            function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>verifyBotFramework
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardAction">module botbuilder.CardAction</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.CardAction">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardAction
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.call">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>call
            <span class="apidocSignatureSpan">(session, number, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.dialogAction">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>dialogAction
            <span class="apidocSignatureSpan">(session, action, data, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.downloadFile">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>downloadFile
            <span class="apidocSignatureSpan">(session, url, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.imBack">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>imBack
            <span class="apidocSignatureSpan">(session, msg, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.openUrl">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>openUrl
            <span class="apidocSignatureSpan">(session, url, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.playAudio">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>playAudio
            <span class="apidocSignatureSpan">(session, url, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.playVideo">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>playVideo
            <span class="apidocSignatureSpan">(session, url, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.postBack">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>postBack
            <span class="apidocSignatureSpan">(session, msg, title)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.showImage">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>showImage
            <span class="apidocSignatureSpan">(session, url, title)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardAction.prototype">module botbuilder.CardAction.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.prototype.image">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>image
            <span class="apidocSignatureSpan">(url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.prototype.title">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>title
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.prototype.toAction">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>toAction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.prototype.type">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>type
            <span class="apidocSignatureSpan">(t)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardAction.prototype.value">
            function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>value
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardImage">module botbuilder.CardImage</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.CardImage">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardImage
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.create">
            function <span class="apidocSignatureSpan">botbuilder.CardImage.</span>create
            <span class="apidocSignatureSpan">(session, url)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardImage.prototype">module botbuilder.CardImage.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.prototype.alt">
            function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>alt
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.prototype.tap">
            function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>tap
            <span class="apidocSignatureSpan">(action)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.prototype.toImage">
            function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>toImage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardImage.prototype.url">
            function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>url
            <span class="apidocSignatureSpan">(u)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardMedia">module botbuilder.CardMedia</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia.CardMedia">
            function <span class="apidocSignatureSpan">botbuilder.</span>CardMedia
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia.create">
            function <span class="apidocSignatureSpan">botbuilder.CardMedia.</span>create
            <span class="apidocSignatureSpan">(session, url)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CardMedia.prototype">module botbuilder.CardMedia.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia.prototype.profile">
            function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>profile
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia.prototype.toMedia">
            function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>toMedia
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CardMedia.prototype.url">
            function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>url
            <span class="apidocSignatureSpan">(u)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Channel">module botbuilder.Channel</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Channel.getChannelId">
            function <span class="apidocSignatureSpan">botbuilder.Channel.</span>getChannelId
            <span class="apidocSignatureSpan">(addressable)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Channel.supportsCardActions">
            function <span class="apidocSignatureSpan">botbuilder.Channel.</span>supportsCardActions
            <span class="apidocSignatureSpan">(session, buttonCnt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Channel.supportsKeyboards">
            function <span class="apidocSignatureSpan">botbuilder.Channel.</span>supportsKeyboards
            <span class="apidocSignatureSpan">(session, buttonCnt)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.Channel.</span>channels</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ChatConnector">module botbuilder.ChatConnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.ChatConnector">
            function <span class="apidocSignatureSpan">botbuilder.</span>ChatConnector
            <span class="apidocSignatureSpan">(settings)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ChatConnector.prototype">module botbuilder.ChatConnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.addAccessToken">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>addAccessToken
            <span class="apidocSignatureSpan">(options, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.addUserAgent">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>addUserAgent
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.authenticatedRequest">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>authenticatedRequest
            <span class="apidocSignatureSpan">(options, callback, refresh)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.dispatch">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>dispatch
            <span class="apidocSignatureSpan">(msg, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.getAccessToken">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getAccessToken
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.getData">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getData
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.getStoragePath">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getStoragePath
            <span class="apidocSignatureSpan">(address)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.isInvoke">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>isInvoke
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.listen">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>listen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.onEvent">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>onEvent
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.onInvoke">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>onInvoke
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.postMessage">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>postMessage
            <span class="apidocSignatureSpan">(msg, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.prepIncomingMessage">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>prepIncomingMessage
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.prepOutgoingMessage">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>prepOutgoingMessage
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.saveData">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>saveData
            <span class="apidocSignatureSpan">(context, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.send">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>send
            <span class="apidocSignatureSpan">(messages, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.startConversation">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>startConversation
            <span class="apidocSignatureSpan">(address, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ChatConnector.prototype.verifyBotFramework">
            function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>verifyBotFramework
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CommandDialog">module botbuilder.CommandDialog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.CommandDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>CommandDialog
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.CommandDialog.prototype">module botbuilder.CommandDialog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>constructor
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.matches">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>matches
            <span class="apidocSignatureSpan">(patterns, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.onBegin">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>onBegin
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.onDefault">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>onDefault
            <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.CommandDialog.prototype.replyReceived">
            function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>replyReceived
            <span class="apidocSignatureSpan">(session, recognizeResult)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ConsoleConnector">module botbuilder.ConsoleConnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.ConsoleConnector">
            function <span class="apidocSignatureSpan">botbuilder.</span>ConsoleConnector
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ConsoleConnector.prototype">module botbuilder.ConsoleConnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.listen">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>listen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.onEvent">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>onEvent
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.onInvoke">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>onInvoke
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.processMessage">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>processMessage
            <span class="apidocSignatureSpan">(line)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.send">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>send
            <span class="apidocSignatureSpan">(messages, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ConsoleConnector.prototype.startConversation">
            function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>startConversation
            <span class="apidocSignatureSpan">(address, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.DefaultLocalizer">module botbuilder.DefaultLocalizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DefaultLocalizer.DefaultLocalizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>DefaultLocalizer
            <span class="apidocSignatureSpan">(root, defaultLocale)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Dialog">module botbuilder.Dialog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog.Dialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>Dialog
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Dialog.prototype">module botbuilder.Dialog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>constructor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Dialog.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.DialogAction">module botbuilder.DialogAction</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction.DialogAction">
            function <span class="apidocSignatureSpan">botbuilder.</span>DialogAction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction.beginDialog">
            function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>beginDialog
            <span class="apidocSignatureSpan">(id, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction.endDialog">
            function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>endDialog
            <span class="apidocSignatureSpan">(result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction.send">
            function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>send
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.DialogAction.validatedPrompt">
            function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>validatedPrompt
            <span class="apidocSignatureSpan">(promptType, validator)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.EntityRecognizer">module botbuilder.EntityRecognizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.EntityRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>EntityRecognizer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.expandChoices">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>expandChoices
            <span class="apidocSignatureSpan">(choices)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.findAllEntities">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findAllEntities
            <span class="apidocSignatureSpan">(entities, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.findAllMatches">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findAllMatches
            <span class="apidocSignatureSpan">(choices, utterance, threshold)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.findBestMatch">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findBestMatch
            <span class="apidocSignatureSpan">(choices, utterance, threshold)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.findEntity">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findEntity
            <span class="apidocSignatureSpan">(entities, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.parseBoolean">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseBoolean
            <span class="apidocSignatureSpan">(utterance)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.parseNumber">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseNumber
            <span class="apidocSignatureSpan">(entities)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.parseTime">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseTime
            <span class="apidocSignatureSpan">(entities)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.recognizeTime">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>recognizeTime
            <span class="apidocSignatureSpan">(utterance, refDate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.EntityRecognizer.resolveTime">
            function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>resolveTime
            <span class="apidocSignatureSpan">(entities)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>dateExp</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>noExp</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>numberExp</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>yesExp</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>ordinalWords</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Fact">module botbuilder.Fact</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact.Fact">
            function <span class="apidocSignatureSpan">botbuilder.</span>Fact
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact.create">
            function <span class="apidocSignatureSpan">botbuilder.Fact.</span>create
            <span class="apidocSignatureSpan">(session, value, key)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Fact.prototype">module botbuilder.Fact.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact.prototype.key">
            function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>key
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact.prototype.toFact">
            function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>toFact
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Fact.prototype.value">
            function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>value
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.HeroCard">module botbuilder.HeroCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.HeroCard.HeroCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>HeroCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.HeroCard.prototype">module botbuilder.HeroCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.HeroCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.HeroCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.IntentDialog">module botbuilder.IntentDialog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.IntentDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>IntentDialog
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.IntentDialog.prototype">module botbuilder.IntentDialog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>constructor
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.emitError">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>emitError
            <span class="apidocSignatureSpan">(session, err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.invokeIntent">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>invokeIntent
            <span class="apidocSignatureSpan">(session, recognizeResult)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.matches">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>matches
            <span class="apidocSignatureSpan">(intent, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.matchesAny">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>matchesAny
            <span class="apidocSignatureSpan">(intents, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.onBegin">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>onBegin
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.onDefault">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>onDefault
            <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.recognizer">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>recognizer
            <span class="apidocSignatureSpan">(plugin)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentDialog.prototype.replyReceived">
            function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>replyReceived
            <span class="apidocSignatureSpan">(session, recognizeResult)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.IntentRecognizerSet">module botbuilder.IntentRecognizerSet</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.IntentRecognizerSet">
            function <span class="apidocSignatureSpan">botbuilder.</span>IntentRecognizerSet
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.IntentRecognizerSet.prototype">module botbuilder.IntentRecognizerSet.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.clone">
            function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>clone
            <span class="apidocSignatureSpan">(copyTo)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInParallel">
            function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizeInParallel
            <span class="apidocSignatureSpan">(context, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInSeries">
            function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizeInSeries
            <span class="apidocSignatureSpan">(context, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizer">
            function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizer
            <span class="apidocSignatureSpan">(plugin)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Keyboard">module botbuilder.Keyboard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Keyboard.Keyboard">
            function <span class="apidocSignatureSpan">botbuilder.</span>Keyboard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Keyboard.prototype">module botbuilder.Keyboard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Keyboard.prototype.buttons">
            function <span class="apidocSignatureSpan">botbuilder.Keyboard.prototype.</span>buttons
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Keyboard.prototype.toAttachment">
            function <span class="apidocSignatureSpan">botbuilder.Keyboard.prototype.</span>toAttachment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Library">module botbuilder.Library</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">botbuilder.Library.</span>usingDomains</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.Library">
            function <span class="apidocSignatureSpan">botbuilder.</span>Library
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.EventEmitter">
            function <span class="apidocSignatureSpan">botbuilder.Library.</span>EventEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.addRouteResult">
            function <span class="apidocSignatureSpan">botbuilder.Library.</span>addRouteResult
            <span class="apidocSignatureSpan">(route, current)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.bestRouteResult">
            function <span class="apidocSignatureSpan">botbuilder.Library.</span>bestRouteResult
            <span class="apidocSignatureSpan">(routes, dialogStack, rootLibraryName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.init">
            function <span class="apidocSignatureSpan">botbuilder.Library.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.listenerCount">
            function <span class="apidocSignatureSpan">botbuilder.Library.</span>listenerCount
            <span class="apidocSignatureSpan">(emitter, type)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">botbuilder.Library.</span>defaultMaxListeners</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.Library.</span>RouteTypes</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Library.prototype">module botbuilder.Library.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.beginDialogAction">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>beginDialogAction
            <span class="apidocSignatureSpan">(name, id, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.clone">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>clone
            <span class="apidocSignatureSpan">(copyTo, newName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>constructor
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.defaultFindRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>defaultFindRoutes
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.defaultSelectRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>defaultSelectRoute
            <span class="apidocSignatureSpan">(session, route)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.dialog">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>dialog
            <span class="apidocSignatureSpan">(id, dialog)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.endConversationAction">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>endConversationAction
            <span class="apidocSignatureSpan">(name, msg, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.findActiveDialogRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findActiveDialogRoutes
            <span class="apidocSignatureSpan">(context, callback, dialogStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.findDialog">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findDialog
            <span class="apidocSignatureSpan">(libName, dialogId)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.findGlobalActionRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findGlobalActionRoutes
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.findRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findRoutes
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.findStackActionRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findStackActionRoutes
            <span class="apidocSignatureSpan">(context, callback, dialogStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.forEachDialog">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>forEachDialog
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.forEachLibrary">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>forEachLibrary
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.library">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>library
            <span class="apidocSignatureSpan">(lib)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.libraryList">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>libraryList
            <span class="apidocSignatureSpan">(reverse)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.localePath">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>localePath
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.onFindRoutes">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>onFindRoutes
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.onSelectRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>onSelectRoute
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.recognizer">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>recognizer
            <span class="apidocSignatureSpan">(plugin)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.selectActiveDialogRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectActiveDialogRoute
            <span class="apidocSignatureSpan">(session, route, newStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.selectGlobalActionRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectGlobalActionRoute
            <span class="apidocSignatureSpan">(session, route)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.selectRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectRoute
            <span class="apidocSignatureSpan">(session, route)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Library.prototype.selectStackActionRoute">
            function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectStackActionRoute
            <span class="apidocSignatureSpan">(session, route, newStack)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.LuisDialog">module botbuilder.LuisDialog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.LuisDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>LuisDialog
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.LuisDialog.prototype">module botbuilder.LuisDialog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>constructor
            <span class="apidocSignatureSpan">(serviceUri)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.on">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>on
            <span class="apidocSignatureSpan">(intent, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.onBegin">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>onBegin
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.onDefault">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>onDefault
            <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisDialog.prototype.replyReceived">
            function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>replyReceived
            <span class="apidocSignatureSpan">(session, recognizeResult)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.LuisRecognizer">module botbuilder.LuisRecognizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisRecognizer.LuisRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>LuisRecognizer
            <span class="apidocSignatureSpan">(models)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisRecognizer.recognize">
            function <span class="apidocSignatureSpan">botbuilder.LuisRecognizer.</span>recognize
            <span class="apidocSignatureSpan">(utterance, modelUrl, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.LuisRecognizer.prototype">module botbuilder.LuisRecognizer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.LuisRecognizer.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.LuisRecognizer.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.MediaCard">module botbuilder.MediaCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.MediaCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>MediaCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.MediaCard.prototype">module botbuilder.MediaCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.autoloop">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>autoloop
            <span class="apidocSignatureSpan">(choice)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.autostart">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>autostart
            <span class="apidocSignatureSpan">(choice)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.image">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>image
            <span class="apidocSignatureSpan">(image)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.media">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>media
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.shareable">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>shareable
            <span class="apidocSignatureSpan">(choice)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.subtitle">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>subtitle
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.text">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>text
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MediaCard.prototype.title">
            function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>title
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.MemoryBotStorage">module botbuilder.MemoryBotStorage</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MemoryBotStorage.MemoryBotStorage">
            function <span class="apidocSignatureSpan">botbuilder.</span>MemoryBotStorage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.MemoryBotStorage.prototype">module botbuilder.MemoryBotStorage.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.deleteData">
            function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>deleteData
            <span class="apidocSignatureSpan">(context)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.getData">
            function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>getData
            <span class="apidocSignatureSpan">(context, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.saveData">
            function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>saveData
            <span class="apidocSignatureSpan">(context, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Message">module botbuilder.Message</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.Message">
            function <span class="apidocSignatureSpan">botbuilder.</span>Message
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.composePrompt">
            function <span class="apidocSignatureSpan">botbuilder.Message.</span>composePrompt
            <span class="apidocSignatureSpan">(session, prompts, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.randomPrompt">
            function <span class="apidocSignatureSpan">botbuilder.Message.</span>randomPrompt
            <span class="apidocSignatureSpan">(prompts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Message.prototype">module botbuilder.Message.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.addAttachment">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>addAttachment
            <span class="apidocSignatureSpan">(attachment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.addEntity">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>addEntity
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.address">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>address
            <span class="apidocSignatureSpan">(adr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.attachmentLayout">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>attachmentLayout
            <span class="apidocSignatureSpan">(style)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.attachments">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>attachments
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.compose">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>compose
            <span class="apidocSignatureSpan">(prompts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.composePrompt">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>composePrompt
            <span class="apidocSignatureSpan">(session, prompts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.entities">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>entities
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.ntext">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>ntext
            <span class="apidocSignatureSpan">(msg, msg_plural, count)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.setChannelData">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setChannelData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.setLanguage">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setLanguage
            <span class="apidocSignatureSpan">(local)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.setNText">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setNText
            <span class="apidocSignatureSpan">(session, msg, msg_plural, count)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.setText">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setText
            <span class="apidocSignatureSpan">(session, prompts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.sourceEvent">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>sourceEvent
            <span class="apidocSignatureSpan">(map)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.summary">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>summary
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.text">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>text
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.textFormat">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>textFormat
            <span class="apidocSignatureSpan">(style)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.textLocale">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>textLocale
            <span class="apidocSignatureSpan">(locale)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.timestamp">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>timestamp
            <span class="apidocSignatureSpan">(time)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.toMessage">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>toMessage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Message.prototype.upgradeAttachment">
            function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>upgradeAttachment
            <span class="apidocSignatureSpan">(a)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Middleware">module botbuilder.Middleware</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Middleware.Middleware">
            function <span class="apidocSignatureSpan">botbuilder.</span>Middleware
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Middleware.dialogVersion">
            function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>dialogVersion
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Middleware.firstRun">
            function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>firstRun
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Middleware.sendTyping">
            function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>sendTyping
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Prompts">module botbuilder.Prompts</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.Prompts">
            function <span class="apidocSignatureSpan">botbuilder.</span>Prompts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.attachment">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>attachment
            <span class="apidocSignatureSpan">(session, prompt, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.choice">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>choice
            <span class="apidocSignatureSpan">(session, prompt, choices, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.configure">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>configure
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.confirm">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>confirm
            <span class="apidocSignatureSpan">(session, prompt, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.disambiguate">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>disambiguate
            <span class="apidocSignatureSpan">(session, prompt, choices, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.number">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>number
            <span class="apidocSignatureSpan">(session, prompt, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.text">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>text
            <span class="apidocSignatureSpan">(session, prompt, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.time">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>time
            <span class="apidocSignatureSpan">(session, prompt, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.validateSession">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>validateSession
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.Prompts.</span>defaultRetryPrompt</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.Prompts.</span>options</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Prompts.prototype">module botbuilder.Prompts.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>constructor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.createPrompt">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>createPrompt
            <span class="apidocSignatureSpan">(session, args, retry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.replyReceived">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>replyReceived
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Prompts.prototype.sendPrompt">
            function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>sendPrompt
            <span class="apidocSignatureSpan">(session, args, retry)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ReceiptCard">module botbuilder.ReceiptCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.ReceiptCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ReceiptCard.prototype">module botbuilder.ReceiptCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.buttons">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>buttons
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.facts">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>facts
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.items">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>items
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.tap">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>tap
            <span class="apidocSignatureSpan">(action)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.tax">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>tax
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.title">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>title
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.toAttachment">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>toAttachment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.total">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>total
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptCard.prototype.vat">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>vat
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ReceiptItem">module botbuilder.ReceiptItem</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.ReceiptItem">
            function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptItem
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.create">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.</span>create
            <span class="apidocSignatureSpan">(session, price, title)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ReceiptItem.prototype">module botbuilder.ReceiptItem.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.image">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>image
            <span class="apidocSignatureSpan">(img)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.price">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>price
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.quantity">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>quantity
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.subtitle">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>subtitle
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.tap">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>tap
            <span class="apidocSignatureSpan">(action)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.text">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>text
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.title">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>title
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ReceiptItem.prototype.toItem">
            function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>toItem
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.RegExpRecognizer">module botbuilder.RegExpRecognizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.RegExpRecognizer.RegExpRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>RegExpRecognizer
            <span class="apidocSignatureSpan">(intent, expressions)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.RegExpRecognizer.prototype">module botbuilder.RegExpRecognizer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.RegExpRecognizer.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.RegExpRecognizer.prototype.</span>recognize
            <span class="apidocSignatureSpan">(context, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Session">module botbuilder.Session</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">botbuilder.Session.</span>usingDomains</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.Session">
            function <span class="apidocSignatureSpan">botbuilder.</span>Session
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.EventEmitter">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>EventEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.activeDialogStackEntry">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>activeDialogStackEntry
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.findDialogStackEntry">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>findDialogStackEntry
            <span class="apidocSignatureSpan">(stack, dialogId, reverse)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.forEachDialogStackEntry">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>forEachDialogStackEntry
            <span class="apidocSignatureSpan">(stack, reverse, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.init">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.listenerCount">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>listenerCount
            <span class="apidocSignatureSpan">(emitter, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.popDialogStackEntry">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>popDialogStackEntry
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.pruneDialogStack">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>pruneDialogStack
            <span class="apidocSignatureSpan">(stack, start)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.pushDialogStackEntry">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>pushDialogStackEntry
            <span class="apidocSignatureSpan">(stack, entry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.validateDialogStack">
            function <span class="apidocSignatureSpan">botbuilder.Session.</span>validateDialogStack
            <span class="apidocSignatureSpan">(stack, root)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">botbuilder.Session.</span>defaultMaxListeners</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.Session.prototype">module botbuilder.Session.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.beginDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>beginDialog
            <span class="apidocSignatureSpan">(id, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.cancelDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>cancelDialog
            <span class="apidocSignatureSpan">(dialogId, replaceWithId, replaceWithArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.clearDialogStack">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>clearDialogStack
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>constructor
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.createMessage">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>createMessage
            <span class="apidocSignatureSpan">(localizationNamespace, text, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.curDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>curDialog
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.curLibraryName">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>curLibraryName
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.deleteDialogs">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>deleteDialogs
            <span class="apidocSignatureSpan">(dialogId)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.dialogStack">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>dialogStack
            <span class="apidocSignatureSpan">(newStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.dispatch">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>dispatch
            <span class="apidocSignatureSpan">(sessionState, message, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.endConversation">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endConversation
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.endDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endDialog
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.endDialogWithResult">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endDialogWithResult
            <span class="apidocSignatureSpan">(result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.error">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>error
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.findDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>findDialog
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.getMessageReceived">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>getMessageReceived
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.gettext">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>gettext
            <span class="apidocSignatureSpan">(messageid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.isReset">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>isReset
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.messageSent">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>messageSent
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.ngettext">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>ngettext
            <span class="apidocSignatureSpan">(messageid, messageid_plural, count)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.popDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>popDialog
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.preferredLocale">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>preferredLocale
            <span class="apidocSignatureSpan">(locale, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.prepareMessage">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>prepareMessage
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.pushDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>pushDialog
            <span class="apidocSignatureSpan">(ds)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.replaceDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>replaceDialog
            <span class="apidocSignatureSpan">(id, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.reset">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>reset
            <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.resolveDialogId">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>resolveDialogId
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.routeToActiveDialog">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>routeToActiveDialog
            <span class="apidocSignatureSpan">(recognizeResult)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.save">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>save
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.send">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>send
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.sendBatch">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendBatch
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.sendLocalized">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendLocalized
            <span class="apidocSignatureSpan">(localizationNamespace, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.sendTyping">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendTyping
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.startBatch">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>startBatch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.toRecognizeContext">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>toRecognizeContext
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.validateCallstack">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>validateCallstack
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.Session.prototype.vgettext">
            function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>vgettext
            <span class="apidocSignatureSpan">(localizationNamespace, messageid, args)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SigninCard">module botbuilder.SigninCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SigninCard.SigninCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>SigninCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SigninCard.prototype">module botbuilder.SigninCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SigninCard.prototype.button">
            function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>button
            <span class="apidocSignatureSpan">(title, url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SigninCard.prototype.text">
            function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>text
            <span class="apidocSignatureSpan">(prompts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SigninCard.prototype.toAttachment">
            function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>toAttachment
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SimpleDialog">module botbuilder.SimpleDialog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog.SimpleDialog">
            function <span class="apidocSignatureSpan">botbuilder.</span>SimpleDialog
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SimpleDialog.prototype">module botbuilder.SimpleDialog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog.prototype.begin">
            function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>begin
            <span class="apidocSignatureSpan">(session, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>constructor
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog.prototype.dialogResumed">
            function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>dialogResumed
            <span class="apidocSignatureSpan">(session, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimpleDialog.prototype.replyReceived">
            function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>replyReceived
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SimplePromptRecognizer">module botbuilder.SimplePromptRecognizer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimplePromptRecognizer.SimplePromptRecognizer">
            function <span class="apidocSignatureSpan">botbuilder.</span>SimplePromptRecognizer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.SimplePromptRecognizer.prototype">module botbuilder.SimplePromptRecognizer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.SimplePromptRecognizer.prototype.recognize">
            function <span class="apidocSignatureSpan">botbuilder.SimplePromptRecognizer.prototype.</span>recognize
            <span class="apidocSignatureSpan">(args, callback, session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.TextBot">module botbuilder.TextBot</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.TextBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>TextBot
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.TextBot.prototype">module botbuilder.TextBot.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.add">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>add
            <span class="apidocSignatureSpan">(id, dialog)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.beginDialog">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>beginDialog
            <span class="apidocSignatureSpan">(address, dialogId, dialogArgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.configure">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>configure
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.listenStdin">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>listenStdin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.on">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>on
            <span class="apidocSignatureSpan">(event, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.TextBot.prototype.processMessage">
            function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>processMessage
            <span class="apidocSignatureSpan">(message, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ThumbnailCard">module botbuilder.ThumbnailCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.ThumbnailCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>ThumbnailCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.ThumbnailCard.prototype">module botbuilder.ThumbnailCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.images">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>images
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.subtitle">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>subtitle
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.tap">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>tap
            <span class="apidocSignatureSpan">(action)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.text">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>text
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.ThumbnailCard.prototype.title">
            function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>title
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.UniversalBot">module botbuilder.UniversalBot</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>usingDomains</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.UniversalBot">
            function <span class="apidocSignatureSpan">botbuilder.</span>UniversalBot
            <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.EventEmitter">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>EventEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.addRouteResult">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>addRouteResult
            <span class="apidocSignatureSpan">(route, current)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.bestRouteResult">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>bestRouteResult
            <span class="apidocSignatureSpan">(routes, dialogStack, rootLibraryName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.init">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.listenerCount">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>listenerCount
            <span class="apidocSignatureSpan">(emitter, type)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>defaultMaxListeners</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>RouteTypes</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.UniversalBot.prototype">module botbuilder.UniversalBot.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.beginDialog">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>beginDialog
            <span class="apidocSignatureSpan">(address, dialogId, dialogArgs, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.clone">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>clone
            <span class="apidocSignatureSpan">(copyTo, newName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.connector">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>connector
            <span class="apidocSignatureSpan">(channelId, connector)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>constructor
            <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.createSession">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>createSession
            <span class="apidocSignatureSpan">(storageCtx, message, dialogId, dialogArgs, done, newStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.dispatch">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>dispatch
            <span class="apidocSignatureSpan">(storageCtx, message, dialogId, dialogArgs, done, newStack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.emitError">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>emitError
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.ensureConversation">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>ensureConversation
            <span class="apidocSignatureSpan">(address, done, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.errorLogger">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>errorLogger
            <span class="apidocSignatureSpan">(done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.eventMiddleware">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>eventMiddleware
            <span class="apidocSignatureSpan">(event, middleware, done, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.get">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>get
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.getStorage">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>getStorage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.getStorageData">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>getStorageData
            <span class="apidocSignatureSpan">(storageCtx, done, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.isInConversation">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>isInConversation
            <span class="apidocSignatureSpan">(address, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.isMessage">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>isMessage
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.loadSession">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>loadSession
            <span class="apidocSignatureSpan">(address, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.lookupUser">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>lookupUser
            <span class="apidocSignatureSpan">(address, done, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.onDisambiguateRoute">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>onDisambiguateRoute
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.receive">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>receive
            <span class="apidocSignatureSpan">(events, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.routeMessage">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>routeMessage
            <span class="apidocSignatureSpan">(session, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.saveStorageData">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>saveStorageData
            <span class="apidocSignatureSpan">(storageCtx, data, done, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.send">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>send
            <span class="apidocSignatureSpan">(messages, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.set">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>set
            <span class="apidocSignatureSpan">(name, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.tryCatch">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>tryCatch
            <span class="apidocSignatureSpan">(fn, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.UniversalBot.prototype.use">
            function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>use
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.VideoCard">module botbuilder.VideoCard</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.VideoCard.VideoCard">
            function <span class="apidocSignatureSpan">botbuilder.</span>VideoCard
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.VideoCard.prototype">module botbuilder.VideoCard.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.VideoCard.prototype.aspect">
            function <span class="apidocSignatureSpan">botbuilder.VideoCard.prototype.</span>aspect
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.VideoCard.prototype.constructor">
            function <span class="apidocSignatureSpan">botbuilder.VideoCard.prototype.</span>constructor
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.logger">module botbuilder.logger</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.logger.debug">
            function <span class="apidocSignatureSpan">botbuilder.logger.</span>debug
            <span class="apidocSignatureSpan">(fmt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.logger.error">
            function <span class="apidocSignatureSpan">botbuilder.logger.</span>error
            <span class="apidocSignatureSpan">(fmt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.logger.info">
            function <span class="apidocSignatureSpan">botbuilder.logger.</span>info
            <span class="apidocSignatureSpan">(addressable, fmt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.logger.trace">
            function <span class="apidocSignatureSpan">botbuilder.logger.</span>trace
            <span class="apidocSignatureSpan">(fmt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.logger.warn">
            function <span class="apidocSignatureSpan">botbuilder.logger.</span>warn
            <span class="apidocSignatureSpan">(addressable, fmt)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.botbuilder.utils">module botbuilder.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.utils.clone">
            function <span class="apidocSignatureSpan">botbuilder.utils.</span>clone
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.utils.copyFieldsTo">
            function <span class="apidocSignatureSpan">botbuilder.utils.</span>copyFieldsTo
            <span class="apidocSignatureSpan">(frm, to, fields)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.utils.copyTo">
            function <span class="apidocSignatureSpan">botbuilder.utils.</span>copyTo
            <span class="apidocSignatureSpan">(frm, to)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.utils.moveFieldsTo">
            function <span class="apidocSignatureSpan">botbuilder.utils.</span>moveFieldsTo
            <span class="apidocSignatureSpan">(frm, to, fields)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.botbuilder.utils.toDate8601">
            function <span class="apidocSignatureSpan">botbuilder.utils.</span>toDate8601
            <span class="apidocSignatureSpan">(date)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder" id="apidoc.module.botbuilder">module botbuilder</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.AnimationCard" id="apidoc.element.botbuilder.AnimationCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>AnimationCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AnimationCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.animation&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.AudioCard" id="apidoc.element.botbuilder.AudioCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>AudioCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AudioCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.audio&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot" id="apidoc.element.botbuilder.BotConnectorBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>BotConnectorBot
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BotConnectorBot(options) {
    console.warn(&#x27;BotConnectorBot class is deprecated. Use UniversalBot with a ChatConnector class.&#x27;);
    var oConnector = {};
    var oBot = {};
    for (var key in options) {
        switch (key) {
            case &#x27;appId&#x27;:
                oConnector.appId = options.appId;
                break;
            case &#x27;appSecret&#x27;:
                oConnector.appPassword = options.appSecret;
                break;
            case &#x27;defaultDialogId&#x27;:
                oBot.defaultDialogId = options.defaultDialogId;
                break;
            case &#x27;defaultDialogArgs&#x27;:
                oBot.defaultDialogArgs = options.defaultDialogArgs;
                break;
            case &#x27;groupWelcomeMessage&#x27;:
                this.groupWelcomeMessage = options.groupWelcomeMessage;
                break;
            case &#x27;userWelcomeMessage&#x27;:
                this.userWelcomeMessage = options.userWelcomeMessage;
                break;
            case &#x27;goodbyeMessage&#x27;:
                this.goodbyeMessage = options.goodbyeMessage;
                break;
            case &#x27;userStore&#x27;:
            case &#x27;conversationStore&#x27;:
            case &#x27;perUserInConversationStore&#x27;:
                console.error(&#x27;BotConnectorBot custom stores no longer supported. Use UniversalBot with a custom IBotStorage implementation
 instead.&#x27;);
                throw new Error(&#x27;BotConnectorBot custom stores no longer supported.&#x27;);
        }
    }
    this.connector = new ChatConnector_1.ChatConnector(oConnector);
    this.bot = new UniversalBot_1.UniversalBot(this.connector, oBot);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction" id="apidoc.element.botbuilder.CardAction">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardAction
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardAction(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardImage" id="apidoc.element.botbuilder.CardImage">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardImage
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardImage(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.<span class="apidocCodeKeywordSpan">CardImage</span>().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia" id="apidoc.element.botbuilder.CardMedia">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardMedia
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardMedia(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector" id="apidoc.element.botbuilder.ChatConnector">
        function <span class="apidocSignatureSpan">botbuilder.</span>ChatConnector
        <span class="apidocSignatureSpan">(settings)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ChatConnector(settings) {
    if (settings === void 0) { settings = {}; }
    this.settings = settings;
    if (!this.settings.endpoint) {
        this.settings.endpoint = {
            refreshEndpoint: &#x27;https://login.microsoftonline.com/botframework.com/oauth2/v2.0/token&#x27;,
            refreshScope: &#x27;https://api.botframework.com/.default&#x27;,
            botConnectorOpenIdMetadata: this.settings.openIdMetadata || &#x27;https://login.botframework.com/v1/.well-known/openidconfiguration
&#x27;,
            botConnectorIssuer: &#x27;https://api.botframework.com&#x27;,
            botConnectorAudience: this.settings.appId,
            msaOpenIdMetadata: &#x27;https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration&#x27;,
            msaIssuer: &#x27;https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/&#x27;,
            msaAudience: &#x27;https://graph.microsoft.com&#x27;,
            emulatorOpenIdMetadata: &#x27;https://login.microsoftonline.com/botframework.com/v2.0/.well-known/openid-configuration&#x27;,
            emulatorAudience: &#x27;https://sts.windows.net/d6d49420-f39b-4df7-a1dc-d59a935871db/&#x27;,
            emulatorIssuer: this.settings.appId,
            stateEndpoint: this.settings.stateEndpoint || &#x27;https://state.botframework.com&#x27;
        };
    }
    this.botConnectorOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.botConnectorOpenIdMetadata);
    this.msaOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.msaOpenIdMetadata);
    this.emulatorOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.emulatorOpenIdMetadata);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Create a file named app.js and say hello in a few lines of code.

var restify = require(&#x27;restify&#x27;);
var builder = require(&#x27;botbuilder&#x27;);

// Create bot and add dialogs
var connector = new builder.<span class="apidocCodeKeywordSpan">ChatConnector</span>({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.send(&#x27;Hello World&#x27;);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog" id="apidoc.element.botbuilder.CommandDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>CommandDialog
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CommandDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;CommandDialog class is deprecated. Use IntentDialog class instead.&#x27;);
    _this.dialog = new IntentDialog_1.IntentDialog();
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector" id="apidoc.element.botbuilder.ConsoleConnector">
        function <span class="apidocSignatureSpan">botbuilder.</span>ConsoleConnector
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConsoleConnector() {
    this.replyCnt = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Dialog" id="apidoc.element.botbuilder.Dialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>Dialog
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Dialog() {
    return _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction" id="apidoc.element.botbuilder.DialogAction">
        function <span class="apidocSignatureSpan">botbuilder.</span>DialogAction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DialogAction() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer" id="apidoc.element.botbuilder.EntityRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>EntityRecognizer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EntityRecognizer() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Fact" id="apidoc.element.botbuilder.Fact">
        function <span class="apidocSignatureSpan">botbuilder.</span>Fact
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Fact(session) {
    this.session = session;
    this.data = { value: &#x27;&#x27; };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.HeroCard" id="apidoc.element.botbuilder.HeroCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>HeroCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HeroCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.hero&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            isOldSchema = true;
            break;
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.<span class="apidocCodeKeywordSpan">HeroCard</span>();
    if (v2.title) {
        card.title(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog" id="apidoc.element.botbuilder.IntentDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>IntentDialog
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IntentDialog(options) {
    if (options === void 0) { options = {}; }
    var _this = _super.call(this) || this;
    _this.handlers = {};
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet(options);
    if (typeof options.recognizeMode !== &#x22;undefined&#x22;) {
        _this.recognizeMode = options.recognizeMode;
    }
    else {
        _this.recognizeMode = RecognizeMode.onBeginIfRoot;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet" id="apidoc.element.botbuilder.IntentRecognizerSet">
        function <span class="apidocSignatureSpan">botbuilder.</span>IntentRecognizerSet
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IntentRecognizerSet(options) {
    if (options === void 0) { options = {}; }
    this.options = options;
    if (typeof this.options.intentThreshold !== &#x27;number&#x27;) {
        this.options.intentThreshold = 0.1;
    }
    if (!this.options.hasOwnProperty(&#x27;recognizeOrder&#x27;)) {
        this.options.recognizeOrder = RecognizeOrder.parallel;
    }
    if (!this.options.recognizers) {
        this.options.recognizers = [];
    }
    if (!this.options.processLimit) {
        this.options.processLimit = 4;
    }
    if (!this.options.hasOwnProperty(&#x27;stopIfExactMatch&#x27;)) {
        this.options.stopIfExactMatch = true;
    }
    this.length = this.options.recognizers.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Keyboard" id="apidoc.element.botbuilder.Keyboard">
        function <span class="apidocSignatureSpan">botbuilder.</span>Keyboard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Keyboard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.keyboard&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library" id="apidoc.element.botbuilder.Library">
        function <span class="apidocSignatureSpan">botbuilder.</span>Library
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Library(name) {
    var _this = _super.call(this) || this;
    _this.name = name;
    _this.dialogs = {};
    _this.libraries = {};
    _this.actions = new ActionSet_1.ActionSet();
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet();
    _this.triggersAdded = false;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog" id="apidoc.element.botbuilder.LuisDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>LuisDialog
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function LuisDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;LuisDialog class is deprecated. Use IntentDialog with a LuisRecognizer instead.&#x27;);
    var recognizer = new LuisRecognizer_1.LuisRecognizer(serviceUri);
    _this.dialog = new IntentDialog_1.IntentDialog({ recognizers: [recognizer] });
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisRecognizer" id="apidoc.element.botbuilder.LuisRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>LuisRecognizer
        <span class="apidocSignatureSpan">(models)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function LuisRecognizer(models) {
    if (typeof models == &#x27;string&#x27;) {
        this.models = { &#x27;*&#x27;: models };
    }
    else {
        this.models = (models || {});
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard" id="apidoc.element.botbuilder.MediaCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>MediaCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MediaCard(session) {
    return _super.call(this, session) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MemoryBotStorage" id="apidoc.element.botbuilder.MemoryBotStorage">
        function <span class="apidocSignatureSpan">botbuilder.</span>MemoryBotStorage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MemoryBotStorage() {
    this.userStore = {};
    this.conversationStore = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message" id="apidoc.element.botbuilder.Message">
        function <span class="apidocSignatureSpan">botbuilder.</span>Message
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Message(session) {
    this.session = session;
    this.data = {};
    this.data.type = consts.messageType;
    this.data.agent = consts.agent;
    if (this.session) {
        var m = this.session.message;
        if (m.source) {
            this.data.source = m.source;
        }
        if (m.textLocale) {
            this.data.textLocale = m.textLocale;
        }
        if (m.address) {
            this.data.address = m.address;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
        this.batchTimer = setTimeout(function () {
            _this.sendBatch();
        }, this.options.autoBatchDelay);
    }
};
Session.prototype.createMessage = function (localizationNamespace, text, args) {
    var message = new Message_1.<span class="apidocCodeKeywordSpan">Message</span>(this)
        .text(this.vgettext(localizationNamespace, Message_1.Message.randomPrompt(text), args));
    return message.toMessage();
};
Session.prototype.prepareMessage = function (msg) {
    if (!msg.type) {
        msg.type = &#x27;message&#x27;;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Middleware" id="apidoc.element.botbuilder.Middleware">
        function <span class="apidocSignatureSpan">botbuilder.</span>Middleware
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Middleware() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts" id="apidoc.element.botbuilder.Prompts">
        function <span class="apidocSignatureSpan">botbuilder.</span>Prompts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Prompts() {
    return _super !== null &#x26;&#x26; _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard" id="apidoc.element.botbuilder.ReceiptCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReceiptCard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.card.receipt&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem" id="apidoc.element.botbuilder.ReceiptItem">
        function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptItem
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReceiptItem(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.RegExpRecognizer" id="apidoc.element.botbuilder.RegExpRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>RegExpRecognizer
        <span class="apidocSignatureSpan">(intent, expressions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function RegExpRecognizer(intent, expressions) {
    this.intent = intent;
    if (expressions instanceof RegExp || typeof expressions.exec === &#x27;function&#x27;) {
        this.expressions = { &#x27;*&#x27;: expressions };
    }
    else {
        this.expressions = (expressions || {});
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session" id="apidoc.element.botbuilder.Session">
        function <span class="apidocSignatureSpan">botbuilder.</span>Session
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Session(options) {
    var _this = _super.call(this) || this;
    _this.options = options;
    _this.msgSent = false;
    _this._isReset = false;
    _this.lastSendTime = new Date().getTime();
    _this.batch = [];
    _this.batchStarted = false;
    _this.sendingBatch = false;
    _this.inMiddleware = false;
    _this._locale = null;
    _this.localizer = null;
    _this.library = options.library;
    _this.localizer = options.localizer;
    if (typeof _this.options.autoBatchDelay !== &#x27;number&#x27;) {
        _this.options.autoBatchDelay = 250;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SigninCard" id="apidoc.element.botbuilder.SigninCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>SigninCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SigninCard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.card.signin&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog" id="apidoc.element.botbuilder.SimpleDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>SimpleDialog
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SimpleDialog(fn) {
    var _this = _super.call(this) || this;
    _this.fn = fn;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SimplePromptRecognizer" id="apidoc.element.botbuilder.SimplePromptRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>SimplePromptRecognizer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SimplePromptRecognizer() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot" id="apidoc.element.botbuilder.TextBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>TextBot
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function TextBot(options) {
    if (options === void 0) { options = {}; }
    console.warn(&#x27;TextBot class is deprecated. Use UniversalBot with a ConsoleConnector class.&#x27;);
    var oBot = {};
    for (var key in options) {
        switch (key) {
            case &#x27;defaultDialogId&#x27;:
                oBot.defaultDialogId = options.defaultDialogId;
                break;
            case &#x27;defaultDialogArgs&#x27;:
                oBot.defaultDialogArgs = options.defaultDialogArgs;
                break;
            case &#x27;groupWelcomeMessage&#x27;:
                this.groupWelcomeMessage = options.groupWelcomeMessage;
                break;
            case &#x27;userWelcomeMessage&#x27;:
                this.userWelcomeMessage = options.userWelcomeMessage;
                break;
            case &#x27;goodbyeMessage&#x27;:
                this.goodbyeMessage = options.goodbyeMessage;
                break;
            case &#x27;userStore&#x27;:
            case &#x27;sessionStore&#x27;:
                console.error(&#x27;TextBot custom stores no longer supported. Use UniversalBot with a custom IBotStorage implementation
 instead.&#x27;);
                throw new Error(&#x27;TextBot custom stores no longer supported.&#x27;);
        }
    }
    this.connector = new ConsoleConnector_1.ConsoleConnector();
    this.bot = new UniversalBot_1.UniversalBot(this.connector, oBot);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard" id="apidoc.element.botbuilder.ThumbnailCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>ThumbnailCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ThumbnailCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.thumbnail&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot" id="apidoc.element.botbuilder.UniversalBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>UniversalBot
        <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function UniversalBot(connector, defaultDialog, libraryName) {
    var _this = _super.call(this, libraryName || consts.Library.default) || this;
    _this.settings = {
        processLimit: 4,
        persistUserData: true,
        persistConversationData: false
    };
    _this.connectors = {};
    _this.mwReceive = [];
    _this.mwSend = [];
    _this.mwSession = [];
    _this.localePath(&#x27;./locale/&#x27;);
    _this.library(Library_1.systemLib);
    if (defaultDialog) {
        if (typeof defaultDialog === &#x27;function&#x27; || Array.isArray(defaultDialog)) {
            _this.dialog(&#x27;/&#x27;, defaultDialog);
        }
        else {
            var settings = defaultDialog;
            for (var name in settings) {
                if (settings.hasOwnProperty(name)) {
                    _this.set(name, settings[name]);
                }
            }
        }
    }
    if (connector) {
        _this.connector(consts.defaultConnector, connector);
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var builder = require(&#x27;botbuilder&#x27;);

// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.<span class="apidocCodeKeywordSpan">UniversalBot</span>(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.send(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.VideoCard" id="apidoc.element.botbuilder.VideoCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>VideoCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function VideoCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.video&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


























































































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.AnimationCard" id="apidoc.module.botbuilder.AnimationCard">module botbuilder.AnimationCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.AnimationCard.AnimationCard" id="apidoc.element.botbuilder.AnimationCard.AnimationCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>AnimationCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AnimationCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.animation&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.AnimationCard.prototype" id="apidoc.module.botbuilder.AnimationCard.prototype">module botbuilder.AnimationCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.AnimationCard.prototype.constructor" id="apidoc.element.botbuilder.AnimationCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.AnimationCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AnimationCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.animation&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.AudioCard" id="apidoc.module.botbuilder.AudioCard">module botbuilder.AudioCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.AudioCard.AudioCard" id="apidoc.element.botbuilder.AudioCard.AudioCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>AudioCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AudioCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.audio&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.AudioCard.prototype" id="apidoc.module.botbuilder.AudioCard.prototype">module botbuilder.AudioCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.AudioCard.prototype.constructor" id="apidoc.element.botbuilder.AudioCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.AudioCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function AudioCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.audio&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.BotConnectorBot" id="apidoc.module.botbuilder.BotConnectorBot">module botbuilder.BotConnectorBot</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.BotConnectorBot" id="apidoc.element.botbuilder.BotConnectorBot.BotConnectorBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>BotConnectorBot
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BotConnectorBot(options) {
    console.warn(&#x27;BotConnectorBot class is deprecated. Use UniversalBot with a ChatConnector class.&#x27;);
    var oConnector = {};
    var oBot = {};
    for (var key in options) {
        switch (key) {
            case &#x27;appId&#x27;:
                oConnector.appId = options.appId;
                break;
            case &#x27;appSecret&#x27;:
                oConnector.appPassword = options.appSecret;
                break;
            case &#x27;defaultDialogId&#x27;:
                oBot.defaultDialogId = options.defaultDialogId;
                break;
            case &#x27;defaultDialogArgs&#x27;:
                oBot.defaultDialogArgs = options.defaultDialogArgs;
                break;
            case &#x27;groupWelcomeMessage&#x27;:
                this.groupWelcomeMessage = options.groupWelcomeMessage;
                break;
            case &#x27;userWelcomeMessage&#x27;:
                this.userWelcomeMessage = options.userWelcomeMessage;
                break;
            case &#x27;goodbyeMessage&#x27;:
                this.goodbyeMessage = options.goodbyeMessage;
                break;
            case &#x27;userStore&#x27;:
            case &#x27;conversationStore&#x27;:
            case &#x27;perUserInConversationStore&#x27;:
                console.error(&#x27;BotConnectorBot custom stores no longer supported. Use UniversalBot with a custom IBotStorage implementation
 instead.&#x27;);
                throw new Error(&#x27;BotConnectorBot custom stores no longer supported.&#x27;);
        }
    }
    this.connector = new ChatConnector_1.ChatConnector(oConnector);
    this.bot = new UniversalBot_1.UniversalBot(this.connector, oBot);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.BotConnectorBot.prototype" id="apidoc.module.botbuilder.BotConnectorBot.prototype">module botbuilder.BotConnectorBot.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.add" id="apidoc.element.botbuilder.BotConnectorBot.prototype.add">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>add
        <span class="apidocSignatureSpan">(id, dialog)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (id, dialog) {
    this.bot.dialog(id, dialog);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.beginDialog" id="apidoc.element.botbuilder.BotConnectorBot.prototype.beginDialog">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>beginDialog
        <span class="apidocSignatureSpan">(address, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialog = function (address, dialogId, dialogArgs) {
    console.error(&#x22;BotConnectorBot.beginDialog() is no longer supported. The schema for sending proactive messages has changed and
 you should update your code to use the new UniversalBot class.&#x22;);
    throw new Error(&#x22;BotConnectorBot.beginDialog() is no longer supported.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">beginDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.configure" id="apidoc.element.botbuilder.BotConnectorBot.prototype.configure">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>configure
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configure = function (options) {
    console.error(&#x22;BotConnectorBot.configure() is no longer supported. You should either pass all options into the constructor or
 update code to use the new UniversalBot class.&#x22;);
    throw new Error(&#x22;BotConnectorBot.configure() is no longer supported.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.listen" id="apidoc.element.botbuilder.BotConnectorBot.prototype.listen">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>listen
        <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function (dialogId, dialogArgs) {
    if (dialogId) {
        console.error(&#x22;Calling BotConnectorBot.listen() with a custom dialogId is no longer supported. You should either pass as
 defaultDialogId into the constructor or update code to use the new UniversalBot class.&#x22;);
        throw new Error(&#x22;Calling BotConnectorBot.listen() with a custom dialogId is no longer supported.&#x22;);
    }
    return this.connector.listen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var bot = new builder.UniversalBot(connector);
    bot.dialog(&#x27;/&#x27;, function (session) {
        session.send(&#x27;Hello World&#x27;);
    });

    // Setup Restify Server
    var server = restify.createServer();
    server.post(&#x27;/api/messages&#x27;, connector.<span class="apidocCodeKeywordSpan">listen</span>());
    server.listen(process.env.port || 3978, function () {
        console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
    });

## Test your bot
Use the [Bot Framework Emulator](http://docs.botframework.com/connector/tools/bot-framework-emulator/) to test your bot on localhost
.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.on" id="apidoc.element.botbuilder.BotConnectorBot.prototype.on">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>on
        <span class="apidocSignatureSpan">(event, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function (event, listener) {
    this.bot.on(event, listener);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.BotConnectorBot.prototype.verifyBotFramework" id="apidoc.element.botbuilder.BotConnectorBot.prototype.verifyBotFramework">
        function <span class="apidocSignatureSpan">botbuilder.BotConnectorBot.prototype.</span>verifyBotFramework
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">verifyBotFramework = function (options) {
    if (options) {
        console.error(&#x22;Calling BotConnectorBot.verifyBotFramework() with options is no longer supported. You should either pass
all options into the constructor or update code to use the new UniversalBot class.&#x22;);
        throw new Error(&#x22;Calling BotConnectorBot.verifyBotFramework() with options is no longer supported.&#x22;);
    }
    return function (req, res, next) { return next(); };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardAction" id="apidoc.module.botbuilder.CardAction">module botbuilder.CardAction</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.CardAction" id="apidoc.element.botbuilder.CardAction.CardAction">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardAction
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardAction(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.call" id="apidoc.element.botbuilder.CardAction.call">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>call
        <span class="apidocSignatureSpan">(session, number, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">call = function (session, number, title) {
    return new CardAction(session).type(&#x27;call&#x27;).value(number).title(title || &#x22;Click to call&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var consts = require(&#x22;./consts&#x22;);
var logger = require(&#x22;./logger&#x22;);
var sprintf = require(&#x22;sprintf-js&#x22;);
var events = require(&#x22;events&#x22;);
var Session = (function (_super) {
__extends(Session, _super);
function Session(options) {
    var _this = _super.<span class="apidocCodeKeywordSpan">call</span>(this) || this;
    _this.options = options;
    _this.msgSent = false;
    _this._isReset = false;
    _this.lastSendTime = new Date().getTime();
    _this.batch = [];
    _this.batchStarted = false;
    _this.sendingBatch = false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.dialogAction" id="apidoc.element.botbuilder.CardAction.dialogAction">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>dialogAction
        <span class="apidocSignatureSpan">(session, action, data, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogAction = function (session, action, data, title) {
    var value = &#x27;action?&#x27; + action;
    if (data) {
        value += &#x27;=&#x27; + data;
    }
    return new CardAction(session).type(&#x27;postBack&#x27;).value(value).title(title || &#x22;Click to send response to bot&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.downloadFile" id="apidoc.element.botbuilder.CardAction.downloadFile">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>downloadFile
        <span class="apidocSignatureSpan">(session, url, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">downloadFile = function (session, url, title) {
    return new CardAction(session).type(&#x27;downloadFile&#x27;).value(url).title(title || &#x22;Click to download file&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.imBack" id="apidoc.element.botbuilder.CardAction.imBack">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>imBack
        <span class="apidocSignatureSpan">(session, msg, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">imBack = function (session, msg, title) {
    return new CardAction(session).type(&#x27;imBack&#x27;).value(msg).title(title || &#x22;Click to send response to bot&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.<span class="apidocCodeKeywordSpan">imBack</span>(null, old.message, old.title) :
            CardAction_1.CardAction.openUrl(null, old.url, old.title);
        if (old.image) {
            btn.image(old.image);
        }
        list.push(btn);
    }
    card.buttons(list);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.openUrl" id="apidoc.element.botbuilder.CardAction.openUrl">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>openUrl
        <span class="apidocSignatureSpan">(session, url, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">openUrl = function (session, url, title) {
    return new CardAction(session).type(&#x27;openUrl&#x27;).value(url).title(title || &#x22;Click to open website in your browser&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.<span class="apidocCodeKeywordSpan">openUrl</span>(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.imBack(null, old.message, old.title) :
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.playAudio" id="apidoc.element.botbuilder.CardAction.playAudio">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>playAudio
        <span class="apidocSignatureSpan">(session, url, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">playAudio = function (session, url, title) {
    return new CardAction(session).type(&#x27;playAudio&#x27;).value(url).title(title || &#x22;Click to play audio file&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.playVideo" id="apidoc.element.botbuilder.CardAction.playVideo">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>playVideo
        <span class="apidocSignatureSpan">(session, url, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">playVideo = function (session, url, title) {
    return new CardAction(session).type(&#x27;playVideo&#x27;).value(url).title(title || &#x22;Click to play video&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.postBack" id="apidoc.element.botbuilder.CardAction.postBack">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>postBack
        <span class="apidocSignatureSpan">(session, msg, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">postBack = function (session, msg, title) {
    return new CardAction(session).type(&#x27;postBack&#x27;).value(msg).title(title || &#x22;Click to send response to bot&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.showImage" id="apidoc.element.botbuilder.CardAction.showImage">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.</span>showImage
        <span class="apidocSignatureSpan">(session, url, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">showImage = function (session, url, title) {
    return new CardAction(session).type(&#x27;showImage&#x27;).value(url).title(title || &#x22;Click to view image&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardAction.prototype" id="apidoc.module.botbuilder.CardAction.prototype">module botbuilder.CardAction.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.prototype.image" id="apidoc.element.botbuilder.CardAction.prototype.image">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>image
        <span class="apidocSignatureSpan">(url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">image = function (url) {
    if (url) {
        this.data.image = url;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        var list = [];
        for (var i = 0; i &#x3c; v2.actions.length; i++) {
            var old = v2.actions[i];
            var btn = old.message ?
                CardAction_1.CardAction.imBack(null, old.message, old.title) :
                CardAction_1.CardAction.openUrl(null, old.url, old.title);
            if (old.image) {
                btn.<span class="apidocCodeKeywordSpan">image</span>(old.image);
            }
            list.push(btn);
        }
        card.buttons(list);
    }
    return card.toAttachment();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.prototype.title" id="apidoc.element.botbuilder.CardAction.prototype.title">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>title
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">title = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.title = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.<span class="apidocCodeKeywordSpan">title</span>(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
        card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.prototype.toAction" id="apidoc.element.botbuilder.CardAction.prototype.toAction">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>toAction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toAction = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.prototype.type" id="apidoc.element.botbuilder.CardAction.prototype.type">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>type
        <span class="apidocSignatureSpan">(t)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">type = function (t) {
    if (t) {
        this.data.type = t;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardAction.prototype.value" id="apidoc.element.botbuilder.CardAction.prototype.value">
        function <span class="apidocSignatureSpan">botbuilder.CardAction.prototype.</span>value
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">value = function (v) {
    if (v) {
        this.data.value = v;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardImage" id="apidoc.module.botbuilder.CardImage">module botbuilder.CardImage</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.CardImage" id="apidoc.element.botbuilder.CardImage.CardImage">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardImage
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardImage(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.<span class="apidocCodeKeywordSpan">CardImage</span>().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.create" id="apidoc.element.botbuilder.CardImage.create">
        function <span class="apidocSignatureSpan">botbuilder.CardImage.</span>create
        <span class="apidocSignatureSpan">(session, url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (session, url) {
    return new CardImage(session).url(url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



&#x22;use strict&#x22;;
var __extends = (this &#x26;&#x26; this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.<span class="apidocCodeKeywordSpan">create</span>(b) : (__.prototype = b.prototype, new __
());
};
var Dialog_1 = require(&#x22;./dialogs/Dialog&#x22;);
var Message_1 = require(&#x22;./Message&#x22;);
var consts = require(&#x22;./consts&#x22;);
var logger = require(&#x22;./logger&#x22;);
var sprintf = require(&#x22;sprintf-js&#x22;);
var events = require(&#x22;events&#x22;);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardImage.prototype" id="apidoc.module.botbuilder.CardImage.prototype">module botbuilder.CardImage.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.prototype.alt" id="apidoc.element.botbuilder.CardImage.prototype.alt">
        function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>alt
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">alt = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.alt = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.prototype.tap" id="apidoc.element.botbuilder.CardImage.prototype.tap">
        function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>tap
        <span class="apidocSignatureSpan">(action)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tap = function (action) {
    if (action) {
        this.data.tap = action.toAction ? action.toAction() : action;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.<span class="apidocCodeKeywordSpan">tap</span>(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.imBack(null, old.message, old.title) :
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.prototype.toImage" id="apidoc.element.botbuilder.CardImage.prototype.toImage">
        function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>toImage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toImage = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardImage.prototype.url" id="apidoc.element.botbuilder.CardImage.prototype.url">
        function <span class="apidocSignatureSpan">botbuilder.CardImage.prototype.</span>url
        <span class="apidocSignatureSpan">(u)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">url = function (u) {
    if (u) {
        this.data.url = u;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().<span class="apidocCodeKeywordSpan">url</span>(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardMedia" id="apidoc.module.botbuilder.CardMedia">module botbuilder.CardMedia</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia.CardMedia" id="apidoc.element.botbuilder.CardMedia.CardMedia">
        function <span class="apidocSignatureSpan">botbuilder.</span>CardMedia
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CardMedia(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia.create" id="apidoc.element.botbuilder.CardMedia.create">
        function <span class="apidocSignatureSpan">botbuilder.CardMedia.</span>create
        <span class="apidocSignatureSpan">(session, url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (session, url) {
    return new CardMedia(session).url(url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



&#x22;use strict&#x22;;
var __extends = (this &#x26;&#x26; this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.<span class="apidocCodeKeywordSpan">create</span>(b) : (__.prototype = b.prototype, new __
());
};
var Dialog_1 = require(&#x22;./dialogs/Dialog&#x22;);
var Message_1 = require(&#x22;./Message&#x22;);
var consts = require(&#x22;./consts&#x22;);
var logger = require(&#x22;./logger&#x22;);
var sprintf = require(&#x22;sprintf-js&#x22;);
var events = require(&#x22;events&#x22;);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CardMedia.prototype" id="apidoc.module.botbuilder.CardMedia.prototype">module botbuilder.CardMedia.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia.prototype.profile" id="apidoc.element.botbuilder.CardMedia.prototype.profile">
        function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>profile
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">profile = function (text) {
    if (text) {
        this.data.profile = text;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia.prototype.toMedia" id="apidoc.element.botbuilder.CardMedia.prototype.toMedia">
        function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>toMedia
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toMedia = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CardMedia.prototype.url" id="apidoc.element.botbuilder.CardMedia.prototype.url">
        function <span class="apidocSignatureSpan">botbuilder.CardMedia.prototype.</span>url
        <span class="apidocSignatureSpan">(u)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">url = function (u) {
    if (u) {
        this.data.url = u;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().<span class="apidocCodeKeywordSpan">url</span>(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Channel" id="apidoc.module.botbuilder.Channel">module botbuilder.Channel</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Channel.getChannelId" id="apidoc.element.botbuilder.Channel.getChannelId">
        function <span class="apidocSignatureSpan">botbuilder.Channel.</span>getChannelId
        <span class="apidocSignatureSpan">(addressable)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getChannelId(addressable) {
    var channelId;
    if (addressable) {
        if (addressable.hasOwnProperty(&#x27;message&#x27;)) {
            channelId = addressable.message.address.channelId;
        }
        else if (addressable.hasOwnProperty(&#x27;address&#x27;)) {
            channelId = addressable.address.channelId;
        }
        else if (addressable.hasOwnProperty(&#x27;channelId&#x27;)) {
            channelId = addressable.channelId;
        }
    }
    return channelId ? channelId.toLowerCase() : &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
exports.warn = warn;
function info(addressable, fmt) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var channelId = Channel.<span class="apidocCodeKeywordSpan">getChannelId</span>(addressable);
    if (channelId === Channel.channels.emulator || debugLoggingEnabled) {
        var prefix = getPrefix(addressable);
        var msg = args.length &#x3e; 0 ? sprintf.vsprintf(fmt, args) : fmt;
        console.info(prefix + msg);
    }
}
exports.info = info;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Channel.supportsCardActions" id="apidoc.element.botbuilder.Channel.supportsCardActions">
        function <span class="apidocSignatureSpan">botbuilder.Channel.</span>supportsCardActions
        <span class="apidocSignatureSpan">(session, buttonCnt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function supportsCardActions(session, buttonCnt) {
    if (buttonCnt === void 0) { buttonCnt = 100; }
    switch (getChannelId(session)) {
        case exports.channels.facebook:
        case exports.channels.skype:
        case exports.channels.msteams:
            return (buttonCnt &#x3c;= 3);
        case exports.channels.slack:
        case exports.channels.emulator:
        case exports.channels.directline:
        case exports.channels.webchat:
            return (buttonCnt &#x3c;= 100);
        default:
            return false;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Channel.supportsKeyboards" id="apidoc.element.botbuilder.Channel.supportsKeyboards">
        function <span class="apidocSignatureSpan">botbuilder.Channel.</span>supportsKeyboards
        <span class="apidocSignatureSpan">(session, buttonCnt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function supportsKeyboards(session, buttonCnt) {
    if (buttonCnt === void 0) { buttonCnt = 100; }
    switch (getChannelId(session)) {
        case exports.channels.facebook:
            return (buttonCnt &#x3c;= 10);
        case exports.channels.kik:
            return (buttonCnt &#x3c;= 20);
        case exports.channels.slack:
        case exports.channels.telegram:
            return (buttonCnt &#x3c;= 100);
        default:
            return false;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ChatConnector" id="apidoc.module.botbuilder.ChatConnector">module botbuilder.ChatConnector</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.ChatConnector" id="apidoc.element.botbuilder.ChatConnector.ChatConnector">
        function <span class="apidocSignatureSpan">botbuilder.</span>ChatConnector
        <span class="apidocSignatureSpan">(settings)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ChatConnector(settings) {
    if (settings === void 0) { settings = {}; }
    this.settings = settings;
    if (!this.settings.endpoint) {
        this.settings.endpoint = {
            refreshEndpoint: &#x27;https://login.microsoftonline.com/botframework.com/oauth2/v2.0/token&#x27;,
            refreshScope: &#x27;https://api.botframework.com/.default&#x27;,
            botConnectorOpenIdMetadata: this.settings.openIdMetadata || &#x27;https://login.botframework.com/v1/.well-known/openidconfiguration
&#x27;,
            botConnectorIssuer: &#x27;https://api.botframework.com&#x27;,
            botConnectorAudience: this.settings.appId,
            msaOpenIdMetadata: &#x27;https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration&#x27;,
            msaIssuer: &#x27;https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/&#x27;,
            msaAudience: &#x27;https://graph.microsoft.com&#x27;,
            emulatorOpenIdMetadata: &#x27;https://login.microsoftonline.com/botframework.com/v2.0/.well-known/openid-configuration&#x27;,
            emulatorAudience: &#x27;https://sts.windows.net/d6d49420-f39b-4df7-a1dc-d59a935871db/&#x27;,
            emulatorIssuer: this.settings.appId,
            stateEndpoint: this.settings.stateEndpoint || &#x27;https://state.botframework.com&#x27;
        };
    }
    this.botConnectorOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.botConnectorOpenIdMetadata);
    this.msaOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.msaOpenIdMetadata);
    this.emulatorOpenIdMetadata = new OpenIdMetadata_1.OpenIdMetadata(this.settings.endpoint.emulatorOpenIdMetadata);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Create a file named app.js and say hello in a few lines of code.

var restify = require(&#x27;restify&#x27;);
var builder = require(&#x27;botbuilder&#x27;);

// Create bot and add dialogs
var connector = new builder.<span class="apidocCodeKeywordSpan">ChatConnector</span>({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.send(&#x27;Hello World&#x27;);
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ChatConnector.prototype" id="apidoc.module.botbuilder.ChatConnector.prototype">module botbuilder.ChatConnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.addAccessToken" id="apidoc.element.botbuilder.ChatConnector.prototype.addAccessToken">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>addAccessToken
        <span class="apidocSignatureSpan">(options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addAccessToken = function (options, cb) {
    this.addUserAgent(options);
    if (this.settings.appId &#x26;&#x26; this.settings.appPassword) {
        this.getAccessToken(function (err, token) {
            if (!err &#x26;&#x26; token) {
                options.headers = {
                    &#x27;Authorization&#x27;: &#x27;Bearer &#x27; + token
                };
                cb(null);
            }
            else {
                cb(err);
            }
        });
    }
    else {
        cb(null);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.addUserAgent" id="apidoc.element.botbuilder.ChatConnector.prototype.addUserAgent">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>addUserAgent
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addUserAgent = function (options) {
    if (options.headers == null) {
        options.headers = {};
    }
    options.headers[&#x27;User-Agent&#x27;] = USER_AGENT;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.authenticatedRequest" id="apidoc.element.botbuilder.ChatConnector.prototype.authenticatedRequest">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>authenticatedRequest
        <span class="apidocSignatureSpan">(options, callback, refresh)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">authenticatedRequest = function (options, callback, refresh) {
    var _this = this;
    if (refresh === void 0) { refresh = false; }
    if (refresh) {
        this.accessToken = null;
    }
    this.addAccessToken(options, function (err) {
        if (!err) {
            request(options, function (err, response, body) {
                if (!err) {
                    switch (response.statusCode) {
                        case 401:
                        case 403:
                            if (!refresh) {
                                _this.authenticatedRequest(options, callback, true);
                            }
                            else {
                                callback(null, response, body);
                            }
                            break;
                        default:
                            if (response.statusCode &#x3c; 400) {
                                callback(null, response, body);
                            }
                            else {
                                var txt = &#x22;Request to &#x27;&#x22; + options.url + &#x22;&#x27; failed: [&#x22; + response.statusCode + &#x22;] &#x22; + response.statusMessage
;
                                callback(new Error(txt), response, null);
                            }
                            break;
                    }
                }
                else {
                    callback(err, null, null);
                }
            });
        }
        else {
            callback(err, null, null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.dispatch" id="apidoc.element.botbuilder.ChatConnector.prototype.dispatch">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>dispatch
        <span class="apidocSignatureSpan">(msg, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (msg, res) {
    try {
        this.prepIncomingMessage(msg);
        logger.info(msg, &#x27;ChatConnector: message received.&#x27;);
        if (this.isInvoke(msg)) {
            this.onInvokeHandler(msg, function (err, body, status) {
                if (err) {
                    res.status(500);
                    res.end();
                    logger.error(&#x27;Received error from invoke handler: &#x27;, err.message || &#x27;&#x27;);
                }
                else {
                    res.send(status || 200, body);
                }
            });
        }
        else {
            this.onEventHandler([msg]);
            res.status(202);
            res.end();
        }
    }
    catch (e) {
        console.error(e instanceof Error ? e.stack : e.toString());
        res.status(500);
        res.end();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.getAccessToken" id="apidoc.element.botbuilder.ChatConnector.prototype.getAccessToken">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getAccessToken
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAccessToken = function (cb) {
    var _this = this;
    if (!this.accessToken || new Date().getTime() &#x3e;= this.accessTokenExpires) {
        var opt = {
            method: &#x27;POST&#x27;,
            url: this.settings.endpoint.refreshEndpoint,
            form: {
                grant_type: &#x27;client_credentials&#x27;,
                client_id: this.settings.appId,
                client_secret: this.settings.appPassword,
                scope: this.settings.endpoint.refreshScope
            }
        };
        request(opt, function (err, response, body) {
            if (!err) {
                if (body &#x26;&#x26; response.statusCode &#x3c; 300) {
                    var oauthResponse = JSON.parse(body);
                    _this.accessToken = oauthResponse.access_token;
                    _this.accessTokenExpires = new Date().getTime() + ((oauthResponse.expires_in - 300) * 1000);
                    cb(null, _this.accessToken);
                }
                else {
                    cb(new Error(&#x27;Refresh access token failed with status code: &#x27; + response.statusCode), null);
                }
            }
            else {
                cb(err, null);
            }
        });
    }
    else {
        cb(null, this.accessToken);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.getData" id="apidoc.element.botbuilder.ChatConnector.prototype.getData">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getData
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (context, callback) {
    var _this = this;
    try {
        var root = this.getStoragePath(context.address);
        var list = [];
        if (context.userId) {
            if (context.persistUserData) {
                list.push({
                    field: &#x27;userData&#x27;,
                    url: root + &#x27;/users/&#x27; + encodeURIComponent(context.userId)
                });
            }
            if (context.conversationId) {
                list.push({
                    field: &#x27;privateConversationData&#x27;,
                    url: root + &#x27;/conversations/&#x27; + encodeURIComponent(context.conversationId) +
                        &#x27;/users/&#x27; + encodeURIComponent(context.userId)
                });
            }
        }
        if (context.persistConversationData &#x26;&#x26; context.conversationId) {
            list.push({
                field: &#x27;conversationData&#x27;,
                url: root + &#x27;/conversations/&#x27; + encodeURIComponent(context.conversationId)
            });
        }
        var data = {};
        async.each(list, function (entry, cb) {
            var options = {
                method: &#x27;GET&#x27;,
                url: entry.url,
                json: true
            };
            _this.authenticatedRequest(options, function (err, response, body) {
                if (!err &#x26;&#x26; body) {
                    var botData = body.data ? body.data : {};
                    if (typeof botData === &#x27;string&#x27;) {
                        zlib.gunzip(new Buffer(botData, &#x27;base64&#x27;), function (err, result) {
                            if (!err) {
                                try {
                                    var txt = result.toString();
                                    data[entry.field + &#x27;Hash&#x27;] = txt;
                                    data[entry.field] = JSON.parse(txt);
                                }
                                catch (e) {
                                    err = e;
                                }
                            }
                            cb(err);
                        });
                    }
                    else {
                        try {
                            data[entry.field + &#x27;Hash&#x27;] = JSON.stringify(botData);
                            data[entry.field] = botData;
                        }
                        catch (e) {
                            err = e;
                        }
                        cb(err);
                    }
                }
                else {
                    cb(err);
                }
            });
        }, function (err) {
            if (!err) {
                callback(null, data);
            }
            else {
                var m = err.toString();
                callback(err instanceof Error ? err : new Error(m), null);
            }
        });
    }
    catch (e) {
        callback(e instanceof Error ? e : new Error(e.toString()), null);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.getStoragePath" id="apidoc.element.botbuilder.ChatConnector.prototype.getStoragePath">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>getStoragePath
        <span class="apidocSignatureSpan">(address)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getStoragePath = function (address) {
    var path;
    switch (address.channelId) {
        case &#x27;emulator&#x27;:
            if (address.serviceUrl) {
                path = address.serviceUrl;
            }
            else {
                throw new Error(&#x27;ChatConnector.getStoragePath() missing address.serviceUrl.&#x27;);
            }
            break;
        default:
            path = this.settings.endpoint.stateEndpoint;
            break;
    }
    return path + &#x27;/v3/botstate/&#x27; + encodeURIComponent(address.channelId);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.isInvoke" id="apidoc.element.botbuilder.ChatConnector.prototype.isInvoke">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>isInvoke
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isInvoke = function (message) {
    return (message &#x26;&#x26; message.type &#x26;&#x26; message.type.toLowerCase() == consts.invokeType);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.listen" id="apidoc.element.botbuilder.ChatConnector.prototype.listen">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>listen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function () {
    var _this = this;
    return function (req, res) {
        if (req.body) {
            _this.verifyBotFramework(req, res);
        }
        else {
            var requestData = &#x27;&#x27;;
            req.on(&#x27;data&#x27;, function (chunk) {
                requestData += chunk;
            });
            req.on(&#x27;end&#x27;, function () {
                req.body = JSON.parse(requestData);
                _this.verifyBotFramework(req, res);
            });
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var bot = new builder.UniversalBot(connector);
    bot.dialog(&#x27;/&#x27;, function (session) {
        session.send(&#x27;Hello World&#x27;);
    });

    // Setup Restify Server
    var server = restify.createServer();
    server.post(&#x27;/api/messages&#x27;, connector.<span class="apidocCodeKeywordSpan">listen</span>());
    server.listen(process.env.port || 3978, function () {
        console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
    });

## Test your bot
Use the [Bot Framework Emulator](http://docs.botframework.com/connector/tools/bot-framework-emulator/) to test your bot on localhost
.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.onEvent" id="apidoc.element.botbuilder.ChatConnector.prototype.onEvent">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>onEvent
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onEvent = function (handler) {
    this.onEventHandler = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.onInvoke" id="apidoc.element.botbuilder.ChatConnector.prototype.onInvoke">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>onInvoke
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onInvoke = function (handler) {
    this.onInvokeHandler = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.postMessage" id="apidoc.element.botbuilder.ChatConnector.prototype.postMessage">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>postMessage
        <span class="apidocSignatureSpan">(msg, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">postMessage = function (msg, cb) {
    logger.info(address, &#x27;ChatConnector: sending message.&#x27;);
    this.prepOutgoingMessage(msg);
    var address = msg.address;
    msg[&#x27;from&#x27;] = address.bot;
    msg[&#x27;recipient&#x27;] = address.user;
    delete msg.address;
    var path = &#x27;/v3/conversations/&#x27; + encodeURIComponent(address.conversation.id) + &#x27;/activities&#x27;;
    if (address.id &#x26;&#x26; address.channelId !== &#x27;skype&#x27;) {
        path += &#x27;/&#x27; + encodeURIComponent(address.id);
    }
    var options = {
        method: &#x27;POST&#x27;,
        url: urlJoin(address.serviceUrl, path),
        body: msg,
        json: true
    };
    if (address.useAuth) {
        this.authenticatedRequest(options, function (err, response, body) { return cb(err); });
    }
    else {
        this.addUserAgent(options);
        request(options, function (err, response, body) {
            if (!err &#x26;&#x26; response.statusCode &#x3e;= 400) {
                var txt = &#x22;Request to &#x27;&#x22; + options.url + &#x22;&#x27; failed: [&#x22; + response.statusCode + &#x22;] &#x22; + response.statusMessage;
                err = new Error(txt);
            }
            cb(err);
        });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.prepIncomingMessage" id="apidoc.element.botbuilder.ChatConnector.prototype.prepIncomingMessage">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>prepIncomingMessage
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepIncomingMessage = function (msg) {
    utils.moveFieldsTo(msg, msg, {
        &#x27;locale&#x27;: &#x27;textLocale&#x27;,
        &#x27;channelData&#x27;: &#x27;sourceEvent&#x27;
    });
    msg.text = msg.text || &#x27;&#x27;;
    msg.attachments = msg.attachments || [];
    msg.entities = msg.entities || [];
    var address = {};
    utils.moveFieldsTo(msg, address, toAddress);
    msg.address = address;
    msg.source = address.channelId;
    if (msg.source == &#x27;facebook&#x27; &#x26;&#x26; msg.sourceEvent &#x26;&#x26; msg.sourceEvent.message &#x26;&#x26; msg.sourceEvent.message.quick_reply) {
        msg.text = msg.sourceEvent.message.quick_reply.payload;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.prepOutgoingMessage" id="apidoc.element.botbuilder.ChatConnector.prototype.prepOutgoingMessage">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>prepOutgoingMessage
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepOutgoingMessage = function (msg) {
    if (msg.attachments) {
        var attachments = [];
        for (var i = 0; i &#x3c; msg.attachments.length; i++) {
            var a = msg.attachments[i];
            switch (a.contentType) {
                case &#x27;application/vnd.microsoft.keyboard&#x27;:
                    if (msg.address.channelId == &#x27;facebook&#x27;) {
                        msg.sourceEvent = { quick_replies: [] };
                        a.content.buttons.forEach(function (action) {
                            switch (action.type) {
                                case &#x27;imBack&#x27;:
                                case &#x27;postBack&#x27;:
                                    msg.sourceEvent.quick_replies.push({
                                        content_type: &#x27;text&#x27;,
                                        title: action.title,
                                        payload: action.value
                                    });
                                    break;
                                default:
                                    logger.warn(msg, &#x22;Invalid keyboard &#x27;%s&#x27; button sent to facebook.&#x22;, action.type);
                                    break;
                            }
                        });
                    }
                    else {
                        a.contentType = &#x27;application/vnd.microsoft.card.hero&#x27;;
                        attachments.push(a);
                    }
                    break;
                default:
                    attachments.push(a);
                    break;
            }
        }
        msg.attachments = attachments;
    }
    utils.moveFieldsTo(msg, msg, {
        &#x27;textLocale&#x27;: &#x27;locale&#x27;,
        &#x27;sourceEvent&#x27;: &#x27;channelData&#x27;
    });
    delete msg.agent;
    delete msg.source;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.saveData" id="apidoc.element.botbuilder.ChatConnector.prototype.saveData">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>saveData
        <span class="apidocSignatureSpan">(context, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saveData = function (context, data, callback) {
    var _this = this;
    var list = [];
    function addWrite(field, botData, url) {
        var hashKey = field + &#x27;Hash&#x27;;
        var hash = JSON.stringify(botData);
        if (!data[hashKey] || hash !== data[hashKey]) {
            data[hashKey] = hash;
            list.push({ botData: botData, url: url, hash: hash });
        }
    }
    try {
        var root = this.getStoragePath(context.address);
        if (context.userId) {
            if (context.persistUserData) {
                addWrite(&#x27;userData&#x27;, data.userData || {}, root + &#x27;/users/&#x27; + encodeURIComponent(context.userId));
            }
            if (context.conversationId) {
                var url = root + &#x27;/conversations/&#x27; + encodeURIComponent(context.conversationId) +
                    &#x27;/users/&#x27; + encodeURIComponent(context.userId);
                addWrite(&#x27;privateConversationData&#x27;, data.privateConversationData || {}, url);
            }
        }
        if (context.persistConversationData &#x26;&#x26; context.conversationId) {
            addWrite(&#x27;conversationData&#x27;, data.conversationData || {}, root + &#x27;/conversations/&#x27; + encodeURIComponent(context.conversationId
));
        }
        async.each(list, function (entry, cb) {
            if (_this.settings.gzipData) {
                zlib.gzip(entry.hash, function (err, result) {
                    if (!err &#x26;&#x26; result.length &#x3e; MAX_DATA_LENGTH) {
                        err = new Error(&#x22;Data of &#x22; + result.length + &#x22; bytes gzipped exceeds the &#x22; + MAX_DATA_LENGTH + &#x22; byte limit
. Can&#x27;t post to: &#x22; + entry.url);
                        err.code = consts.Errors.EMSGSIZE;
                    }
                    if (!err) {
                        var options = {
                            method: &#x27;POST&#x27;,
                            url: entry.url,
                            body: { eTag: &#x27;*&#x27;, data: result.toString(&#x27;base64&#x27;) },
                            json: true
                        };
                        _this.authenticatedRequest(options, function (err, response, body) {
                            cb(err);
                        });
                    }
                    else {
                        cb(err);
                    }
                });
            }
            else if (entry.hash.length &#x3c; MAX_DATA_LENGTH) {
                var options = {
                    method: &#x27;POST&#x27;,
                    url: entry.url,
                    body: { eTag: &#x27;*&#x27;, data: entry.botData },
                    json: true
                };
                _this.authenticatedRequest(options, function (err, response, body) {
                    cb(err);
                });
            }
            else {
                var err = new Error(&#x22;Data of &#x22; + entry.hash.length + &#x22; bytes exceeds the &#x22; + MAX_DATA_LENGTH + &#x22; byte limit. Consider
 setting connectors gzipData option. Can&#x27;t post to: &#x22; + entry.url);
                err.code = consts.Errors.EMSGSIZE;
                cb(err);
            }
        }, function (err) {
            if (callback) {
                if (!err) {
                    callback(null);
                }
                else {
                    var m = err.toString();
                    callback(err instanceof Error ? err : new Error(m));
                }
            }
        });
    }
    catch (e) {
        if (callback) {
            var err = e instanceof Error ? e : new Error(e.toString());
            err.code = consts.Errors.EBADMSG;
            callback(err);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.send" id="apidoc.element.botbuilder.ChatConnector.prototype.send">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>send
        <span class="apidocSignatureSpan">(messages, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (messages, done) {
    var _this = this;
    async.eachSeries(messages, function (msg, cb) {
        try {
            if (msg.address &#x26;&#x26; msg.address.serviceUrl) {
                _this.postMessage(msg, cb);
            }
            else {
                logger.error(&#x27;ChatConnector: send - message is missing address or serviceUrl.&#x27;);
                cb(new Error(&#x27;Message missing address or serviceUrl.&#x27;));
            }
        }
        catch (e) {
            cb(e);
        }
    }, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.<span class="apidocCodeKeywordSpan">send</span>(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
    console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.startConversation" id="apidoc.element.botbuilder.ChatConnector.prototype.startConversation">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>startConversation
        <span class="apidocSignatureSpan">(address, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startConversation = function (address, done) {
    if (address &#x26;&#x26; address.user &#x26;&#x26; address.bot &#x26;&#x26; address.serviceUrl) {
        var options = {
            method: &#x27;POST&#x27;,
            url: urlJoin(address.serviceUrl, &#x27;/v3/conversations&#x27;),
            body: {
                bot: address.bot,
                members: [address.user]
            },
            json: true
        };
        this.authenticatedRequest(options, function (err, response, body) {
            var adr;
            if (!err) {
                try {
                    var obj = typeof body === &#x27;string&#x27; ? JSON.parse(body) : body;
                    if (obj &#x26;&#x26; obj.hasOwnProperty(&#x27;id&#x27;)) {
                        adr = utils.clone(address);
                        adr.conversation = { id: obj[&#x27;id&#x27;] };
                        if (adr.id) {
                            delete adr.id;
                        }
                    }
                    else {
                        err = new Error(&#x27;Failed to start conversation: no conversation ID returned.&#x27;);
                    }
                }
                catch (e) {
                    err = e instanceof Error ? e : new Error(e.toString());
                }
            }
            if (err) {
                logger.error(&#x27;ChatConnector: startConversation - error starting conversation.&#x27;);
            }
            done(err, adr);
        });
    }
    else {
        logger.error(&#x27;ChatConnector: startConversation - address is invalid.&#x27;);
        done(new Error(&#x27;Invalid address.&#x27;));
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ChatConnector.prototype.verifyBotFramework" id="apidoc.element.botbuilder.ChatConnector.prototype.verifyBotFramework">
        function <span class="apidocSignatureSpan">botbuilder.ChatConnector.prototype.</span>verifyBotFramework
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">verifyBotFramework = function (req, res) {
    var _this = this;
    var token;
    var isEmulator = req.body[&#x27;channelId&#x27;] === &#x27;emulator&#x27;;
    var authHeaderValue = req.headers ? req.headers[&#x27;authorization&#x27;] || req.headers[&#x27;Authorization&#x27;] : null;
    if (authHeaderValue) {
        var auth = authHeaderValue.trim().split(&#x27; &#x27;);
        if (auth.length == 2 &#x26;&#x26; auth[0].toLowerCase() == &#x27;bearer&#x27;) {
            token = auth[1];
        }
    }
    if (token) {
        req.body[&#x27;useAuth&#x27;] = true;
        var decoded = jwt.decode(token, { complete: true });
        var verifyOptions;
        var openIdMetadata;
        if (isEmulator &#x26;&#x26; decoded.payload.iss == this.settings.endpoint.msaIssuer) {
            openIdMetadata = this.msaOpenIdMetadata;
            verifyOptions = {
                issuer: this.settings.endpoint.msaIssuer,
                audience: this.settings.endpoint.msaAudience,
                clockTolerance: 300
            };
        }
        else if (isEmulator &#x26;&#x26; decoded.payload.iss == this.settings.endpoint.emulatorIssuer) {
            openIdMetadata = this.emulatorOpenIdMetadata;
            verifyOptions = {
                issuer: this.settings.endpoint.emulatorIssuer,
                audience: this.settings.endpoint.emulatorAudience,
                clockTolerance: 300
            };
        }
        else {
            openIdMetadata = this.botConnectorOpenIdMetadata;
            verifyOptions = {
                issuer: this.settings.endpoint.botConnectorIssuer,
                audience: this.settings.endpoint.botConnectorAudience,
                clockTolerance: 300
            };
        }
        if (isEmulator &#x26;&#x26; decoded.payload.appid != this.settings.appId) {
            logger.error(&#x27;ChatConnector: receive - invalid token. Requested by unexpected app ID.&#x27;);
            res.status(403);
            res.end();
            return;
        }
        openIdMetadata.getKey(decoded.header.kid, function (key) {
            if (key) {
                try {
                    jwt.verify(token, key, verifyOptions);
                }
                catch (err) {
                    logger.error(&#x27;ChatConnector: receive - invalid token. Check bot\&#x27;s app ID &#x26; Password.&#x27;);
                    res.status(403);
                    res.end();
                    return;
                }
                _this.dispatch(req.body, res);
            }
            else {
                logger.error(&#x27;ChatConnector: receive - invalid signing key or OpenId metadata document.&#x27;);
                res.status(500);
                res.end();
                return;
            }
        });
    }
    else if (isEmulator &#x26;&#x26; !this.settings.appId &#x26;&#x26; !this.settings.appPassword) {
        logger.warn(req.body, &#x27;ChatConnector: receive - emulator running without security enabled.&#x27;);
        req.body[&#x27;useAuth&#x27;] = false;
        this.dispatch(req.body, res);
    }
    else {
        logger.error(&#x27;ChatConnector: receive - no security token sent.&#x27;);
        res.status(401);
        res.end();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CommandDialog" id="apidoc.module.botbuilder.CommandDialog">module botbuilder.CommandDialog</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.CommandDialog" id="apidoc.element.botbuilder.CommandDialog.CommandDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>CommandDialog
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CommandDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;CommandDialog class is deprecated. Use IntentDialog class instead.&#x27;);
    _this.dialog = new IntentDialog_1.IntentDialog();
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.CommandDialog.prototype" id="apidoc.module.botbuilder.CommandDialog.prototype">module botbuilder.CommandDialog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.begin" id="apidoc.element.botbuilder.CommandDialog.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    this.dialog.begin(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.constructor" id="apidoc.element.botbuilder.CommandDialog.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>constructor
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function CommandDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;CommandDialog class is deprecated. Use IntentDialog class instead.&#x27;);
    _this.dialog = new IntentDialog_1.IntentDialog();
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.dialogResumed" id="apidoc.element.botbuilder.CommandDialog.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    this.dialog.dialogResumed(session, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.matches" id="apidoc.element.botbuilder.CommandDialog.prototype.matches">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>matches
        <span class="apidocSignatureSpan">(patterns, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">matches = function (patterns, dialogId, dialogArgs) {
    var _this = this;
    var list = (!Array.isArray(patterns) ? [patterns] : patterns);
    list.forEach(function (p) {
        _this.dialog.matches(new RegExp(p, &#x27;i&#x27;), dialogId, dialogArgs);
    });
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.onBegin" id="apidoc.element.botbuilder.CommandDialog.prototype.onBegin">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>onBegin
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onBegin = function (handler) {
    this.dialog.onBegin(handler);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.onDefault" id="apidoc.element.botbuilder.CommandDialog.prototype.onDefault">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>onDefault
        <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onDefault = function (dialogId, dialogArgs) {
    this.dialog.onDefault(dialogId, dialogArgs);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.recognize" id="apidoc.element.botbuilder.CommandDialog.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    this.dialog.recognize(context, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.CommandDialog.prototype.replyReceived" id="apidoc.element.botbuilder.CommandDialog.prototype.replyReceived">
        function <span class="apidocSignatureSpan">botbuilder.CommandDialog.prototype.</span>replyReceived
        <span class="apidocSignatureSpan">(session, recognizeResult)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replyReceived = function (session, recognizeResult) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.<span class="apidocCodeKeywordSpan">replyReceived</span>(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ConsoleConnector" id="apidoc.module.botbuilder.ConsoleConnector">module botbuilder.ConsoleConnector</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.ConsoleConnector" id="apidoc.element.botbuilder.ConsoleConnector.ConsoleConnector">
        function <span class="apidocSignatureSpan">botbuilder.</span>ConsoleConnector
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConsoleConnector() {
    this.replyCnt = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ConsoleConnector.prototype" id="apidoc.module.botbuilder.ConsoleConnector.prototype">module botbuilder.ConsoleConnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.listen" id="apidoc.element.botbuilder.ConsoleConnector.prototype.listen">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>listen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function () {
    var _this = this;
    this.rl = readline.createInterface({ input: process.stdin, output: process.stdout, terminal: false });
    this.rl.on(&#x27;line&#x27;, function (line) {
        _this.replyCnt = 0;
        line = line || &#x27;&#x27;;
        if (line.toLowerCase() == &#x27;quit&#x27;) {
            _this.rl.close();
            process.exit();
        }
        else {
            _this.processMessage(line);
        }
    });
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var bot = new builder.UniversalBot(connector);
    bot.dialog(&#x27;/&#x27;, function (session) {
        session.send(&#x27;Hello World&#x27;);
    });

    // Setup Restify Server
    var server = restify.createServer();
    server.post(&#x27;/api/messages&#x27;, connector.<span class="apidocCodeKeywordSpan">listen</span>());
    server.listen(process.env.port || 3978, function () {
        console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
    });

## Test your bot
Use the [Bot Framework Emulator](http://docs.botframework.com/connector/tools/bot-framework-emulator/) to test your bot on localhost
.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.onEvent" id="apidoc.element.botbuilder.ConsoleConnector.prototype.onEvent">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>onEvent
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onEvent = function (handler) {
    this.onEventHandler = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.onInvoke" id="apidoc.element.botbuilder.ConsoleConnector.prototype.onInvoke">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>onInvoke
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onInvoke = function (handler) {
    this.onInvokeHandler = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.processMessage" id="apidoc.element.botbuilder.ConsoleConnector.prototype.processMessage">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>processMessage
        <span class="apidocSignatureSpan">(line)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processMessage = function (line) {
    if (this.onEventHandler) {
        var msg = new Message_1.Message()
            .address({
            channelId: &#x27;console&#x27;,
            user: { id: &#x27;user&#x27;, name: &#x27;User1&#x27; },
            bot: { id: &#x27;bot&#x27;, name: &#x27;Bot&#x27; },
            conversation: { id: &#x27;Convo1&#x27; }
        })
            .timestamp()
            .text(line);
        this.onEventHandler([msg.toMessage()]);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.send" id="apidoc.element.botbuilder.ConsoleConnector.prototype.send">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>send
        <span class="apidocSignatureSpan">(messages, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (messages, done) {
    for (var i = 0; i &#x3c; messages.length; i++) {
        if (this.replyCnt++ &#x3e; 0) {
            console.log();
        }
        var msg = messages[i];
        if (msg.text) {
            log(msg.text);
        }
        if (msg.attachments &#x26;&#x26; msg.attachments.length &#x3e; 0) {
            for (var j = 0; j &#x3c; msg.attachments.length; j++) {
                if (j &#x3e; 0) {
                    console.log();
                }
                renderAttachment(msg.attachments[j]);
            }
        }
    }
    done(null);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.<span class="apidocCodeKeywordSpan">send</span>(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
    console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ConsoleConnector.prototype.startConversation" id="apidoc.element.botbuilder.ConsoleConnector.prototype.startConversation">
        function <span class="apidocSignatureSpan">botbuilder.ConsoleConnector.prototype.</span>startConversation
        <span class="apidocSignatureSpan">(address, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startConversation = function (address, cb) {
    var adr = utils.clone(address);
    adr.conversation = { id: &#x27;Convo1&#x27; };
    cb(null, adr);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.DefaultLocalizer" id="apidoc.module.botbuilder.DefaultLocalizer">module botbuilder.DefaultLocalizer</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.DefaultLocalizer.DefaultLocalizer" id="apidoc.element.botbuilder.DefaultLocalizer.DefaultLocalizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>DefaultLocalizer
        <span class="apidocSignatureSpan">(root, defaultLocale)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DefaultLocalizer(root, defaultLocale) {
    this.localePaths = [];
    this.locales = {};
    this.defaultLocale(defaultLocale || &#x27;en&#x27;);
    var libsSeen = {};
    var _that = this;
    function addPaths(library) {
        if (!libsSeen.hasOwnProperty(library.name)) {
            libsSeen[library.name] = true;
            library.forEachLibrary(function (child) {
                addPaths(child);
            });
            var path = library.localePath();
            if (path) {
                _that.localePaths.push(path);
            }
        }
    }
    addPaths(root);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Dialog" id="apidoc.module.botbuilder.Dialog">module botbuilder.Dialog</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Dialog.Dialog" id="apidoc.element.botbuilder.Dialog.Dialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>Dialog
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Dialog() {
    return _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Dialog.prototype" id="apidoc.module.botbuilder.Dialog.prototype">module botbuilder.Dialog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Dialog.prototype.begin" id="apidoc.element.botbuilder.Dialog.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    this.replyReceived(session);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Dialog.prototype.constructor" id="apidoc.element.botbuilder.Dialog.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>constructor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Dialog() {
    return _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Dialog.prototype.dialogResumed" id="apidoc.element.botbuilder.Dialog.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    if (result.error) {
        session.error(result.error);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Dialog.prototype.recognize" id="apidoc.element.botbuilder.Dialog.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.Dialog.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    cb(null, { score: 0.1 });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.DialogAction" id="apidoc.module.botbuilder.DialogAction">module botbuilder.DialogAction</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction.DialogAction" id="apidoc.element.botbuilder.DialogAction.DialogAction">
        function <span class="apidocSignatureSpan">botbuilder.</span>DialogAction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DialogAction() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction.beginDialog" id="apidoc.element.botbuilder.DialogAction.beginDialog">
        function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>beginDialog
        <span class="apidocSignatureSpan">(id, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialog = function (id, args) {
    return function beginDialogAction(s, a) {
        if (a &#x26;&#x26; a.hasOwnProperty(&#x27;resumed&#x27;)) {
            var r = a;
            if (r.error) {
                s.error(r.error);
            }
        }
        else {
            if (args) {
                a = a || {};
                for (var key in args) {
                    if (args.hasOwnProperty(key)) {
                        a[key] = args[key];
                    }
                }
            }
            s.beginDialog(id, a);
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">beginDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction.endDialog" id="apidoc.element.botbuilder.DialogAction.endDialog">
        function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>endDialog
        <span class="apidocSignatureSpan">(result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endDialog = function (result) {
    return function endDialogAction(s) {
        s.endDialog(result);
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.endDialog = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (typeof message === &#x27;object&#x27; &#x26;&#x26; (message.hasOwnProperty(&#x27;response&#x27;) || message.hasOwnProperty
(&#x27;resumed&#x27;) || message.hasOwnProperty(&#x27;error&#x27;))) {
        console.warn(&#x27;Returning results via Session.<span class="apidocCodeKeywordSpan">endDialog</span>() is deprecated. Use
 Session.endDialogWithResult() instead.&#x27;);
        return this.endDialogWithResult(message);
    }
    var cur = this.curDialog();
    if (cur) {
        var m;
        if (message) {
            if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction.send" id="apidoc.element.botbuilder.DialogAction.send">
        function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>send
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    args.splice(0, 0, msg);
    return function sendAction(s) {
        Session_1.Session.prototype.send.apply(s, args);
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.<span class="apidocCodeKeywordSpan">send</span>(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
    console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.DialogAction.validatedPrompt" id="apidoc.element.botbuilder.DialogAction.validatedPrompt">
        function <span class="apidocSignatureSpan">botbuilder.DialogAction.</span>validatedPrompt
        <span class="apidocSignatureSpan">(promptType, validator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validatedPrompt = function (promptType, validator) {
    return new SimpleDialog_1.SimpleDialog(function (s, r) {
        r = r || {};
        var valid = false;
        if (r.response) {
            try {
                valid = validator(r.response);
            }
            catch (e) {
                s.error(e);
            }
        }
        var canceled = false;
        switch (r.resumed) {
            case Dialog_1.ResumeReason.canceled:
            case Dialog_1.ResumeReason.forward:
            case Dialog_1.ResumeReason.back:
                canceled = true;
                break;
        }
        if (valid || canceled) {
            s.endDialogWithResult(r);
        }
        else if (!s.dialogData.hasOwnProperty(&#x27;prompt&#x27;)) {
            s.dialogData = utils.clone(r);
            s.dialogData.promptType = promptType;
            if (!s.dialogData.hasOwnProperty(&#x27;maxRetries&#x27;)) {
                s.dialogData.maxRetries = 2;
            }
            var a = utils.clone(s.dialogData);
            a.maxRetries = 0;
            s.beginDialog(consts.DialogId.Prompts, a);
        }
        else if (s.dialogData.maxRetries &#x3e; 0) {
            s.dialogData.maxRetries--;
            var a = utils.clone(s.dialogData);
            a.maxRetries = 0;
            a.prompt = s.dialogData.retryPrompt || &#x22;I didn&#x27;t understand. &#x22; + s.dialogData.prompt;
            s.beginDialog(consts.DialogId.Prompts, a);
        }
        else {
            s.endDialogWithResult({ resumed: Dialog_1.ResumeReason.notCompleted });
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.EntityRecognizer" id="apidoc.module.botbuilder.EntityRecognizer">module botbuilder.EntityRecognizer</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.EntityRecognizer" id="apidoc.element.botbuilder.EntityRecognizer.EntityRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>EntityRecognizer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EntityRecognizer() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.expandChoices" id="apidoc.element.botbuilder.EntityRecognizer.expandChoices">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>expandChoices
        <span class="apidocSignatureSpan">(choices)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expandChoices = function (choices) {
    if (!choices) {
        return [];
    }
    else if (Array.isArray(choices)) {
        return choices;
    }
    else if (typeof choices == &#x27;string&#x27;) {
        return choices.split(&#x27;|&#x27;);
    }
    else if (typeof choices == &#x27;object&#x27;) {
        var list = [];
        for (var key in choices) {
            list.push(key);
        }
        return list;
    }
    else {
        return [choices.toString()];
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.findAllEntities" id="apidoc.element.botbuilder.EntityRecognizer.findAllEntities">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findAllEntities
        <span class="apidocSignatureSpan">(entities, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findAllEntities = function (entities, type) {
    var found = [];
    for (var i = 0; entities &#x26;&#x26; i &#x3c; entities.length; i++) {
        if (entities[i].type == type) {
            found.push(entities[i]);
        }
    }
    return found;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.findAllMatches" id="apidoc.element.botbuilder.EntityRecognizer.findAllMatches">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findAllMatches
        <span class="apidocSignatureSpan">(choices, utterance, threshold)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findAllMatches = function (choices, utterance, threshold) {
    if (threshold === void 0) { threshold = 0.6; }
    var matches = [];
    utterance = utterance.trim().toLowerCase();
    var tokens = utterance.split(&#x27; &#x27;);
    EntityRecognizer.expandChoices(choices).forEach(function (choice, index) {
        var score = 0.0;
        var value = choice.trim().toLowerCase();
        if (value.indexOf(utterance) &#x3e;= 0) {
            score = utterance.length / value.length;
        }
        else if (utterance.indexOf(value) &#x3e;= 0) {
            score = Math.min(0.5 + (value.length / utterance.length), 0.9);
        }
        else {
            var matched = &#x27;&#x27;;
            tokens.forEach(function (token) {
                if (value.indexOf(token) &#x3e;= 0) {
                    matched += token;
                }
            });
            score = matched.length / value.length;
        }
        if (score &#x3e;= threshold) {
            matches.push({ index: index, entity: choice, score: score });
        }
    });
    return matches;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.findBestMatch" id="apidoc.element.botbuilder.EntityRecognizer.findBestMatch">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findBestMatch
        <span class="apidocSignatureSpan">(choices, utterance, threshold)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findBestMatch = function (choices, utterance, threshold) {
    if (threshold === void 0) { threshold = 0.6; }
    var best;
    var matches = EntityRecognizer.findAllMatches(choices, utterance, threshold);
    matches.forEach(function (value) {
        if (!best || value.score &#x3e; best.score) {
            best = value;
        }
    });
    return best;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.findEntity" id="apidoc.element.botbuilder.EntityRecognizer.findEntity">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>findEntity
        <span class="apidocSignatureSpan">(entities, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findEntity = function (entities, type) {
    for (var i = 0; entities &#x26;&#x26; i &#x3c; entities.length; i++) {
        if (entities[i].type == type) {
            return entities[i];
        }
    }
    return null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.parseBoolean" id="apidoc.element.botbuilder.EntityRecognizer.parseBoolean">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseBoolean
        <span class="apidocSignatureSpan">(utterance)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseBoolean = function (utterance) {
    utterance = utterance.trim();
    if (EntityRecognizer.yesExp.test(utterance)) {
        return true;
    }
    else if (EntityRecognizer.noExp.test(utterance)) {
        return false;
    }
    return undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.parseNumber" id="apidoc.element.botbuilder.EntityRecognizer.parseNumber">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseNumber
        <span class="apidocSignatureSpan">(entities)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseNumber = function (entities) {
    var entity;
    if (typeof entities == &#x27;string&#x27;) {
        entity = { type: &#x27;text&#x27;, entity: entities.trim() };
    }
    else {
        entity = EntityRecognizer.findEntity(entities, &#x27;builtin.number&#x27;);
    }
    if (entity) {
        var match = this.numberExp.exec(entity.entity);
        if (match) {
            return Number(match[0]);
        }
        var oWordMatch = this.findBestMatch(this.ordinalWords, entity.entity, 1.0);
        if (oWordMatch) {
            return oWordMatch.index + 1;
        }
    }
    return Number.NaN;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.parseTime" id="apidoc.element.botbuilder.EntityRecognizer.parseTime">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>parseTime
        <span class="apidocSignatureSpan">(entities)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseTime = function (entities) {
    if (typeof entities == &#x27;string&#x27;) {
        entities = [EntityRecognizer.recognizeTime(entities)];
    }
    return EntityRecognizer.resolveTime(entities);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.recognizeTime" id="apidoc.element.botbuilder.EntityRecognizer.recognizeTime">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>recognizeTime
        <span class="apidocSignatureSpan">(utterance, refDate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizeTime = function (utterance, refDate) {
    var response;
    try {
        var results = chrono.parse(utterance, refDate);
        if (results &#x26;&#x26; results.length &#x3e; 0) {
            var duration = results[0];
            response = {
                type: &#x27;chrono.duration&#x27;,
                entity: duration.text,
                startIndex: duration.index,
                endIndex: duration.index + duration.text.length,
                resolution: {
                    resolution_type: &#x27;chrono.duration&#x27;,
                    start: duration.start.date()
                }
            };
            if (duration.end) {
                response.resolution.end = duration.end.date();
            }
            if (duration.ref) {
                response.resolution.ref = duration.ref;
            }
            response.score = duration.text.length / utterance.length;
        }
    }
    catch (err) {
        console.error(&#x27;Error recognizing time: &#x27; + err.toString());
        response = null;
    }
    return response;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.EntityRecognizer.resolveTime" id="apidoc.element.botbuilder.EntityRecognizer.resolveTime">
        function <span class="apidocSignatureSpan">botbuilder.EntityRecognizer.</span>resolveTime
        <span class="apidocSignatureSpan">(entities)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolveTime = function (entities) {
    var _this = this;
    var now = new Date();
    var resolvedDate;
    var date;
    var time;
    entities.forEach(function (entity) {
        if (entity.resolution) {
            switch (entity.resolution.resolution_type || entity.type) {
                case &#x27;builtin.datetime&#x27;:
                case &#x27;builtin.datetime.date&#x27;:
                case &#x27;builtin.datetime.time&#x27;:
                    var parts = (entity.resolution.date || entity.resolution.time).split(&#x27;T&#x27;);
                    if (!date &#x26;&#x26; _this.dateExp.test(parts[0])) {
                        date = parts[0];
                    }
                    if (!time &#x26;&#x26; parts[1]) {
                        time = &#x27;T&#x27; + parts[1];
                        if (time == &#x27;TMO&#x27;) {
                            time = &#x27;T08:00:00&#x27;;
                        }
                        else if (time == &#x27;TNI&#x27;) {
                            time = &#x27;T20:00:00&#x27;;
                        }
                        else if (time.length == 3) {
                            time = time + &#x27;:00:00&#x27;;
                        }
                        else if (time.length == 6) {
                            time = time + &#x27;:00&#x27;;
                        }
                    }
                    break;
                case &#x27;chrono.duration&#x27;:
                    var duration = entity;
                    resolvedDate = duration.resolution.start;
            }
        }
    });
    if (!resolvedDate &#x26;&#x26; (date || time)) {
        if (!date) {
            date = utils.toDate8601(now);
        }
        if (time) {
            date += time;
        }
        resolvedDate = new Date(date);
    }
    return resolvedDate;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>












</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Fact" id="apidoc.module.botbuilder.Fact">module botbuilder.Fact</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Fact.Fact" id="apidoc.element.botbuilder.Fact.Fact">
        function <span class="apidocSignatureSpan">botbuilder.</span>Fact
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Fact(session) {
    this.session = session;
    this.data = { value: &#x27;&#x27; };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Fact.create" id="apidoc.element.botbuilder.Fact.create">
        function <span class="apidocSignatureSpan">botbuilder.Fact.</span>create
        <span class="apidocSignatureSpan">(session, value, key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (session, value, key) {
    return new Fact(session).value(value).key(key);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



&#x22;use strict&#x22;;
var __extends = (this &#x26;&#x26; this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.<span class="apidocCodeKeywordSpan">create</span>(b) : (__.prototype = b.prototype, new __
());
};
var Dialog_1 = require(&#x22;./dialogs/Dialog&#x22;);
var Message_1 = require(&#x22;./Message&#x22;);
var consts = require(&#x22;./consts&#x22;);
var logger = require(&#x22;./logger&#x22;);
var sprintf = require(&#x22;sprintf-js&#x22;);
var events = require(&#x22;events&#x22;);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Fact.prototype" id="apidoc.module.botbuilder.Fact.prototype">module botbuilder.Fact.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Fact.prototype.key" id="apidoc.element.botbuilder.Fact.prototype.key">
        function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>key
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">key = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.key = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Fact.prototype.toFact" id="apidoc.element.botbuilder.Fact.prototype.toFact">
        function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>toFact
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toFact = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Fact.prototype.value" id="apidoc.element.botbuilder.Fact.prototype.value">
        function <span class="apidocSignatureSpan">botbuilder.Fact.prototype.</span>value
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">value = function (v) {
    this.data.value = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.HeroCard" id="apidoc.module.botbuilder.HeroCard">module botbuilder.HeroCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.HeroCard.HeroCard" id="apidoc.element.botbuilder.HeroCard.HeroCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>HeroCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HeroCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.hero&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            isOldSchema = true;
            break;
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.<span class="apidocCodeKeywordSpan">HeroCard</span>();
    if (v2.title) {
        card.title(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.HeroCard.prototype" id="apidoc.module.botbuilder.HeroCard.prototype">module botbuilder.HeroCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.HeroCard.prototype.constructor" id="apidoc.element.botbuilder.HeroCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.HeroCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HeroCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.hero&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.IntentDialog" id="apidoc.module.botbuilder.IntentDialog">module botbuilder.IntentDialog</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.IntentDialog" id="apidoc.element.botbuilder.IntentDialog.IntentDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>IntentDialog
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IntentDialog(options) {
    if (options === void 0) { options = {}; }
    var _this = _super.call(this) || this;
    _this.handlers = {};
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet(options);
    if (typeof options.recognizeMode !== &#x22;undefined&#x22;) {
        _this.recognizeMode = options.recognizeMode;
    }
    else {
        _this.recognizeMode = RecognizeMode.onBeginIfRoot;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.IntentDialog.prototype" id="apidoc.module.botbuilder.IntentDialog.prototype">module botbuilder.IntentDialog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.begin" id="apidoc.element.botbuilder.IntentDialog.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    var _this = this;
    var mode = this.recognizeMode;
    var isRoot = (session.sessionState.callstack.length == 1);
    var recognize = (mode == RecognizeMode.onBegin || (isRoot &#x26;&#x26; mode == RecognizeMode.onBeginIfRoot));
    if (this.beginDialog) {
        try {
            logger.info(session, &#x27;IntentDialog.begin()&#x27;);
            this.beginDialog(session, args, function () {
                if (recognize) {
                    _this.replyReceived(session);
                }
            });
        }
        catch (e) {
            this.emitError(session, e);
        }
    }
    else if (recognize) {
        this.replyReceived(session);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.constructor" id="apidoc.element.botbuilder.IntentDialog.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>constructor
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IntentDialog(options) {
    if (options === void 0) { options = {}; }
    var _this = _super.call(this) || this;
    _this.handlers = {};
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet(options);
    if (typeof options.recognizeMode !== &#x22;undefined&#x22;) {
        _this.recognizeMode = options.recognizeMode;
    }
    else {
        _this.recognizeMode = RecognizeMode.onBeginIfRoot;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.dialogResumed" id="apidoc.element.botbuilder.IntentDialog.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    var activeIntent = session.dialogData[consts.Data.Intent];
    if (activeIntent &#x26;&#x26; this.handlers.hasOwnProperty(activeIntent)) {
        try {
            this.handlers[activeIntent](session, result);
        }
        catch (e) {
            this.emitError(session, e);
        }
    }
    else {
        _super.prototype.dialogResumed.call(this, session, result);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.emitError" id="apidoc.element.botbuilder.IntentDialog.prototype.emitError">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>emitError
        <span class="apidocSignatureSpan">(session, err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emitError = function (session, err) {
    var m = err.toString();
    err = err instanceof Error ? err : new Error(m);
    session.error(err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.invokeIntent" id="apidoc.element.botbuilder.IntentDialog.prototype.invokeIntent">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>invokeIntent
        <span class="apidocSignatureSpan">(session, recognizeResult)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">invokeIntent = function (session, recognizeResult) {
    var activeIntent;
    if (recognizeResult.intent &#x26;&#x26; this.handlers.hasOwnProperty(recognizeResult.intent)) {
        logger.info(session, &#x27;IntentDialog.matches(%s)&#x27;, recognizeResult.intent);
        activeIntent = recognizeResult.intent;
    }
    else if (this.handlers.hasOwnProperty(consts.Intents.Default)) {
        logger.info(session, &#x27;IntentDialog.onDefault()&#x27;);
        activeIntent = consts.Intents.Default;
    }
    if (activeIntent) {
        try {
            session.dialogData[consts.Data.Intent] = activeIntent;
            this.handlers[activeIntent](session, recognizeResult);
        }
        catch (e) {
            this.emitError(session, e);
        }
    }
    else {
        logger.warn(session, &#x27;IntentDialog - no intent handler found for %s&#x27;, recognizeResult.intent);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.matches" id="apidoc.element.botbuilder.IntentDialog.prototype.matches">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>matches
        <span class="apidocSignatureSpan">(intent, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">matches = function (intent, dialogId, dialogArgs) {
    var id;
    if (intent) {
        if (typeof intent === &#x27;string&#x27;) {
            id = intent;
        }
        else {
            id = intent.toString();
            this.recognizers.recognizer(new RegExpRecognizer_1.RegExpRecognizer(id, intent));
        }
    }
    if (this.handlers.hasOwnProperty(id)) {
        throw new Error(&#x22;A handler for &#x27;&#x22; + id + &#x22;&#x27; already exists.&#x22;);
    }
    if (Array.isArray(dialogId)) {
        this.handlers[id] = SimpleDialog_1.createWaterfall(dialogId);
    }
    else if (typeof dialogId === &#x27;string&#x27;) {
        this.handlers[id] = DialogAction_1.DialogAction.beginDialog(dialogId, dialogArgs);
    }
    else {
        this.handlers[id] = SimpleDialog_1.createWaterfall([dialogId]);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.matchesAny" id="apidoc.element.botbuilder.IntentDialog.prototype.matchesAny">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>matchesAny
        <span class="apidocSignatureSpan">(intents, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">matchesAny = function (intents, dialogId, dialogArgs) {
    for (var i = 0; i &#x3c; intents.length; i++) {
        this.matches(intents[i], dialogId, dialogArgs);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.onBegin" id="apidoc.element.botbuilder.IntentDialog.prototype.onBegin">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>onBegin
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onBegin = function (handler) {
    this.beginDialog = handler;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.onDefault" id="apidoc.element.botbuilder.IntentDialog.prototype.onDefault">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>onDefault
        <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onDefault = function (dialogId, dialogArgs) {
    if (Array.isArray(dialogId)) {
        this.handlers[consts.Intents.Default] = SimpleDialog_1.createWaterfall(dialogId);
    }
    else if (typeof dialogId === &#x27;string&#x27;) {
        this.handlers[consts.Intents.Default] = DialogAction_1.DialogAction.beginDialog(dialogId, dialogArgs);
    }
    else {
        this.handlers[consts.Intents.Default] = SimpleDialog_1.createWaterfall([dialogId]);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.recognize" id="apidoc.element.botbuilder.IntentDialog.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    this.recognizers.recognize(context, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.recognizer" id="apidoc.element.botbuilder.IntentDialog.prototype.recognizer">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>recognizer
        <span class="apidocSignatureSpan">(plugin)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizer = function (plugin) {
    this.recognizers.recognizer(plugin);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentDialog.prototype.replyReceived" id="apidoc.element.botbuilder.IntentDialog.prototype.replyReceived">
        function <span class="apidocSignatureSpan">botbuilder.IntentDialog.prototype.</span>replyReceived
        <span class="apidocSignatureSpan">(session, recognizeResult)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replyReceived = function (session, recognizeResult) {
    var _this = this;
    if (!recognizeResult) {
        var locale = session.preferredLocale();
        var context = session.toRecognizeContext();
        context.dialogData = session.dialogData;
        context.activeDialog = true;
        this.recognize(context, function (err, result) {
            if (!err) {
                _this.invokeIntent(session, result);
            }
            else {
                _this.emitError(session, err);
            }
        });
    }
    else {
        this.invokeIntent(session, recognizeResult);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.<span class="apidocCodeKeywordSpan">replyReceived</span>(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.IntentRecognizerSet" id="apidoc.module.botbuilder.IntentRecognizerSet">module botbuilder.IntentRecognizerSet</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.IntentRecognizerSet" id="apidoc.element.botbuilder.IntentRecognizerSet.IntentRecognizerSet">
        function <span class="apidocSignatureSpan">botbuilder.</span>IntentRecognizerSet
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IntentRecognizerSet(options) {
    if (options === void 0) { options = {}; }
    this.options = options;
    if (typeof this.options.intentThreshold !== &#x27;number&#x27;) {
        this.options.intentThreshold = 0.1;
    }
    if (!this.options.hasOwnProperty(&#x27;recognizeOrder&#x27;)) {
        this.options.recognizeOrder = RecognizeOrder.parallel;
    }
    if (!this.options.recognizers) {
        this.options.recognizers = [];
    }
    if (!this.options.processLimit) {
        this.options.processLimit = 4;
    }
    if (!this.options.hasOwnProperty(&#x27;stopIfExactMatch&#x27;)) {
        this.options.stopIfExactMatch = true;
    }
    this.length = this.options.recognizers.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.IntentRecognizerSet.prototype" id="apidoc.module.botbuilder.IntentRecognizerSet.prototype">module botbuilder.IntentRecognizerSet.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.clone" id="apidoc.element.botbuilder.IntentRecognizerSet.prototype.clone">
        function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>clone
        <span class="apidocSignatureSpan">(copyTo)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function (copyTo) {
    var obj = copyTo || new IntentRecognizerSet(utils.clone(this.options));
    obj.options.recognizers = this.options.recognizers.slice(0);
    return obj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else if (map.hasOwnProperty(&#x27;*&#x27;)) {
            this.data.sourceEvent = map[&#x27;*&#x27;];
        }
    }
    return this;
};
Message.prototype.toMessage = function () {
    return utils.<span class="apidocCodeKeywordSpan">clone</span>(this.data);
};
Message.prototype.upgradeAttachment = function (a) {
    var isOldSchema = false;
    for (var prop in a) {
        switch (prop) {
            case &#x27;actions&#x27;:
            case &#x27;fallbackText&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognize" id="apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, done) {
    if (this.options.recognizeOrder == RecognizeOrder.parallel) {
        this.recognizeInParallel(context, done);
    }
    else {
        this.recognizeInSeries(context, done);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInParallel" id="apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInParallel">
        function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizeInParallel
        <span class="apidocSignatureSpan">(context, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizeInParallel = function (context, done) {
    var _this = this;
    var result = { score: 0.0, intent: null };
    async.eachLimit(this.options.recognizers, this.options.processLimit, function (recognizer, cb) {
        try {
            recognizer.recognize(context, function (err, r) {
                if (!err &#x26;&#x26; r &#x26;&#x26; r.score &#x3e; result.score &#x26;&#x26; r.score &#x3e;= _this.options.intentThreshold) {
                    result = r;
                }
                cb(err);
            });
        }
        catch (e) {
            cb(e);
        }
    }, function (err) {
        if (!err) {
            done(null, result);
        }
        else {
            var msg = err.toString();
            done(err instanceof Error ? err : new Error(msg), null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInSeries" id="apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizeInSeries">
        function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizeInSeries
        <span class="apidocSignatureSpan">(context, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizeInSeries = function (context, done) {
    var _this = this;
    var i = 0;
    var result = { score: 0.0, intent: null };
    async.whilst(function () {
        return (i &#x3c; _this.options.recognizers.length &#x26;&#x26; (result.score &#x3c; 1.0 || !_this.options.stopIfExactMatch));
    }, function (cb) {
        try {
            var recognizer = _this.options.recognizers[i++];
            recognizer.recognize(context, function (err, r) {
                if (!err &#x26;&#x26; r &#x26;&#x26; r.score &#x3e; result.score &#x26;&#x26; r.score &#x3e;= _this.options.intentThreshold) {
                    result = r;
                }
                cb(err);
            });
        }
        catch (e) {
            cb(e);
        }
    }, function (err) {
        if (!err) {
            done(null, result);
        }
        else {
            done(err instanceof Error ? err : new Error(err.toString()), null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizer" id="apidoc.element.botbuilder.IntentRecognizerSet.prototype.recognizer">
        function <span class="apidocSignatureSpan">botbuilder.IntentRecognizerSet.prototype.</span>recognizer
        <span class="apidocSignatureSpan">(plugin)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizer = function (plugin) {
    this.options.recognizers.push(plugin);
    this.length++;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Keyboard" id="apidoc.module.botbuilder.Keyboard">module botbuilder.Keyboard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Keyboard.Keyboard" id="apidoc.element.botbuilder.Keyboard.Keyboard">
        function <span class="apidocSignatureSpan">botbuilder.</span>Keyboard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Keyboard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.keyboard&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Keyboard.prototype" id="apidoc.module.botbuilder.Keyboard.prototype">module botbuilder.Keyboard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Keyboard.prototype.buttons" id="apidoc.element.botbuilder.Keyboard.prototype.buttons">
        function <span class="apidocSignatureSpan">botbuilder.Keyboard.prototype.</span>buttons
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buttons = function (list) {
    this.data.content.buttons = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var action = list[i];
            this.data.content.buttons.push(action.toAction ? action.toAction() : action);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                    CardAction_1.CardAction.imBack(null, old.message, old.title) :
                    CardAction_1.CardAction.openUrl(null, old.url, old.title);
                if (old.image) {
                    btn.image(old.image);
                }
                list.push(btn);
            }
            card.<span class="apidocCodeKeywordSpan">buttons</span>(list);
        }
        return card.toAttachment();
    }
    else {
        return a;
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Keyboard.prototype.toAttachment" id="apidoc.element.botbuilder.Keyboard.prototype.toAttachment">
        function <span class="apidocSignatureSpan">botbuilder.Keyboard.prototype.</span>toAttachment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toAttachment = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            this.addAttachment(list[i]);
        }
    }
    return this;
};
Message.prototype.addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.<span class="apidocCodeKeywordSpan">toAttachment</span>() : attachment;
        a = this.upgradeAttachment(a);
        if (!this.data.attachments) {
            this.data.attachments = [a];
        }
        else {
            this.data.attachments.push(a);
        }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Library" id="apidoc.module.botbuilder.Library">module botbuilder.Library</a></h1>




    <h2>
        <a href="#apidoc.element.botbuilder.Library.Library" id="apidoc.element.botbuilder.Library.Library">
        function <span class="apidocSignatureSpan">botbuilder.</span>Library
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Library(name) {
    var _this = _super.call(this) || this;
    _this.name = name;
    _this.dialogs = {};
    _this.libraries = {};
    _this.actions = new ActionSet_1.ActionSet();
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet();
    _this.triggersAdded = false;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.EventEmitter" id="apidoc.element.botbuilder.Library.EventEmitter">
        function <span class="apidocSignatureSpan">botbuilder.Library.</span>EventEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.addRouteResult" id="apidoc.element.botbuilder.Library.addRouteResult">
        function <span class="apidocSignatureSpan">botbuilder.Library.</span>addRouteResult
        <span class="apidocSignatureSpan">(route, current)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRouteResult = function (route, current) {
    if (!current || current.length &#x3c; 1 || route.score &#x3e; current[0].score) {
        current = [route];
    }
    else if (route.score == current[0].score) {
        current.push(route);
    }
    return current;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.bestRouteResult" id="apidoc.element.botbuilder.Library.bestRouteResult">
        function <span class="apidocSignatureSpan">botbuilder.Library.</span>bestRouteResult
        <span class="apidocSignatureSpan">(routes, dialogStack, rootLibraryName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bestRouteResult = function (routes, dialogStack, rootLibraryName) {
    var bestLibrary = rootLibraryName;
    if (dialogStack) {
        dialogStack.forEach(function (entry) {
            var parts = entry.id.split(&#x27;:&#x27;);
            for (var i = 0; i &#x3c; routes.length; i++) {
                if (routes[i].libraryName == parts[0]) {
                    bestLibrary = parts[0];
                    break;
                }
            }
        });
    }
    var best;
    var bestPriority = 5;
    for (var i = 0; i &#x3c; routes.length; i++) {
        var r = routes[i];
        if (r.score &#x3e; 0.0) {
            var priority;
            switch (r.routeType) {
                default:
                    priority = 1;
                    break;
                case Library.RouteTypes.ActiveDialog:
                    priority = 2;
                    break;
                case Library.RouteTypes.StackAction:
                    priority = 3;
                    break;
                case Library.RouteTypes.GlobalAction:
                    priority = 4;
                    break;
            }
            if (priority &#x3c; bestPriority) {
                best = r;
                bestPriority = priority;
            }
            else if (priority == bestPriority) {
                switch (priority) {
                    case 3:
                        if (r.routeData.dialogIndex &#x3e; best.routeData.dialogIndex) {
                            best = r;
                        }
                        break;
                    case 4:
                        if (bestLibrary &#x26;&#x26; best.libraryName !== bestLibrary &#x26;&#x26; r.libraryName == bestLibrary) {
                            best = r;
                        }
                        break;
                }
            }
        }
    }
    return best;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.init" id="apidoc.element.botbuilder.Library.init">
        function <span class="apidocSignatureSpan">botbuilder.Library.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  this.domain = null;
  if (EventEmitter.usingDomains) {
    // if there is an active domain, then attach to it.
    domain = domain || require(&#x27;domain&#x27;);
    if (domain.active &#x26;&#x26; !(this instanceof domain.Domain)) {
      this.domain = domain.active;
    }
  }

  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {
    this._events = new EventHandlers();
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.listenerCount" id="apidoc.element.botbuilder.Library.listenerCount">
        function <span class="apidocSignatureSpan">botbuilder.Library.</span>listenerCount
        <span class="apidocSignatureSpan">(emitter, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenerCount = function (emitter, type) {
  if (typeof emitter.listenerCount === &#x27;function&#x27;) {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Library.prototype" id="apidoc.module.botbuilder.Library.prototype">module botbuilder.Library.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.beginDialogAction" id="apidoc.element.botbuilder.Library.prototype.beginDialogAction">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>beginDialogAction
        <span class="apidocSignatureSpan">(name, id, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialogAction = function (name, id, options) {
    this.actions.beginDialogAction(name, id, options);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.clone" id="apidoc.element.botbuilder.Library.prototype.clone">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>clone
        <span class="apidocSignatureSpan">(copyTo, newName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function (copyTo, newName) {
    var obj = copyTo || new Library(newName || this.name);
    for (var id in this.dialogs) {
        obj.dialogs[id] = this.dialogs[id];
    }
    for (var name in this.libraries) {
        obj.libraries[name] = this.libraries[name];
    }
    this.actions.clone(obj.actions);
    this.recognizers.clone(obj.recognizers);
    obj._localePath = this._localePath;
    obj._onFindRoutes = this._onFindRoutes;
    obj._onSelectRoute = this._onSelectRoute;
    obj.triggersAdded = this.triggersAdded;
    return obj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else if (map.hasOwnProperty(&#x27;*&#x27;)) {
            this.data.sourceEvent = map[&#x27;*&#x27;];
        }
    }
    return this;
};
Message.prototype.toMessage = function () {
    return utils.<span class="apidocCodeKeywordSpan">clone</span>(this.data);
};
Message.prototype.upgradeAttachment = function (a) {
    var isOldSchema = false;
    for (var prop in a) {
        switch (prop) {
            case &#x27;actions&#x27;:
            case &#x27;fallbackText&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.constructor" id="apidoc.element.botbuilder.Library.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>constructor
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Library(name) {
    var _this = _super.call(this) || this;
    _this.name = name;
    _this.dialogs = {};
    _this.libraries = {};
    _this.actions = new ActionSet_1.ActionSet();
    _this.recognizers = new IntentRecognizerSet_1.IntentRecognizerSet();
    _this.triggersAdded = false;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.defaultFindRoutes" id="apidoc.element.botbuilder.Library.prototype.defaultFindRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>defaultFindRoutes
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">defaultFindRoutes = function (context, callback) {
    var _this = this;
    var results = Library.addRouteResult({ score: 0.0, libraryName: this.name });
    this.recognize(context, function (err, topIntent) {
        if (!err) {
            var ctx = utils.clone(context);
            ctx.intent = topIntent &#x26;&#x26; topIntent.score &#x3e; 0 ? topIntent : null;
            ctx.libraryName = _this.name;
            async.parallel([
                function (cb) {
                    _this.findActiveDialogRoutes(ctx, function (err, routes) {
                        if (!err &#x26;&#x26; routes) {
                            routes.forEach(function (r) { return results = Library.addRouteResult(r, results); });
                        }
                        cb(err);
                    });
                },
                function (cb) {
                    _this.findStackActionRoutes(ctx, function (err, routes) {
                        if (!err &#x26;&#x26; routes) {
                            routes.forEach(function (r) { return results = Library.addRouteResult(r, results); });
                        }
                        cb(err);
                    });
                },
                function (cb) {
                    _this.findGlobalActionRoutes(ctx, function (err, routes) {
                        if (!err &#x26;&#x26; routes) {
                            routes.forEach(function (r) { return results = Library.addRouteResult(r, results); });
                        }
                        cb(err);
                    });
                }
            ], function (err) {
                if (!err) {
                    callback(null, results);
                }
                else {
                    callback(err, null);
                }
            });
        }
        else {
            callback(err, null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.defaultSelectRoute" id="apidoc.element.botbuilder.Library.prototype.defaultSelectRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>defaultSelectRoute
        <span class="apidocSignatureSpan">(session, route)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">defaultSelectRoute = function (session, route) {
    switch (route.routeType || &#x27;&#x27;) {
        case Library.RouteTypes.ActiveDialog:
            this.selectActiveDialogRoute(session, route);
            break;
        case Library.RouteTypes.StackAction:
            this.selectStackActionRoute(session, route);
            break;
        case Library.RouteTypes.GlobalAction:
            this.selectGlobalActionRoute(session, route);
            break;
        default:
            throw new Error(&#x27;Invalid route type passed to Library.selectRoute().&#x27;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.dialog" id="apidoc.element.botbuilder.Library.prototype.dialog">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>dialog
        <span class="apidocSignatureSpan">(id, dialog)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialog = function (id, dialog) {
    var d;
    if (dialog) {
        if (id.indexOf(&#x27;:&#x27;) &#x3e;= 0) {
            id = id.split(&#x27;:&#x27;)[1];
        }
        if (this.dialogs.hasOwnProperty(id)) {
            throw new Error(&#x22;Dialog[&#x22; + id + &#x22;] already exists in library[&#x22; + this.name + &#x22;].&#x22;);
        }
        if (Array.isArray(dialog)) {
            d = new SimpleDialog_1.SimpleDialog(SimpleDialog_1.createWaterfall(dialog));
        }
        else if (typeof dialog == &#x27;function&#x27;) {
            d = new SimpleDialog_1.SimpleDialog(SimpleDialog_1.createWaterfall([dialog]));
        }
        else {
            d = dialog;
        }
        this.dialogs[id] = d;
    }
    else if (this.dialogs.hasOwnProperty(id)) {
        d = this.dialogs[id];
    }
    return d;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.<span class="apidocCodeKeywordSpan">dialog</span>(&#x27;/&#x27;, function (session) {
    session.send(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.endConversationAction" id="apidoc.element.botbuilder.Library.prototype.endConversationAction">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>endConversationAction
        <span class="apidocSignatureSpan">(name, msg, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endConversationAction = function (name, msg, options) {
    this.actions.endConversationAction(name, msg, options);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.findActiveDialogRoutes" id="apidoc.element.botbuilder.Library.prototype.findActiveDialogRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findActiveDialogRoutes
        <span class="apidocSignatureSpan">(context, callback, dialogStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findActiveDialogRoutes = function (context, callback, dialogStack) {
    var _this = this;
    if (!dialogStack) {
        dialogStack = context.dialogStack();
    }
    var results = Library.addRouteResult({ score: 0.0, libraryName: this.name });
    var entry = Session_1.Session.activeDialogStackEntry(dialogStack);
    var parts = entry ? entry.id.split(&#x27;:&#x27;) : null;
    if (parts &#x26;&#x26; parts[0] == this.name) {
        var dialog = this.dialog(parts[1]);
        if (dialog) {
            var ctx = utils.clone(context);
            ctx.libraryName = this.name;
            ctx.dialogData = entry.state;
            ctx.activeDialog = true;
            dialog.recognize(ctx, function (err, result) {
                if (!err) {
                    if (result.score &#x3c; 0.1) {
                        result.score = 0.1;
                    }
                    callback(null, Library.addRouteResult({
                        score: result.score,
                        libraryName: _this.name,
                        routeType: Library.RouteTypes.ActiveDialog,
                        routeData: result
                    }, results));
                }
                else {
                    callback(err, null);
                }
            });
        }
        else {
            logger.warn(ctx, &#x22;Active dialog &#x27;%s&#x27; not found in library.&#x22;, entry.id);
            callback(null, results);
        }
    }
    else {
        callback(null, results);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.findDialog" id="apidoc.element.botbuilder.Library.prototype.findDialog">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findDialog
        <span class="apidocSignatureSpan">(libName, dialogId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findDialog = function (libName, dialogId) {
    var d;
    var lib = this.library(libName);
    if (lib) {
        d = lib.dialog(dialogId);
    }
    return d;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.<span class="apidocCodeKeywordSpan">findDialog</span>(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.findGlobalActionRoutes" id="apidoc.element.botbuilder.Library.prototype.findGlobalActionRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findGlobalActionRoutes
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findGlobalActionRoutes = function (context, callback) {
    var results = Library.addRouteResult({ score: 0.0, libraryName: this.name });
    var ctx = utils.clone(context);
    ctx.libraryName = this.name;
    ctx.routeType = Library.RouteTypes.GlobalAction;
    this.actions.findActionRoutes(ctx, function (err, ra) {
        if (!err) {
            for (var i = 0; i &#x3c; ra.length; i++) {
                var r = ra[i];
                results = Library.addRouteResult(r, results);
            }
            callback(null, results);
        }
        else {
            callback(err, null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.findRoutes" id="apidoc.element.botbuilder.Library.prototype.findRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findRoutes
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findRoutes = function (context, callback) {
    var _this = this;
    if (!this.triggersAdded) {
        this.forEachDialog(function (dialog, id) { return dialog.addDialogTrigger(_this.actions, _this.name + &#x27;:&#x27; + id); });
        this.triggersAdded = true;
    }
    if (this._onFindRoutes) {
        this._onFindRoutes(context, callback);
    }
    else {
        this.defaultFindRoutes(context, callback);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.findStackActionRoutes" id="apidoc.element.botbuilder.Library.prototype.findStackActionRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>findStackActionRoutes
        <span class="apidocSignatureSpan">(context, callback, dialogStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findStackActionRoutes = function (context, callback, dialogStack) {
    var _this = this;
    if (!dialogStack) {
        dialogStack = context.dialogStack();
    }
    var results = Library.addRouteResult({ score: 0.0, libraryName: this.name });
    var ctx = utils.clone(context);
    ctx.libraryName = this.name;
    ctx.routeType = Library.RouteTypes.StackAction;
    async.forEachOf(dialogStack || [], function (entry, index, next) {
        var parts = entry.id.split(&#x27;:&#x27;);
        if (parts[0] == _this.name) {
            var dialog = _this.dialog(parts[1]);
            if (dialog) {
                dialog.findActionRoutes(ctx, function (err, ra) {
                    if (!err) {
                        for (var i = 0; i &#x3c; ra.length; i++) {
                            var r = ra[i];
                            if (r.routeData) {
                                r.routeData.dialogId = entry.id;
                                r.routeData.dialogIndex = index;
                            }
                            results = Library.addRouteResult(r, results);
                        }
                    }
                    next(err);
                });
            }
            else {
                logger.warn(ctx, &#x22;Dialog &#x27;%s&#x27; not found in library.&#x22;, entry.id);
                next(null);
            }
        }
        else {
            next(null);
        }
    }, function (err) {
        if (!err) {
            callback(null, results);
        }
        else {
            callback(err, null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.forEachDialog" id="apidoc.element.botbuilder.Library.prototype.forEachDialog">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>forEachDialog
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEachDialog = function (callback) {
    for (var id in this.dialogs) {
        callback(this.dialog(id), id);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.forEachLibrary" id="apidoc.element.botbuilder.Library.prototype.forEachLibrary">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>forEachLibrary
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEachLibrary = function (callback) {
    for (var lib in this.libraries) {
        callback(this.libraries[lib]);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.locales = {};
this.defaultLocale(defaultLocale || &#x27;en&#x27;);
var libsSeen = {};
var _that = this;
function addPaths(library) {
    if (!libsSeen.hasOwnProperty(library.name)) {
        libsSeen[library.name] = true;
        library.<span class="apidocCodeKeywordSpan">forEachLibrary</span>(function (child) {
            addPaths(child);
        });
        var path = library.localePath();
        if (path) {
            _that.localePaths.push(path);
        }
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.library" id="apidoc.element.botbuilder.Library.prototype.library">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>library
        <span class="apidocSignatureSpan">(lib)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">library = function (lib) {
    var l;
    if (typeof lib === &#x27;string&#x27;) {
        if (lib == this.name) {
            l = this;
        }
        else if (this.libraries.hasOwnProperty(lib)) {
            l = this.libraries[lib];
        }
        else {
            for (var name in this.libraries) {
                l = this.libraries[name].library(lib);
                if (l) {
                    break;
                }
            }
        }
    }
    else {
        l = this.libraries[lib.name] = lib;
    }
    return l;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.libraryList" id="apidoc.element.botbuilder.Library.prototype.libraryList">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>libraryList
        <span class="apidocSignatureSpan">(reverse)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">libraryList = function (reverse) {
    if (reverse === void 0) { reverse = false; }
    var list = [];
    var added = {};
    function addChildren(lib) {
        if (!added.hasOwnProperty(lib.name)) {
            added[lib.name] = true;
            if (!reverse) {
                list.push(lib);
            }
            lib.forEachLibrary(function (child) { return addChildren(child); });
            if (reverse) {
                list.push(lib);
            }
        }
    }
    addChildren(this);
    return list;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.localePath" id="apidoc.element.botbuilder.Library.prototype.localePath">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>localePath
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">localePath = function (path) {
    if (path) {
        this._localePath = path;
    }
    return this._localePath;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var _that = this;
    function addPaths(library) {
        if (!libsSeen.hasOwnProperty(library.name)) {
            libsSeen[library.name] = true;
            library.forEachLibrary(function (child) {
                addPaths(child);
            });
            var path = library.<span class="apidocCodeKeywordSpan">localePath</span>();
            if (path) {
                _that.localePaths.push(path);
            }
        }
    }
    addPaths(root);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.onFindRoutes" id="apidoc.element.botbuilder.Library.prototype.onFindRoutes">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>onFindRoutes
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onFindRoutes = function (handler) {
    this._onFindRoutes = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.onSelectRoute" id="apidoc.element.botbuilder.Library.prototype.onSelectRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>onSelectRoute
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onSelectRoute = function (handler) {
    this._onSelectRoute = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.recognize" id="apidoc.element.botbuilder.Library.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, callback) {
    if (this.recognizers.length &#x3e; 0 &#x26;&#x26; context.libraryName !== this.name) {
        this.recognizers.recognize(context, callback);
    }
    else {
        callback(null, context.intent || { intent: &#x27;None&#x27;, score: 0.0 });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.recognizer" id="apidoc.element.botbuilder.Library.prototype.recognizer">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>recognizer
        <span class="apidocSignatureSpan">(plugin)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognizer = function (plugin) {
    this.recognizers.recognizer(plugin);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.selectActiveDialogRoute" id="apidoc.element.botbuilder.Library.prototype.selectActiveDialogRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectActiveDialogRoute
        <span class="apidocSignatureSpan">(session, route, newStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">selectActiveDialogRoute = function (session, route, newStack) {
    if (!route || route.libraryName !== this.name || route.routeType !== Library.RouteTypes.ActiveDialog) {
        throw new Error(&#x27;Invalid route type passed to Library.selectActiveDialogRoute().&#x27;);
    }
    if (newStack) {
        session.dialogStack(newStack);
    }
    session.routeToActiveDialog(route.routeData);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.selectGlobalActionRoute" id="apidoc.element.botbuilder.Library.prototype.selectGlobalActionRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectGlobalActionRoute
        <span class="apidocSignatureSpan">(session, route)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">selectGlobalActionRoute = function (session, route) {
    if (!route || route.libraryName !== this.name || route.routeType !== Library.RouteTypes.GlobalAction) {
        throw new Error(&#x27;Invalid route type passed to Library.selectGlobalActionRoute().&#x27;);
    }
    this.actions.selectActionRoute(session, route);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.selectRoute" id="apidoc.element.botbuilder.Library.prototype.selectRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectRoute
        <span class="apidocSignatureSpan">(session, route)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">selectRoute = function (session, route) {
    if (this._onSelectRoute) {
        this._onSelectRoute(session, route);
    }
    else {
        this.defaultSelectRoute(session, route);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Library.prototype.selectStackActionRoute" id="apidoc.element.botbuilder.Library.prototype.selectStackActionRoute">
        function <span class="apidocSignatureSpan">botbuilder.Library.prototype.</span>selectStackActionRoute
        <span class="apidocSignatureSpan">(session, route, newStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">selectStackActionRoute = function (session, route, newStack) {
    if (!route || route.libraryName !== this.name || route.routeType !== Library.RouteTypes.StackAction) {
        throw new Error(&#x27;Invalid route type passed to Library.selectStackActionRoute().&#x27;);
    }
    if (newStack) {
        session.dialogStack(newStack);
    }
    var routeData = route.routeData;
    var parts = routeData.dialogId.split(&#x27;:&#x27;);
    this.dialog(parts[1]).selectActionRoute(session, route);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.LuisDialog" id="apidoc.module.botbuilder.LuisDialog">module botbuilder.LuisDialog</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.LuisDialog" id="apidoc.element.botbuilder.LuisDialog.LuisDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>LuisDialog
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function LuisDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;LuisDialog class is deprecated. Use IntentDialog with a LuisRecognizer instead.&#x27;);
    var recognizer = new LuisRecognizer_1.LuisRecognizer(serviceUri);
    _this.dialog = new IntentDialog_1.IntentDialog({ recognizers: [recognizer] });
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.LuisDialog.prototype" id="apidoc.module.botbuilder.LuisDialog.prototype">module botbuilder.LuisDialog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.begin" id="apidoc.element.botbuilder.LuisDialog.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    this.dialog.begin(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.constructor" id="apidoc.element.botbuilder.LuisDialog.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>constructor
        <span class="apidocSignatureSpan">(serviceUri)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function LuisDialog(serviceUri) {
    var _this = _super.call(this) || this;
    console.warn(&#x27;LuisDialog class is deprecated. Use IntentDialog with a LuisRecognizer instead.&#x27;);
    var recognizer = new LuisRecognizer_1.LuisRecognizer(serviceUri);
    _this.dialog = new IntentDialog_1.IntentDialog({ recognizers: [recognizer] });
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.dialogResumed" id="apidoc.element.botbuilder.LuisDialog.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    this.dialog.dialogResumed(session, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.on" id="apidoc.element.botbuilder.LuisDialog.prototype.on">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>on
        <span class="apidocSignatureSpan">(intent, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function (intent, dialogId, dialogArgs) {
    this.dialog.matches(intent, dialogId, dialogArgs);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.onBegin" id="apidoc.element.botbuilder.LuisDialog.prototype.onBegin">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>onBegin
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onBegin = function (handler) {
    this.dialog.onBegin(handler);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.onDefault" id="apidoc.element.botbuilder.LuisDialog.prototype.onDefault">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>onDefault
        <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onDefault = function (dialogId, dialogArgs) {
    this.dialog.onDefault(dialogId, dialogArgs);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.recognize" id="apidoc.element.botbuilder.LuisDialog.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    this.dialog.recognize(context, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisDialog.prototype.replyReceived" id="apidoc.element.botbuilder.LuisDialog.prototype.replyReceived">
        function <span class="apidocSignatureSpan">botbuilder.LuisDialog.prototype.</span>replyReceived
        <span class="apidocSignatureSpan">(session, recognizeResult)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replyReceived = function (session, recognizeResult) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.<span class="apidocCodeKeywordSpan">replyReceived</span>(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.LuisRecognizer" id="apidoc.module.botbuilder.LuisRecognizer">module botbuilder.LuisRecognizer</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.LuisRecognizer.LuisRecognizer" id="apidoc.element.botbuilder.LuisRecognizer.LuisRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>LuisRecognizer
        <span class="apidocSignatureSpan">(models)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function LuisRecognizer(models) {
    if (typeof models == &#x27;string&#x27;) {
        this.models = { &#x27;*&#x27;: models };
    }
    else {
        this.models = (models || {});
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.LuisRecognizer.recognize" id="apidoc.element.botbuilder.LuisRecognizer.recognize">
        function <span class="apidocSignatureSpan">botbuilder.LuisRecognizer.</span>recognize
        <span class="apidocSignatureSpan">(utterance, modelUrl, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (utterance, modelUrl, callback) {
    try {
        var uri = modelUrl.trim();
        if (uri.lastIndexOf(&#x27;&#x26;q=&#x27;) != uri.length - 3) {
            uri += &#x27;&#x26;q=&#x27;;
        }
        uri += encodeURIComponent(utterance || &#x27;&#x27;);
        request.get(uri, function (err, res, body) {
            var result;
            try {
                if (!err) {
                    result = JSON.parse(body);
                    result.intents = result.intents || [];
                    result.entities = result.entities || [];
                    if (result.topScoringIntent &#x26;&#x26; result.intents.length == 0) {
                        result.intents.push(result.topScoringIntent);
                    }
                    if (result.intents.length == 1 &#x26;&#x26; typeof result.intents[0].score !== &#x27;number&#x27;) {
                        result.intents[0].score = 1.0;
                    }
                }
            }
            catch (e) {
                err = e;
            }
            try {
                if (!err) {
                    callback(null, result.intents, result.entities);
                }
                else {
                    var m = err.toString();
                    callback(err instanceof Error ? err : new Error(m));
                }
            }
            catch (e) {
                console.error(e.toString());
            }
        });
    }
    catch (err) {
        callback(err instanceof Error ? err : new Error(err.toString()));
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.LuisRecognizer.prototype" id="apidoc.module.botbuilder.LuisRecognizer.prototype">module botbuilder.LuisRecognizer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.LuisRecognizer.prototype.recognize" id="apidoc.element.botbuilder.LuisRecognizer.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.LuisRecognizer.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    var result = { score: 0.0, intent: null };
    if (context &#x26;&#x26; context.message &#x26;&#x26; context.message.text) {
        var utterance = context.message.text;
        var locale = context.locale || &#x27;*&#x27;;
        var model = this.models.hasOwnProperty(locale) ? this.models[locale] : this.models[&#x27;*&#x27;];
        if (model) {
            LuisRecognizer.recognize(utterance, model, function (err, intents, entities) {
                if (!err) {
                    result.intents = intents;
                    result.entities = entities;
                    var top;
                    intents.forEach(function (intent) {
                        if (top) {
                            if (intent.score &#x3e; top.score) {
                                top = intent;
                            }
                        }
                        else {
                            top = intent;
                        }
                    });
                    if (top) {
                        result.score = top.score;
                        result.intent = top.intent;
                        switch (top.intent.toLowerCase()) {
                            case &#x27;builtin.intent.none&#x27;:
                            case &#x27;none&#x27;:
                                result.score = 0.1;
                                break;
                        }
                    }
                    cb(null, result);
                }
                else {
                    cb(err, null);
                }
            });
        }
        else {
            cb(new Error(&#x22;LUIS model not found for locale &#x27;&#x22; + locale + &#x22;&#x27;.&#x22;), null);
        }
    }
    else {
        cb(null, result);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.MediaCard" id="apidoc.module.botbuilder.MediaCard">module botbuilder.MediaCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.MediaCard" id="apidoc.element.botbuilder.MediaCard.MediaCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>MediaCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MediaCard(session) {
    return _super.call(this, session) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.MediaCard.prototype" id="apidoc.module.botbuilder.MediaCard.prototype">module botbuilder.MediaCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.autoloop" id="apidoc.element.botbuilder.MediaCard.prototype.autoloop">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>autoloop
        <span class="apidocSignatureSpan">(choice)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autoloop = function (choice) {
    this.data.content.autoloop = choice;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.autostart" id="apidoc.element.botbuilder.MediaCard.prototype.autostart">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>autostart
        <span class="apidocSignatureSpan">(choice)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autostart = function (choice) {
    this.data.content.autostart = choice;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.constructor" id="apidoc.element.botbuilder.MediaCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MediaCard(session) {
    return _super.call(this, session) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.image" id="apidoc.element.botbuilder.MediaCard.prototype.image">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>image
        <span class="apidocSignatureSpan">(image)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">image = function (image) {
    if (image) {
        this.data.content.image = image.toImage ? image.toImage() : image;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        var list = [];
        for (var i = 0; i &#x3c; v2.actions.length; i++) {
            var old = v2.actions[i];
            var btn = old.message ?
                CardAction_1.CardAction.imBack(null, old.message, old.title) :
                CardAction_1.CardAction.openUrl(null, old.url, old.title);
            if (old.image) {
                btn.<span class="apidocCodeKeywordSpan">image</span>(old.image);
            }
            list.push(btn);
        }
        card.buttons(list);
    }
    return card.toAttachment();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.media" id="apidoc.element.botbuilder.MediaCard.prototype.media">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>media
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">media = function (list) {
    this.data.content.media = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var media = list[i];
            this.data.content.media.push(media.toMedia ? media.toMedia() : media);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.shareable" id="apidoc.element.botbuilder.MediaCard.prototype.shareable">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>shareable
        <span class="apidocSignatureSpan">(choice)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">shareable = function (choice) {
    this.data.content.shareable = choice;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.subtitle" id="apidoc.element.botbuilder.MediaCard.prototype.subtitle">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>subtitle
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subtitle = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.subtitle = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.text" id="apidoc.element.botbuilder.MediaCard.prototype.text">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>text
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.text = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MediaCard.prototype.title" id="apidoc.element.botbuilder.MediaCard.prototype.title">
        function <span class="apidocSignatureSpan">botbuilder.MediaCard.prototype.</span>title
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">title = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.title = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.<span class="apidocCodeKeywordSpan">title</span>(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
        card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
    }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.MemoryBotStorage" id="apidoc.module.botbuilder.MemoryBotStorage">module botbuilder.MemoryBotStorage</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.MemoryBotStorage.MemoryBotStorage" id="apidoc.element.botbuilder.MemoryBotStorage.MemoryBotStorage">
        function <span class="apidocSignatureSpan">botbuilder.</span>MemoryBotStorage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MemoryBotStorage() {
    this.userStore = {};
    this.conversationStore = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.MemoryBotStorage.prototype" id="apidoc.module.botbuilder.MemoryBotStorage.prototype">module botbuilder.MemoryBotStorage.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.deleteData" id="apidoc.element.botbuilder.MemoryBotStorage.prototype.deleteData">
        function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>deleteData
        <span class="apidocSignatureSpan">(context)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteData = function (context) {
    if (context.userId &#x26;&#x26; this.userStore.hasOwnProperty(context.userId)) {
        if (context.conversationId) {
            if (this.conversationStore.hasOwnProperty(context.conversationId)) {
                delete this.conversationStore[context.conversationId];
            }
        }
        else {
            delete this.userStore[context.userId];
            for (var key in this.conversationStore) {
                if (key.indexOf(context.userId + &#x27;:&#x27;) == 0) {
                    delete this.conversationStore[key];
                }
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.getData" id="apidoc.element.botbuilder.MemoryBotStorage.prototype.getData">
        function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>getData
        <span class="apidocSignatureSpan">(context, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (context, callback) {
    var data = {};
    if (context.userId) {
        if (context.persistUserData) {
            if (this.userStore.hasOwnProperty(context.userId)) {
                data.userData = JSON.parse(this.userStore[context.userId]);
            }
            else {
                data.userData = null;
            }
        }
        if (context.conversationId) {
            var key = context.userId + &#x27;:&#x27; + context.conversationId;
            if (this.conversationStore.hasOwnProperty(key)) {
                data.privateConversationData = JSON.parse(this.conversationStore[key]);
            }
            else {
                data.privateConversationData = null;
            }
        }
    }
    if (context.persistConversationData &#x26;&#x26; context.conversationId) {
        if (this.conversationStore.hasOwnProperty(context.conversationId)) {
            data.conversationData = JSON.parse(this.conversationStore[context.conversationId]);
        }
        else {
            data.conversationData = null;
        }
    }
    callback(null, data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.MemoryBotStorage.prototype.saveData" id="apidoc.element.botbuilder.MemoryBotStorage.prototype.saveData">
        function <span class="apidocSignatureSpan">botbuilder.MemoryBotStorage.prototype.</span>saveData
        <span class="apidocSignatureSpan">(context, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saveData = function (context, data, callback) {
    if (context.userId) {
        if (context.persistUserData) {
            this.userStore[context.userId] = JSON.stringify(data.userData || {});
        }
        if (context.conversationId) {
            var key = context.userId + &#x27;:&#x27; + context.conversationId;
            this.conversationStore[key] = JSON.stringify(data.privateConversationData || {});
        }
    }
    if (context.persistConversationData &#x26;&#x26; context.conversationId) {
        this.conversationStore[context.conversationId] = JSON.stringify(data.conversationData || {});
    }
    callback(null);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Message" id="apidoc.module.botbuilder.Message">module botbuilder.Message</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Message.Message" id="apidoc.element.botbuilder.Message.Message">
        function <span class="apidocSignatureSpan">botbuilder.</span>Message
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Message(session) {
    this.session = session;
    this.data = {};
    this.data.type = consts.messageType;
    this.data.agent = consts.agent;
    if (this.session) {
        var m = this.session.message;
        if (m.source) {
            this.data.source = m.source;
        }
        if (m.textLocale) {
            this.data.textLocale = m.textLocale;
        }
        if (m.address) {
            this.data.address = m.address;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
        this.batchTimer = setTimeout(function () {
            _this.sendBatch();
        }, this.options.autoBatchDelay);
    }
};
Session.prototype.createMessage = function (localizationNamespace, text, args) {
    var message = new Message_1.<span class="apidocCodeKeywordSpan">Message</span>(this)
        .text(this.vgettext(localizationNamespace, Message_1.Message.randomPrompt(text), args));
    return message.toMessage();
};
Session.prototype.prepareMessage = function (msg) {
    if (!msg.type) {
        msg.type = &#x27;message&#x27;;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.composePrompt" id="apidoc.element.botbuilder.Message.composePrompt">
        function <span class="apidocSignatureSpan">botbuilder.Message.</span>composePrompt
        <span class="apidocSignatureSpan">(session, prompts, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">composePrompt = function (session, prompts, args) {
    var connector = &#x27;&#x27;;
    var prompt = &#x27;&#x27;;
    for (var i = 0; i &#x3c; prompts.length; i++) {
        var txt = Message.randomPrompt(prompts[i]);
        prompt += connector + (session ? session.gettext(txt) : txt);
        connector = &#x27; &#x27;;
    }
    return args &#x26;&#x26; args.length &#x3e; 0 ? sprintf.vsprintf(prompt, args) : prompt;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Message.prototype.compose = function (prompts) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (prompts) {
        this.data.text = Message.<span class="apidocCodeKeywordSpan">composePrompt</span>(this.session, prompts, args);
    }
    return this;
};
Message.prototype.summary = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.randomPrompt" id="apidoc.element.botbuilder.Message.randomPrompt">
        function <span class="apidocSignatureSpan">botbuilder.Message.</span>randomPrompt
        <span class="apidocSignatureSpan">(prompts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">randomPrompt = function (prompts) {
    if (Array.isArray(prompts)) {
        var i = Math.floor(Math.random() * prompts.length);
        return prompts[i];
    }
    else {
        return prompts;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    this.data.text = text ? fmtText(this.session, text, args) : &#x27;&#x27;;
    return this;
};
Message.prototype.ntext = function (msg, msg_plural, count) {
    var fmt = count == 1 ? Message.<span class="apidocCodeKeywordSpan">randomPrompt</span>(msg) : Message.randomPrompt(msg_plural
);
    if (this.session) {
        fmt = this.session.gettext(fmt);
    }
    this.data.text = sprintf.sprintf(fmt, count);
    return this;
};
Message.prototype.compose = function (prompts) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Message.prototype" id="apidoc.module.botbuilder.Message.prototype">module botbuilder.Message.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.addAttachment" id="apidoc.element.botbuilder.Message.prototype.addAttachment">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>addAttachment
        <span class="apidocSignatureSpan">(attachment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.toAttachment() : attachment;
        a = this.upgradeAttachment(a);
        if (!this.data.attachments) {
            this.data.attachments = [a];
        }
        else {
            this.data.attachments.push(a);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.data.attachmentLayout = style;
    return this;
};
Message.prototype.attachments = function (list) {
    this.data.attachments = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            this.<span class="apidocCodeKeywordSpan">addAttachment</span>(list[i]);
        }
    }
    return this;
};
Message.prototype.addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.toAttachment() : attachment;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.addEntity" id="apidoc.element.botbuilder.Message.prototype.addEntity">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>addEntity
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addEntity = function (obj) {
    if (obj) {
        if (!this.data.entities) {
            this.data.entities = [obj];
        }
        else {
            this.data.entities.push(obj);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.address" id="apidoc.element.botbuilder.Message.prototype.address">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>address
        <span class="apidocSignatureSpan">(adr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">address = function (adr) {
    if (adr) {
        this.data.address = adr;
        this.data.source = adr.channelId;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.attachmentLayout" id="apidoc.element.botbuilder.Message.prototype.attachmentLayout">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>attachmentLayout
        <span class="apidocSignatureSpan">(style)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attachmentLayout = function (style) {
    this.data.attachmentLayout = style;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.attachments" id="apidoc.element.botbuilder.Message.prototype.attachments">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>attachments
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attachments = function (list) {
    this.data.attachments = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            this.addAttachment(list[i]);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.compose" id="apidoc.element.botbuilder.Message.prototype.compose">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>compose
        <span class="apidocSignatureSpan">(prompts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">compose = function (prompts) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (prompts) {
        this.data.text = Message.composePrompt(this.session, prompts, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this.ntext(msg, msg_plural, count);
};
Message.prototype.composePrompt = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    console.warn(&#x22;Message.composePrompt() is deprecated. Use Message.<span class="apidocCodeKeywordSpan">compose</span>() instead
.&#x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.compose.apply(this, args);
};
Message.prototype.setChannelData = function (data) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.composePrompt" id="apidoc.element.botbuilder.Message.prototype.composePrompt">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>composePrompt
        <span class="apidocSignatureSpan">(session, prompts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">composePrompt = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    console.warn(&#x22;Message.composePrompt() is deprecated. Use Message.compose() instead.&#x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.compose.apply(this, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Message.prototype.compose = function (prompts) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (prompts) {
        this.data.text = Message.<span class="apidocCodeKeywordSpan">composePrompt</span>(this.session, prompts, args);
    }
    return this;
};
Message.prototype.summary = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.entities" id="apidoc.element.botbuilder.Message.prototype.entities">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>entities
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">entities = function (list) {
    this.data.entities = list || [];
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.ntext" id="apidoc.element.botbuilder.Message.prototype.ntext">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>ntext
        <span class="apidocSignatureSpan">(msg, msg_plural, count)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ntext = function (msg, msg_plural, count) {
    var fmt = count == 1 ? Message.randomPrompt(msg) : Message.randomPrompt(msg_plural);
    if (this.session) {
        fmt = this.session.gettext(fmt);
    }
    this.data.text = sprintf.sprintf(fmt, count);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.text.apply(this, args);
};
Message.prototype.setNText = function (session, msg, msg_plural, count) {
    console.warn(&#x22;Message.setNText() is deprecated. Use Message.<span class="apidocCodeKeywordSpan">ntext</span>() instead.&#
x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    return this.ntext(msg, msg_plural, count);
};
Message.prototype.composePrompt = function (session, prompts) {
    var args = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.setChannelData" id="apidoc.element.botbuilder.Message.prototype.setChannelData">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setChannelData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setChannelData = function (data) {
    console.warn(&#x22;Message.setChannelData() is deprecated. Use Message.sourceEvent() instead.&#x22;);
    return this.sourceEvent({ &#x27;*&#x27;: data });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.compose.apply(this, args);
};
Message.prototype.setChannelData = function (data) {
    console.warn(&#x22;Message.<span class="apidocCodeKeywordSpan">setChannelData</span>() is deprecated. Use Message.sourceEvent
() instead.&#x22;);
    return this.sourceEvent({ &#x27;*&#x27;: data });
};
return Message;
}());
exports.Message = Message;
function fmtText(session, prompts, args) {
var fmt = Message.randomPrompt(prompts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.setLanguage" id="apidoc.element.botbuilder.Message.prototype.setLanguage">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setLanguage
        <span class="apidocSignatureSpan">(local)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setLanguage = function (local) {
    console.warn(&#x22;Message.setLanguage() is deprecated. Use Message.textLocal() instead.&#x22;);
    return this.textLocale(local);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        var txt = Message.randomPrompt(prompts[i]);
        prompt += connector + (session ? session.gettext(txt) : txt);
        connector = &#x27; &#x27;;
    }
    return args &#x26;&#x26; args.length &#x3e; 0 ? sprintf.vsprintf(prompt, args) : prompt;
};
Message.prototype.setLanguage = function (local) {
    console.warn(&#x22;Message.<span class="apidocCodeKeywordSpan">setLanguage</span>() is deprecated. Use Message.textLocal() instead
.&#x22;);
    return this.textLocale(local);
};
Message.prototype.setText = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.setNText" id="apidoc.element.botbuilder.Message.prototype.setNText">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setNText
        <span class="apidocSignatureSpan">(session, msg, msg_plural, count)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setNText = function (session, msg, msg_plural, count) {
    console.warn(&#x22;Message.setNText() is deprecated. Use Message.ntext() instead.&#x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    return this.ntext(msg, msg_plural, count);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.text.apply(this, args);
};
Message.prototype.setNText = function (session, msg, msg_plural, count) {
    console.warn(&#x22;Message.<span class="apidocCodeKeywordSpan">setNText</span>() is deprecated. Use Message.ntext() instead.&#
x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    return this.ntext(msg, msg_plural, count);
};
Message.prototype.composePrompt = function (session, prompts) {
    var args = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.setText" id="apidoc.element.botbuilder.Message.prototype.setText">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>setText
        <span class="apidocSignatureSpan">(session, prompts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setText = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    console.warn(&#x22;Message.setText() is deprecated. Use Message.text() instead.&#x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.text.apply(this, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this.textLocale(local);
};
Message.prototype.setText = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    console.warn(&#x22;Message.<span class="apidocCodeKeywordSpan">setText</span>() is deprecated. Use Message.text() instead.&#
x22;);
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.text.apply(this, args);
};
Message.prototype.setNText = function (session, msg, msg_plural, count) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.sourceEvent" id="apidoc.element.botbuilder.Message.prototype.sourceEvent">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>sourceEvent
        <span class="apidocSignatureSpan">(map)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sourceEvent = function (map) {
    if (map) {
        var channelId = this.data.address ? this.data.address.channelId : &#x27;*&#x27;;
        if (map.hasOwnProperty(channelId)) {
            this.data.sourceEvent = map[channelId];
        }
        else if (map.hasOwnProperty(&#x27;*&#x27;)) {
            this.data.sourceEvent = map[&#x27;*&#x27;];
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (session &#x26;&#x26; !this.session) {
        this.session = session;
    }
    args.unshift(prompts);
    return Message.prototype.compose.apply(this, args);
};
Message.prototype.setChannelData = function (data) {
    console.warn(&#x22;Message.setChannelData() is deprecated. Use Message.<span class="apidocCodeKeywordSpan">sourceEvent</span
>() instead.&#x22;);
    return this.sourceEvent({ &#x27;*&#x27;: data });
};
return Message;
}());
exports.Message = Message;
function fmtText(session, prompts, args) {
var fmt = Message.randomPrompt(prompts);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.summary" id="apidoc.element.botbuilder.Message.prototype.summary">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>summary
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">summary = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    this.data.summary = text ? fmtText(this.session, text, args) : &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.text" id="apidoc.element.botbuilder.Message.prototype.text">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>text
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    this.data.text = text ? fmtText(this.session, text, args) : &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.textFormat" id="apidoc.element.botbuilder.Message.prototype.textFormat">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>textFormat
        <span class="apidocSignatureSpan">(style)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">textFormat = function (style) {
    this.data.textFormat = style;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.textLocale" id="apidoc.element.botbuilder.Message.prototype.textLocale">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>textLocale
        <span class="apidocSignatureSpan">(locale)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">textLocale = function (locale) {
    this.data.textLocale = locale;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        prompt += connector + (session ? session.gettext(txt) : txt);
        connector = &#x27; &#x27;;
    }
    return args &#x26;&#x26; args.length &#x3e; 0 ? sprintf.vsprintf(prompt, args) : prompt;
};
Message.prototype.setLanguage = function (local) {
    console.warn(&#x22;Message.setLanguage() is deprecated. Use Message.textLocal() instead.&#x22;);
    return this.<span class="apidocCodeKeywordSpan">textLocale</span>(local);
};
Message.prototype.setText = function (session, prompts) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    console.warn(&#x22;Message.setText() is deprecated. Use Message.text() instead.&#x22;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.timestamp" id="apidoc.element.botbuilder.Message.prototype.timestamp">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>timestamp
        <span class="apidocSignatureSpan">(time)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timestamp = function (time) {
    this.data.timestamp = time || new Date().toISOString();
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.toMessage" id="apidoc.element.botbuilder.Message.prototype.toMessage">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>toMessage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toMessage = function () {
    return utils.clone(this.data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.msgSent = true;
if (message) {
    var m;
    if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
        m = this.createMessage(localizationNamespace, message, args);
    }
    else if (message.toMessage) {
        m = message.<span class="apidocCodeKeywordSpan">toMessage</span>();
    }
    else {
        m = message;
    }
    this.prepareMessage(m);
    this.batch.push(m);
    logger.info(this, &#x27;session.send()&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Message.prototype.upgradeAttachment" id="apidoc.element.botbuilder.Message.prototype.upgradeAttachment">
        function <span class="apidocSignatureSpan">botbuilder.Message.prototype.</span>upgradeAttachment
        <span class="apidocSignatureSpan">(a)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upgradeAttachment = function (a) {
    var isOldSchema = false;
    for (var prop in a) {
        switch (prop) {
            case &#x27;actions&#x27;:
            case &#x27;fallbackText&#x27;:
            case &#x27;title&#x27;:
            case &#x27;titleLink&#x27;:
            case &#x27;text&#x27;:
            case &#x27;thumbnailUrl&#x27;:
                isOldSchema = true;
                break;
        }
    }
    if (isOldSchema) {
        console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
        var v2 = a;
        var card = new HeroCard_1.HeroCard();
        if (v2.title) {
            card.title(v2.title);
        }
        if (v2.text) {
            card.text(v2.text);
        }
        if (v2.thumbnailUrl) {
            card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
        }
        if (v2.titleLink) {
            card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
        }
        if (v2.actions) {
            var list = [];
            for (var i = 0; i &#x3c; v2.actions.length; i++) {
                var old = v2.actions[i];
                var btn = old.message ?
                    CardAction_1.CardAction.imBack(null, old.message, old.title) :
                    CardAction_1.CardAction.openUrl(null, old.url, old.title);
                if (old.image) {
                    btn.image(old.image);
                }
                list.push(btn);
            }
            card.buttons(list);
        }
        return card.toAttachment();
    }
    else {
        return a;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
    }
    return this;
};
Message.prototype.addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.toAttachment() : attachment;
        a = this.<span class="apidocCodeKeywordSpan">upgradeAttachment</span>(a);
        if (!this.data.attachments) {
            this.data.attachments = [a];
        }
        else {
            this.data.attachments.push(a);
        }
    }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Middleware" id="apidoc.module.botbuilder.Middleware">module botbuilder.Middleware</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Middleware.Middleware" id="apidoc.element.botbuilder.Middleware.Middleware">
        function <span class="apidocSignatureSpan">botbuilder.</span>Middleware
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Middleware() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Middleware.dialogVersion" id="apidoc.element.botbuilder.Middleware.dialogVersion">
        function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>dialogVersion
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogVersion = function (options) {
    return {
        botbuilder: function (session, next) {
            var cur = session.sessionState.version || 0.0;
            var curMajor = Math.floor(cur);
            var major = Math.floor(options.version);
            if (session.sessionState.callstack.length &#x26;&#x26; curMajor !== major) {
                session.endConversation(options.message || &#x22;Sorry. The service was upgraded and we need to start over.&#x22;);
            }
            else if (options.resetCommand &#x26;&#x26; session.message.text &#x26;&#x26; options.resetCommand.test(session.message.text)) {
                session.endConversation(options.message || &#x22;Sorry. The service was upgraded and we need to start over.&#x22;);
            }
            else {
                session.sessionState.version = options.version;
                next();
            }
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Middleware.firstRun" id="apidoc.element.botbuilder.Middleware.firstRun">
        function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>firstRun
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">firstRun = function (options) {
    return {
        botbuilder: function (session, next) {
            if (session.sessionState.callstack.length == 0) {
                var cur = session.userData[consts.Data.FirstRunVersion] || 0.0;
                var curMajor = Math.floor(cur);
                var major = Math.floor(options.version);
                if (major &#x3e; curMajor) {
                    session.beginDialog(consts.DialogId.FirstRun, {
                        version: options.version,
                        dialogId: options.dialogId,
                        dialogArgs: options.dialogArgs
                    });
                }
                else if (options.version &#x3e; cur &#x26;&#x26; options.upgradeDialogId) {
                    session.beginDialog(consts.DialogId.FirstRun, {
                        version: options.version,
                        dialogId: options.upgradeDialogId,
                        dialogArgs: options.upgradeDialogArgs
                    });
                }
                else {
                    next();
                }
            }
            else {
                next();
            }
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Middleware.sendTyping" id="apidoc.element.botbuilder.Middleware.sendTyping">
        function <span class="apidocSignatureSpan">botbuilder.Middleware.</span>sendTyping
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendTyping = function () {
    return {
        botbuilder: function (session, next) {
            session.sendTyping();
            next();
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this;
};
Session.prototype.sendTyping = function () {
    this.msgSent = true;
    var m = { type: &#x27;typing&#x27; };
    this.prepareMessage(m);
    this.batch.push(m);
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">sendTyping</span>()&#x27;);
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Prompts" id="apidoc.module.botbuilder.Prompts">module botbuilder.Prompts</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.Prompts" id="apidoc.element.botbuilder.Prompts.Prompts">
        function <span class="apidocSignatureSpan">botbuilder.</span>Prompts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Prompts() {
    return _super !== null &#x26;&#x26; _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.attachment" id="apidoc.element.botbuilder.Prompts.attachment">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>attachment
        <span class="apidocSignatureSpan">(session, prompt, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attachment = function (session, prompt, options) {
    Prompts.validateSession(session);
    var args = options || {};
    args.promptType = PromptType.attachment;
    args.prompt = prompt;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.choice" id="apidoc.element.botbuilder.Prompts.choice">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>choice
        <span class="apidocSignatureSpan">(session, prompt, choices, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">choice = function (session, prompt, choices, options) {
    Prompts.validateSession(session);
    var args = options || {};
    args.promptType = PromptType.choice;
    args.prompt = prompt;
    args.listStyle = args.hasOwnProperty(&#x27;listStyle&#x27;) ? args.listStyle : ListStyle.auto;
    var c = EntityRecognizer_1.EntityRecognizer.expandChoices(choices);
    if (c.length == 0) {
        console.error(&#x22;0 length choice for prompt:&#x22;, prompt);
        throw &#x22;0 length choice list supplied&#x22;;
    }
    args.enumValues = c;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.configure" id="apidoc.element.botbuilder.Prompts.configure">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>configure
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configure = function (options) {
    if (options) {
        for (var key in options) {
            if (options.hasOwnProperty(key)) {
                Prompts.options[key] = options[key];
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.confirm" id="apidoc.element.botbuilder.Prompts.confirm">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>confirm
        <span class="apidocSignatureSpan">(session, prompt, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">confirm = function (session, prompt, options) {
    Prompts.validateSession(session);
    var locale = session.preferredLocale();
    var args = options || {};
    args.promptType = PromptType.confirm;
    args.prompt = prompt;
    args.enumValues = [
        session.localizer.gettext(locale, &#x27;confirm_yes&#x27;, consts.Library.system),
        session.localizer.gettext(locale, &#x27;confirm_no&#x27;, consts.Library.system)
    ];
    args.listStyle = args.hasOwnProperty(&#x27;listStyle&#x27;) ? args.listStyle : ListStyle.auto;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.disambiguate" id="apidoc.element.botbuilder.Prompts.disambiguate">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>disambiguate
        <span class="apidocSignatureSpan">(session, prompt, choices, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disambiguate = function (session, prompt, choices, options) {
    Prompts.validateSession(session);
    session.beginDialog(consts.DialogId.Disambiguate, {
        prompt: prompt,
        choices: choices,
        options: options
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.number" id="apidoc.element.botbuilder.Prompts.number">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>number
        <span class="apidocSignatureSpan">(session, prompt, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">number = function (session, prompt, options) {
    Prompts.validateSession(session);
    var args = options || {};
    args.promptType = PromptType.number;
    args.prompt = prompt;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.text" id="apidoc.element.botbuilder.Prompts.text">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>text
        <span class="apidocSignatureSpan">(session, prompt, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (session, prompt, options) {
    Prompts.validateSession(session);
    var args = options || {};
    args.promptType = PromptType.text;
    args.prompt = prompt;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.time" id="apidoc.element.botbuilder.Prompts.time">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>time
        <span class="apidocSignatureSpan">(session, prompt, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function (session, prompt, options) {
    Prompts.validateSession(session);
    var args = options || {};
    args.promptType = PromptType.time;
    args.prompt = prompt;
    beginPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.validateSession" id="apidoc.element.botbuilder.Prompts.validateSession">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.</span>validateSession
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateSession = function (session) {
    if (!session || typeof session != &#x27;object&#x27;) {
        throw &#x27;Session should be provided as first parameter.&#x27;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Prompts.prototype" id="apidoc.module.botbuilder.Prompts.prototype">module botbuilder.Prompts.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.begin" id="apidoc.element.botbuilder.Prompts.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    args = args || {};
    args.promptAfterAction = args.hasOwnProperty(&#x27;promptAfterAction&#x27;) ? args.promptAfterAction : Prompts.options.promptAfterAction
;
    args.retryCnt = 0;
    for (var key in args) {
        if (args.hasOwnProperty(key)) {
            session.dialogData[key] = args[key];
        }
    }
    this.sendPrompt(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.constructor" id="apidoc.element.botbuilder.Prompts.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>constructor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Prompts() {
    return _super !== null &#x26;&#x26; _super.apply(this, arguments) || this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.createPrompt" id="apidoc.element.botbuilder.Prompts.prototype.createPrompt">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>createPrompt
        <span class="apidocSignatureSpan">(session, args, retry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createPrompt = function (session, args, retry) {
    var msg = new Message_1.Message(session);
    var locale = session.preferredLocale();
    var localizationNamespace = args.localizationNamespace;
    var style = ListStyle.none;
    if (args.promptType == PromptType.choice || args.promptType == PromptType.confirm) {
        style = args.listStyle;
        if (style == ListStyle.auto) {
            if (Channel.supportsKeyboards(session, args.enumValues.length)) {
                style = ListStyle.button;
            }
            else if (!retry &#x26;&#x26; args.promptType == PromptType.choice) {
                style = args.enumValues.length &#x3c; 3 ? ListStyle.inline : ListStyle.list;
            }
            else {
                style = ListStyle.none;
            }
        }
    }
    var prompt;
    if (retry) {
        if (args.retryPrompt) {
            prompt = Message_1.Message.randomPrompt(args.retryPrompt);
        }
        else {
            var type = PromptType[args.promptType];
            prompt = Prompts.defaultRetryPrompt[type];
            localizationNamespace = consts.Library.system;
        }
    }
    else {
        prompt = Message_1.Message.randomPrompt(args.prompt);
    }
    var text = session.localizer.gettext(locale, prompt, localizationNamespace);
    var connector = &#x27;&#x27;;
    var list;
    switch (style) {
        case ListStyle.button:
            var buttons = [];
            for (var i = 0; i &#x3c; session.dialogData.enumValues.length; i++) {
                var option = session.dialogData.enumValues[i];
                buttons.push(CardAction_1.CardAction.imBack(session, option, option));
            }
            msg.text(text)
                .attachments([new Keyboard_1.Keyboard(session).buttons(buttons)]);
            break;
        case ListStyle.inline:
            list = &#x27; (&#x27;;
            args.enumValues.forEach(function (v, index) {
                var value = v.toString();
                list += connector + (index + 1) + &#x27;. &#x27; + session.localizer.gettext(locale, value, consts.Library.system);
                if (index == args.enumValues.length - 2) {
                    connector = index == 0 ? session.localizer.gettext(locale, &#x22;list_or&#x22;, consts.Library.system) : session.localizer
.gettext(locale, &#x22;list_or_more&#x22;, consts.Library.system);
                }
                else {
                    connector = &#x27;, &#x27;;
                }
            });
            list += &#x27;)&#x27;;
            msg.text(text + &#x27;%s&#x27;, list);
            break;
        case ListStyle.list:
            list = &#x27;\n   &#x27;;
            args.enumValues.forEach(function (v, index) {
                var value = v.toString();
                list += connector + (index + 1) + &#x27;. &#x27; + session.localizer.gettext(locale, value, args.localizationNamespace);
                connector = &#x27;\n   &#x27;;
            });
            msg.text(text + &#x27;%s&#x27;, list);
            break;
        default:
            msg.text(text);
            break;
    }
    return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.dialogResumed" id="apidoc.element.botbuilder.Prompts.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    var args = session.dialogData;
    if (args.promptAfterAction) {
        this.sendPrompt(session, args);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.recognize" id="apidoc.element.botbuilder.Prompts.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    var args = context.dialogData;
    Prompts.options.recognizer.recognize({
        promptType: args.promptType,
        utterance: context.message.text,
        locale: context.message.textLocale,
        attachments: context.message.attachments,
        enumValues: args.enumValues,
        refDate: args.refDate
    }, function (result) {
        if (result.error) {
            cb(result.error, null);
        }
        else {
            cb(null, result);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.replyReceived" id="apidoc.element.botbuilder.Prompts.prototype.replyReceived">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>replyReceived
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replyReceived = function (session, result) {
    var args = session.dialogData;
    if (result.error || result.resumed == Dialog_1.ResumeReason.completed) {
        result.promptType = args.promptType;
        session.endDialogWithResult(result);
    }
    else if (typeof args.maxRetries === &#x27;number&#x27; &#x26;&#x26; args.retryCnt &#x3e;= args.maxRetries) {
        result.promptType = args.promptType;
        result.resumed = Dialog_1.ResumeReason.notCompleted;
        session.endDialogWithResult(result);
    }
    else {
        args.retryCnt++;
        this.sendPrompt(session, args, true);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.<span class="apidocCodeKeywordSpan">replyReceived</span>(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Prompts.prototype.sendPrompt" id="apidoc.element.botbuilder.Prompts.prototype.sendPrompt">
        function <span class="apidocSignatureSpan">botbuilder.Prompts.prototype.</span>sendPrompt
        <span class="apidocSignatureSpan">(session, args, retry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendPrompt = function (session, args, retry) {
    if (retry === void 0) { retry = false; }
    logger.debug(&#x22;prompts::sendPrompt called&#x22;);
    var msg;
    if (retry &#x26;&#x26; typeof args.retryPrompt === &#x27;object&#x27; &#x26;&#x26; !Array.isArray(args.retryPrompt)) {
        msg = args.retryPrompt;
    }
    else if (typeof args.prompt === &#x27;object&#x27; &#x26;&#x26; !Array.isArray(args.prompt)) {
        msg = args.prompt;
    }
    else {
        msg = this.createPrompt(session, args, retry);
    }
    session.send(msg);
    session.sendBatch();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ReceiptCard" id="apidoc.module.botbuilder.ReceiptCard">module botbuilder.ReceiptCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.ReceiptCard" id="apidoc.element.botbuilder.ReceiptCard.ReceiptCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReceiptCard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.card.receipt&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ReceiptCard.prototype" id="apidoc.module.botbuilder.ReceiptCard.prototype">module botbuilder.ReceiptCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.buttons" id="apidoc.element.botbuilder.ReceiptCard.prototype.buttons">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>buttons
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buttons = function (list) {
    this.data.content.buttons = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var action = list[i];
            this.data.content.buttons.push(action.toAction ? action.toAction() : action);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                    CardAction_1.CardAction.imBack(null, old.message, old.title) :
                    CardAction_1.CardAction.openUrl(null, old.url, old.title);
                if (old.image) {
                    btn.image(old.image);
                }
                list.push(btn);
            }
            card.<span class="apidocCodeKeywordSpan">buttons</span>(list);
        }
        return card.toAttachment();
    }
    else {
        return a;
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.facts" id="apidoc.element.botbuilder.ReceiptCard.prototype.facts">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>facts
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">facts = function (list) {
    this.data.content.facts = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var fact = list[i];
            this.data.content.facts.push(fact.toFact ? fact.toFact() : fact);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.items" id="apidoc.element.botbuilder.ReceiptCard.prototype.items">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>items
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">items = function (list) {
    this.data.content.items = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var item = list[i];
            this.data.content.items.push(item.toItem ? item.toItem() : item);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.tap" id="apidoc.element.botbuilder.ReceiptCard.prototype.tap">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>tap
        <span class="apidocSignatureSpan">(action)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tap = function (action) {
    if (action) {
        this.data.content.tap = action.toAction ? action.toAction() : action;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.<span class="apidocCodeKeywordSpan">tap</span>(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.imBack(null, old.message, old.title) :
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.tax" id="apidoc.element.botbuilder.ReceiptCard.prototype.tax">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>tax
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tax = function (v) {
    this.data.content.tax = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.title" id="apidoc.element.botbuilder.ReceiptCard.prototype.title">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>title
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">title = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.title = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.<span class="apidocCodeKeywordSpan">title</span>(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
        card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.toAttachment" id="apidoc.element.botbuilder.ReceiptCard.prototype.toAttachment">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>toAttachment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toAttachment = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            this.addAttachment(list[i]);
        }
    }
    return this;
};
Message.prototype.addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.<span class="apidocCodeKeywordSpan">toAttachment</span>() : attachment;
        a = this.upgradeAttachment(a);
        if (!this.data.attachments) {
            this.data.attachments = [a];
        }
        else {
            this.data.attachments.push(a);
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.total" id="apidoc.element.botbuilder.ReceiptCard.prototype.total">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>total
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">total = function (v) {
    this.data.content.total = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptCard.prototype.vat" id="apidoc.element.botbuilder.ReceiptCard.prototype.vat">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptCard.prototype.</span>vat
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">vat = function (v) {
    this.data.content.vat = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ReceiptItem" id="apidoc.module.botbuilder.ReceiptItem">module botbuilder.ReceiptItem</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.ReceiptItem" id="apidoc.element.botbuilder.ReceiptItem.ReceiptItem">
        function <span class="apidocSignatureSpan">botbuilder.</span>ReceiptItem
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReceiptItem(session) {
    this.session = session;
    this.data = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.create" id="apidoc.element.botbuilder.ReceiptItem.create">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.</span>create
        <span class="apidocSignatureSpan">(session, price, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (session, price, title) {
    return new ReceiptItem(session).price(price).title(title);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



&#x22;use strict&#x22;;
var __extends = (this &#x26;&#x26; this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.<span class="apidocCodeKeywordSpan">create</span>(b) : (__.prototype = b.prototype, new __
());
};
var Dialog_1 = require(&#x22;./dialogs/Dialog&#x22;);
var Message_1 = require(&#x22;./Message&#x22;);
var consts = require(&#x22;./consts&#x22;);
var logger = require(&#x22;./logger&#x22;);
var sprintf = require(&#x22;sprintf-js&#x22;);
var events = require(&#x22;events&#x22;);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ReceiptItem.prototype" id="apidoc.module.botbuilder.ReceiptItem.prototype">module botbuilder.ReceiptItem.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.image" id="apidoc.element.botbuilder.ReceiptItem.prototype.image">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>image
        <span class="apidocSignatureSpan">(img)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">image = function (img) {
    if (img) {
        this.data.image = img.toImage ? img.toImage() : img;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        var list = [];
        for (var i = 0; i &#x3c; v2.actions.length; i++) {
            var old = v2.actions[i];
            var btn = old.message ?
                CardAction_1.CardAction.imBack(null, old.message, old.title) :
                CardAction_1.CardAction.openUrl(null, old.url, old.title);
            if (old.image) {
                btn.<span class="apidocCodeKeywordSpan">image</span>(old.image);
            }
            list.push(btn);
        }
        card.buttons(list);
    }
    return card.toAttachment();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.price" id="apidoc.element.botbuilder.ReceiptItem.prototype.price">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>price
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">price = function (v) {
    this.data.price = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.quantity" id="apidoc.element.botbuilder.ReceiptItem.prototype.quantity">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>quantity
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">quantity = function (v) {
    this.data.quantity = v || &#x27;&#x27;;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.subtitle" id="apidoc.element.botbuilder.ReceiptItem.prototype.subtitle">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>subtitle
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subtitle = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.subtitle = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.tap" id="apidoc.element.botbuilder.ReceiptItem.prototype.tap">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>tap
        <span class="apidocSignatureSpan">(action)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tap = function (action) {
    if (action) {
        this.data.tap = action.toAction ? action.toAction() : action;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.<span class="apidocCodeKeywordSpan">tap</span>(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.imBack(null, old.message, old.title) :
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.text" id="apidoc.element.botbuilder.ReceiptItem.prototype.text">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>text
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.text = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.title" id="apidoc.element.botbuilder.ReceiptItem.prototype.title">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>title
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">title = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.title = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.<span class="apidocCodeKeywordSpan">title</span>(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
        card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ReceiptItem.prototype.toItem" id="apidoc.element.botbuilder.ReceiptItem.prototype.toItem">
        function <span class="apidocSignatureSpan">botbuilder.ReceiptItem.prototype.</span>toItem
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toItem = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.RegExpRecognizer" id="apidoc.module.botbuilder.RegExpRecognizer">module botbuilder.RegExpRecognizer</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.RegExpRecognizer.RegExpRecognizer" id="apidoc.element.botbuilder.RegExpRecognizer.RegExpRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>RegExpRecognizer
        <span class="apidocSignatureSpan">(intent, expressions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function RegExpRecognizer(intent, expressions) {
    this.intent = intent;
    if (expressions instanceof RegExp || typeof expressions.exec === &#x27;function&#x27;) {
        this.expressions = { &#x27;*&#x27;: expressions };
    }
    else {
        this.expressions = (expressions || {});
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.RegExpRecognizer.prototype" id="apidoc.module.botbuilder.RegExpRecognizer.prototype">module botbuilder.RegExpRecognizer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.RegExpRecognizer.prototype.recognize" id="apidoc.element.botbuilder.RegExpRecognizer.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.RegExpRecognizer.prototype.</span>recognize
        <span class="apidocSignatureSpan">(context, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (context, cb) {
    var result = { score: 0.0, intent: null };
    if (context &#x26;&#x26; context.message &#x26;&#x26; context.message.text) {
        var utterance = context.message.text;
        var locale = context.locale || &#x27;*&#x27;;
        var exp = this.expressions.hasOwnProperty(locale) ? this.expressions[locale] : this.expressions[&#x27;*&#x27;];
        if (exp) {
            var matches = exp.exec(context.message.text);
            if (matches &#x26;&#x26; matches.length) {
                var matched = matches[0];
                result.score = matched.length / context.message.text.length;
                result.intent = this.intent;
                result.expression = exp;
                result.matched = matches;
            }
            cb(null, result);
        }
        else {
            cb(new Error(&#x22;Expression not found for locale &#x27;&#x22; + locale + &#x22;&#x27;.&#x22;), null);
        }
    }
    else {
        cb(null, result);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Session" id="apidoc.module.botbuilder.Session">module botbuilder.Session</a></h1>




    <h2>
        <a href="#apidoc.element.botbuilder.Session.Session" id="apidoc.element.botbuilder.Session.Session">
        function <span class="apidocSignatureSpan">botbuilder.</span>Session
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Session(options) {
    var _this = _super.call(this) || this;
    _this.options = options;
    _this.msgSent = false;
    _this._isReset = false;
    _this.lastSendTime = new Date().getTime();
    _this.batch = [];
    _this.batchStarted = false;
    _this.sendingBatch = false;
    _this.inMiddleware = false;
    _this._locale = null;
    _this.localizer = null;
    _this.library = options.library;
    _this.localizer = options.localizer;
    if (typeof _this.options.autoBatchDelay !== &#x27;number&#x27;) {
        _this.options.autoBatchDelay = 250;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.EventEmitter" id="apidoc.element.botbuilder.Session.EventEmitter">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>EventEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.activeDialogStackEntry" id="apidoc.element.botbuilder.Session.activeDialogStackEntry">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>activeDialogStackEntry
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">activeDialogStackEntry = function (stack) {
    return stack &#x26;&#x26; stack.length &#x3e; 0 ? stack[stack.length - 1] : null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    stack.push(entry);
    return entry;
};
Session.popDialogStackEntry = function (stack) {
    if (stack &#x26;&#x26; stack.length &#x3e; 0) {
        stack.pop();
    }
    return Session.<span class="apidocCodeKeywordSpan">activeDialogStackEntry</span>(stack);
};
Session.pruneDialogStack = function (stack, start) {
    if (stack &#x26;&#x26; stack.length &#x3e; 0) {
        stack.splice(start);
    }
    return Session.activeDialogStackEntry(stack);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.findDialogStackEntry" id="apidoc.element.botbuilder.Session.findDialogStackEntry">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>findDialogStackEntry
        <span class="apidocSignatureSpan">(stack, dialogId, reverse)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findDialogStackEntry = function (stack, dialogId, reverse) {
    if (reverse === void 0) { reverse = false; }
    var step = reverse ? -1 : 1;
    var l = stack ? stack.length : 0;
    for (var i = step &#x3e; 0 ? 0 : l - 1; i &#x3e;= 0 &#x26;&#x26; i &#x3c; l; i += step) {
        if (stack[i].id === dialogId) {
            return i;
        }
    }
    return -1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.forEachDialogStackEntry" id="apidoc.element.botbuilder.Session.forEachDialogStackEntry">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>forEachDialogStackEntry
        <span class="apidocSignatureSpan">(stack, reverse, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEachDialogStackEntry = function (stack, reverse, fn) {
    var step = reverse ? -1 : 1;
    var l = stack ? stack.length : 0;
    for (var i = step &#x3e; 0 ? 0 : l - 1; i &#x3e;= 0 &#x26;&#x26; i &#x3c; l; i += step) {
        fn(stack[i], i);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (stack &#x26;&#x26; stack.length &#x3e; 0) {
        stack.splice(start);
    }
    return Session.activeDialogStackEntry(stack);
};
Session.validateDialogStack = function (stack, root) {
    var valid = true;
    Session.<span class="apidocCodeKeywordSpan">forEachDialogStackEntry</span>(stack, false, function (entry) {
        var pair = entry.id.split(&#x27;:&#x27;);
        if (!root.findDialog(pair[0], pair[1])) {
            valid = false;
        }
    });
    return valid;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.init" id="apidoc.element.botbuilder.Session.init">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  this.domain = null;
  if (EventEmitter.usingDomains) {
    // if there is an active domain, then attach to it.
    domain = domain || require(&#x27;domain&#x27;);
    if (domain.active &#x26;&#x26; !(this instanceof domain.Domain)) {
      this.domain = domain.active;
    }
  }

  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {
    this._events = new EventHandlers();
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.listenerCount" id="apidoc.element.botbuilder.Session.listenerCount">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>listenerCount
        <span class="apidocSignatureSpan">(emitter, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenerCount = function (emitter, type) {
  if (typeof emitter.listenerCount === &#x27;function&#x27;) {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.popDialogStackEntry" id="apidoc.element.botbuilder.Session.popDialogStackEntry">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>popDialogStackEntry
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">popDialogStackEntry = function (stack) {
    if (stack &#x26;&#x26; stack.length &#x3e; 0) {
        stack.pop();
    }
    return Session.activeDialogStackEntry(stack);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.pruneDialogStack" id="apidoc.element.botbuilder.Session.pruneDialogStack">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>pruneDialogStack
        <span class="apidocSignatureSpan">(stack, start)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pruneDialogStack = function (stack, start) {
    if (stack &#x26;&#x26; stack.length &#x3e; 0) {
        stack.splice(start);
    }
    return Session.activeDialogStackEntry(stack);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.pushDialogStackEntry" id="apidoc.element.botbuilder.Session.pushDialogStackEntry">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>pushDialogStackEntry
        <span class="apidocSignatureSpan">(stack, entry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushDialogStackEntry = function (stack, entry) {
    if (!entry.state) {
        entry.state = {};
    }
    stack = stack || [];
    stack.push(entry);
    return entry;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.validateDialogStack" id="apidoc.element.botbuilder.Session.validateDialogStack">
        function <span class="apidocSignatureSpan">botbuilder.Session.</span>validateDialogStack
        <span class="apidocSignatureSpan">(stack, root)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateDialogStack = function (stack, root) {
    var valid = true;
    Session.forEachDialogStackEntry(stack, false, function (entry) {
        var pair = entry.id.split(&#x27;:&#x27;);
        if (!root.findDialog(pair[0], pair[1])) {
            valid = false;
        }
    });
    return valid;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            valid = false;
        }
    });
    return valid;
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.<span class="apidocCodeKeywordSpan">validateDialogStack</span>(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.replyReceived(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.Session.prototype" id="apidoc.module.botbuilder.Session.prototype">module botbuilder.Session.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.beginDialog" id="apidoc.element.botbuilder.Session.prototype.beginDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>beginDialog
        <span class="apidocSignatureSpan">(id, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">beginDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.cancelDialog" id="apidoc.element.botbuilder.Session.prototype.cancelDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>cancelDialog
        <span class="apidocSignatureSpan">(dialogId, replaceWithId, replaceWithArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cancelDialog = function (dialogId, replaceWithId, replaceWithArgs) {
    var childId = typeof dialogId === &#x27;number&#x27; ? this.sessionState.callstack[dialogId].id : dialogId;
    var cur = this.deleteDialogs(dialogId);
    if (replaceWithId) {
        logger.info(this, &#x27;session.cancelDialog(%s)&#x27;, replaceWithId);
        var id = this.resolveDialogId(replaceWithId);
        var dialog = this.findDialog(id);
        this.pushDialog({ id: id, state: {} });
        this.startBatch();
        dialog.begin(this, replaceWithArgs);
    }
    else {
        logger.info(this, &#x27;session.cancelDialog()&#x27;);
        this.startBatch();
        if (cur) {
            var dialog = this.findDialog(cur.id);
            if (dialog) {
                dialog.dialogResumed(this, { resumed: Dialog_1.ResumeReason.canceled, response: null, childId: childId });
            }
            else {
                this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
            }
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    return this;
};
Session.prototype.cancelDialog = function (dialogId, replaceWithId, replaceWithArgs) {
    var childId = typeof dialogId === &#x27;number&#x27; ? this.sessionState.callstack[dialogId].id : dialogId;
    var cur = this.deleteDialogs(dialogId);
    if (replaceWithId) {
        logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">cancelDialog</span>(%s)&#x27;, replaceWithId);
        var id = this.resolveDialogId(replaceWithId);
        var dialog = this.findDialog(id);
        this.pushDialog({ id: id, state: {} });
        this.startBatch();
        dialog.begin(this, replaceWithArgs);
    }
    else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.clearDialogStack" id="apidoc.element.botbuilder.Session.prototype.clearDialogStack">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>clearDialogStack
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearDialogStack = function () {
    this.sessionState.callstack = [];
    this.dialogData = null;
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.constructor" id="apidoc.element.botbuilder.Session.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>constructor
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Session(options) {
    var _this = _super.call(this) || this;
    _this.options = options;
    _this.msgSent = false;
    _this._isReset = false;
    _this.lastSendTime = new Date().getTime();
    _this.batch = [];
    _this.batchStarted = false;
    _this.sendingBatch = false;
    _this.inMiddleware = false;
    _this._locale = null;
    _this.localizer = null;
    _this.library = options.library;
    _this.localizer = options.localizer;
    if (typeof _this.options.autoBatchDelay !== &#x27;number&#x27;) {
        _this.options.autoBatchDelay = 250;
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.createMessage" id="apidoc.element.botbuilder.Session.prototype.createMessage">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>createMessage
        <span class="apidocSignatureSpan">(localizationNamespace, text, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createMessage = function (localizationNamespace, text, args) {
    var message = new Message_1.Message(this)
        .text(this.vgettext(localizationNamespace, Message_1.Message.randomPrompt(text), args));
    return message.toMessage();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
for (var _i = 2; _i &#x3c; arguments.length; _i++) {
    args[_i - 2] = arguments[_i];
}
this.msgSent = true;
if (message) {
    var m;
    if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
        m = this.<span class="apidocCodeKeywordSpan">createMessage</span>(localizationNamespace, message, args);
    }
    else if (message.toMessage) {
        m = message.toMessage();
    }
    else {
        m = message;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.curDialog" id="apidoc.element.botbuilder.Session.prototype.curDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>curDialog
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">curDialog = function () {
    var cur;
    var ss = this.sessionState;
    if (ss.callstack.length &#x3e; 0) {
        cur = ss.callstack[ss.callstack.length - 1];
    }
    return cur;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    else {
        _this.inMiddleware = false;
        _this.sessionState.lastAccess = now;
        done();
    }
};
this.sessionState = sessionState || { callstack: [], lastAccess: now, version: 0.0 };
var cur = this.<span class="apidocCodeKeywordSpan">curDialog</span>();
if (cur) {
    this.dialogData = cur.state;
}
this.inMiddleware = true;
this.message = (message || { text: &#x27;&#x27; });
if (!this.message.type) {
    this.message.type = consts.messageType;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.curLibraryName" id="apidoc.element.botbuilder.Session.prototype.curLibraryName">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>curLibraryName
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">curLibraryName = function () {
    var cur = this.curDialog();
    return cur &#x26;&#x26; !this.inMiddleware ? cur.id.split(&#x27;:&#x27;)[0] : this.library.name;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this._locale;
};
Session.prototype.gettext = function (messageid) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    return this.vgettext(this.<span class="apidocCodeKeywordSpan">curLibraryName</span>(), messageid, args);
};
Session.prototype.ngettext = function (messageid, messageid_plural, count) {
    var tmpl;
    if (this.localizer &#x26;&#x26; this.message) {
        tmpl = this.localizer.ngettext(this.preferredLocale(), messageid, messageid_plural, count, this.curLibraryName());
    }
    else if (count == 1) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.deleteDialogs" id="apidoc.element.botbuilder.Session.prototype.deleteDialogs">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>deleteDialogs
        <span class="apidocSignatureSpan">(dialogId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteDialogs = function (dialogId) {
    var ss = this.sessionState;
    var index = -1;
    if (typeof dialogId === &#x27;string&#x27;) {
        for (var i = ss.callstack.length - 1; i &#x3e;= 0; i--) {
            if (ss.callstack[i].id == dialogId) {
                index = i;
                break;
            }
        }
    }
    else {
        index = dialogId;
    }
    if (index &#x3c; 0 &#x26;&#x26; index &#x3c; ss.callstack.length) {
        throw new Error(&#x27;Unable to cancel dialog. Dialog[&#x27; + dialogId + &#x27;] not found.&#x27;);
    }
    ss.callstack.splice(index);
    var cur = this.curDialog();
    this.dialogData = cur ? cur.state : null;
    return cur;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            }
        }
    }
    return this;
};
Session.prototype.cancelDialog = function (dialogId, replaceWithId, replaceWithArgs) {
    var childId = typeof dialogId === &#x27;number&#x27; ? this.sessionState.callstack[dialogId].id : dialogId;
    var cur = this.<span class="apidocCodeKeywordSpan">deleteDialogs</span>(dialogId);
    if (replaceWithId) {
        logger.info(this, &#x27;session.cancelDialog(%s)&#x27;, replaceWithId);
        var id = this.resolveDialogId(replaceWithId);
        var dialog = this.findDialog(id);
        this.pushDialog({ id: id, state: {} });
        this.startBatch();
        dialog.begin(this, replaceWithArgs);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.dialogStack" id="apidoc.element.botbuilder.Session.prototype.dialogStack">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>dialogStack
        <span class="apidocSignatureSpan">(newStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogStack = function (newStack) {
    var stack;
    if (newStack) {
        stack = this.sessionState.callstack = newStack;
        this.dialogData = stack.length &#x3e; 0 ? stack[stack.length - 1].state : null;
    }
    else {
        stack = this.sessionState.callstack || [];
        if (stack.length &#x3e; 0) {
            stack[stack.length - 1].state = this.dialogData || {};
        }
    }
    return stack.slice(0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var _this = this;
return {
    message: this.message,
    userData: this.userData,
    conversationData: this.conversationData,
    privateConversationData: this.privateConversationData,
    localizer: this.localizer,
    dialogStack: function () { return _this.<span class="apidocCodeKeywordSpan">dialogStack</span>(); },
    preferredLocale: function () { return _this.preferredLocale(); },
    gettext: function () {
        var args = [];
        for (var _i = 0; _i &#x3c; arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        return Session.prototype.gettext.call(_this, args);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.dispatch" id="apidoc.element.botbuilder.Session.prototype.dispatch">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>dispatch
        <span class="apidocSignatureSpan">(sessionState, message, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (sessionState, message, done) {
    var _this = this;
    var index = 0;
    var session = this;
    var now = new Date().getTime();
    var middleware = this.options.middleware || [];
    var next = function () {
        var handler = index &#x3c; middleware.length ? middleware[index] : null;
        if (handler) {
            index++;
            handler(session, next);
        }
        else {
            _this.inMiddleware = false;
            _this.sessionState.lastAccess = now;
            done();
        }
    };
    this.sessionState = sessionState || { callstack: [], lastAccess: now, version: 0.0 };
    var cur = this.curDialog();
    if (cur) {
        this.dialogData = cur.state;
    }
    this.inMiddleware = true;
    this.message = (message || { text: &#x27;&#x27; });
    if (!this.message.type) {
        this.message.type = consts.messageType;
    }
    var locale = this.preferredLocale();
    this.localizer.load(locale, function (err) {
        if (err) {
            _this.error(err);
        }
        else {
            next();
        }
    });
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.endConversation" id="apidoc.element.botbuilder.Session.prototype.endConversation">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endConversation
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endConversation = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var m;
    if (message) {
        if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
            m = this.createMessage(this.curLibraryName(), message, args);
        }
        else if (message.toMessage) {
            m = message.toMessage();
        }
        else {
            m = message;
        }
        this.msgSent = true;
        this.prepareMessage(m);
        this.batch.push(m);
    }
    this.privateConversationData = {};
    logger.info(this, &#x27;session.endConversation()&#x27;);
    var ss = this.sessionState;
    ss.callstack = [];
    this.sendBatch();
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
    });
    return this;
};
Session.prototype.error = function (err) {
    logger.info(this, &#x27;session.error()&#x27;);
    if (this.options.dialogErrorMessage) {
        this.<span class="apidocCodeKeywordSpan">endConversation</span>(this.options.dialogErrorMessage);
    }
    else {
        var locale = this.preferredLocale();
        this.endConversation(this.localizer.gettext(locale, &#x27;default_error&#x27;, consts.Library.system));
    }
    var m = err.toString();
    err = err instanceof Error ? err : new Error(m);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.endDialog" id="apidoc.element.botbuilder.Session.prototype.endDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endDialog
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endDialog = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (typeof message === &#x27;object&#x27; &#x26;&#x26; (message.hasOwnProperty(&#x27;response&#x27;) || message.hasOwnProperty(&#x27;resumed&#x27;) || message.hasOwnProperty
(&#x27;error&#x27;))) {
        console.warn(&#x27;Returning results via Session.endDialog() is deprecated. Use Session.endDialogWithResult() instead.&#x27;);
        return this.endDialogWithResult(message);
    }
    var cur = this.curDialog();
    if (cur) {
        var m;
        if (message) {
            if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
                m = this.createMessage(this.curLibraryName(), message, args);
            }
            else if (message.toMessage) {
                m = message.toMessage();
            }
            else {
                m = message;
            }
            this.msgSent = true;
            this.prepareMessage(m);
            this.batch.push(m);
        }
        logger.info(this, &#x27;session.endDialog()&#x27;);
        var childId = cur.id;
        cur = this.popDialog();
        this.startBatch();
        if (cur) {
            var dialog = this.findDialog(cur.id);
            if (dialog) {
                dialog.dialogResumed(this, { resumed: Dialog_1.ResumeReason.completed, response: true, childId: childId });
            }
            else {
                this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
            }
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.endDialog = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (typeof message === &#x27;object&#x27; &#x26;&#x26; (message.hasOwnProperty(&#x27;response&#x27;) || message.hasOwnProperty
(&#x27;resumed&#x27;) || message.hasOwnProperty(&#x27;error&#x27;))) {
        console.warn(&#x27;Returning results via Session.<span class="apidocCodeKeywordSpan">endDialog</span>() is deprecated. Use
 Session.endDialogWithResult() instead.&#x27;);
        return this.endDialogWithResult(message);
    }
    var cur = this.curDialog();
    if (cur) {
        var m;
        if (message) {
            if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.endDialogWithResult" id="apidoc.element.botbuilder.Session.prototype.endDialogWithResult">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>endDialogWithResult
        <span class="apidocSignatureSpan">(result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endDialogWithResult = function (result) {
    var cur = this.curDialog();
    if (cur) {
        result = result || {};
        if (!result.hasOwnProperty(&#x27;resumed&#x27;)) {
            result.resumed = Dialog_1.ResumeReason.completed;
        }
        result.childId = cur.id;
        logger.info(this, &#x27;session.endDialogWithResult()&#x27;);
        cur = this.popDialog();
        this.startBatch();
        if (cur) {
            var dialog = this.findDialog(cur.id);
            if (dialog) {
                dialog.dialogResumed(this, result);
            }
            else {
                this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
            }
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.endDialog = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (typeof message === &#x27;object&#x27; &#x26;&#x26; (message.hasOwnProperty(&#x27;response&#x27;) || message.hasOwnProperty
(&#x27;resumed&#x27;) || message.hasOwnProperty(&#x27;error&#x27;))) {
        console.warn(&#x27;Returning results via Session.endDialog() is deprecated. Use Session.<span class="apidocCodeKeywordSpan
">endDialogWithResult</span>() instead.&#x27;);
        return this.endDialogWithResult(message);
    }
    var cur = this.curDialog();
    if (cur) {
        var m;
        if (message) {
            if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.error" id="apidoc.element.botbuilder.Session.prototype.error">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>error
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">error = function (err) {
    logger.info(this, &#x27;session.error()&#x27;);
    if (this.options.dialogErrorMessage) {
        this.endConversation(this.options.dialogErrorMessage);
    }
    else {
        var locale = this.preferredLocale();
        this.endConversation(this.localizer.gettext(locale, &#x27;default_error&#x27;, consts.Library.system));
    }
    var m = err.toString();
    err = err instanceof Error ? err : new Error(m);
    this.emit(&#x27;error&#x27;, err);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (file.substring(file.length - 5).toLowerCase() == &#x22;.json&#x22;) {
        logger.debug(&#x22;localizer.load(%s) - Loading %s/%s&#x22;, locale, dir, file);
        _this.parseFile(locale, dir, file)
            .then(function (count) {
            entryCount += count;
            cb();
        }, function (err) {
            logger.<span class="apidocCodeKeywordSpan">error</span>(&#x22;localizer.load(%s) - Error reading %s/%s: %s&#x22;, locale
, dir, file, err.toString());
            cb();
        });
    }
    else {
        cb();
    }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.findDialog" id="apidoc.element.botbuilder.Session.prototype.findDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>findDialog
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findDialog = function (id) {
    var parts = id.split(&#x27;:&#x27;);
    return this.library.findDialog(parts[0] || this.library.name, parts[1]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.<span class="apidocCodeKeywordSpan">findDialog</span>(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.getMessageReceived" id="apidoc.element.botbuilder.Session.prototype.getMessageReceived">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>getMessageReceived
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMessageReceived = function () {
    console.warn(&#x22;Session.getMessageReceived() is deprecated. Use Session.message.sourceEvent instead.&#x22;);
    return this.message.sourceEvent;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.gettext" id="apidoc.element.botbuilder.Session.prototype.gettext">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>gettext
        <span class="apidocSignatureSpan">(messageid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gettext = function (messageid) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    return this.vgettext(this.curLibraryName(), messageid, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    return text ? this.getValue(text) : null;
};
DefaultLocalizer.prototype.gettext = function (locale, msgid, ns) {
    return this.trygettext(locale, msgid, ns) || msgid;
};
DefaultLocalizer.prototype.ngettext = function (locale, msgid, msgid_plural, count, ns) {
    return count == 1 ? this.<span class="apidocCodeKeywordSpan">gettext</span>(locale, msgid, ns) : this.gettext(locale, msgid_plural
, ns);
};
DefaultLocalizer.prototype.getFallback = function (locale) {
    if (locale) {
        var split = locale.indexOf(&#x22;-&#x22;);
        if (split != -1) {
            return locale.substring(0, split);
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.isReset" id="apidoc.element.botbuilder.Session.prototype.isReset">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>isReset
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isReset = function () {
    return this._isReset;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.messageSent" id="apidoc.element.botbuilder.Session.prototype.messageSent">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>messageSent
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">messageSent = function () {
    return this.msgSent;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.ngettext" id="apidoc.element.botbuilder.Session.prototype.ngettext">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>ngettext
        <span class="apidocSignatureSpan">(messageid, messageid_plural, count)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ngettext = function (messageid, messageid_plural, count) {
    var tmpl;
    if (this.localizer &#x26;&#x26; this.message) {
        tmpl = this.localizer.ngettext(this.preferredLocale(), messageid, messageid_plural, count, this.curLibraryName());
    }
    else if (count == 1) {
        tmpl = messageid;
    }
    else {
        tmpl = messageid_plural;
    }
    return sprintf.sprintf(tmpl, count);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        args[_i - 1] = arguments[_i];
    }
    return this.vgettext(this.curLibraryName(), messageid, args);
};
Session.prototype.ngettext = function (messageid, messageid_plural, count) {
    var tmpl;
    if (this.localizer &#x26;&#x26; this.message) {
        tmpl = this.localizer.<span class="apidocCodeKeywordSpan">ngettext</span>(this.preferredLocale(), messageid, messageid_plural
, count, this.curLibraryName());
    }
    else if (count == 1) {
        tmpl = messageid;
    }
    else {
        tmpl = messageid_plural;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.popDialog" id="apidoc.element.botbuilder.Session.prototype.popDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>popDialog
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">popDialog = function () {
    var ss = this.sessionState;
    if (ss.callstack.length &#x3e; 0) {
        ss.callstack.pop();
    }
    var cur = this.curDialog();
    this.dialogData = cur ? cur.state : null;
    return cur;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.<span class="apidocCodeKeywordSpan">popDialog</span>();
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
};
Session.prototype.endConversation = function (message) {
    var args = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.preferredLocale" id="apidoc.element.botbuilder.Session.prototype.preferredLocale">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>preferredLocale
        <span class="apidocSignatureSpan">(locale, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">preferredLocale = function (locale, callback) {
    if (locale) {
        this._locale = locale;
        if (this.userData) {
            this.userData[consts.Data.PreferredLocale] = locale;
        }
        if (this.localizer) {
            this.localizer.load(locale, callback);
        }
    }
    else if (!this._locale) {
        if (this.userData &#x26;&#x26; this.userData[consts.Data.PreferredLocale]) {
            this._locale = this.userData[consts.Data.PreferredLocale];
        }
        else if (this.message &#x26;&#x26; this.message.textLocale) {
            this._locale = this.message.textLocale;
        }
        else if (this.localizer) {
            this._locale = this.localizer.defaultLocale();
        }
    }
    return this._locale;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        return {
message: this.message,
userData: this.userData,
conversationData: this.conversationData,
privateConversationData: this.privateConversationData,
localizer: this.localizer,
dialogStack: function () { return _this.dialogStack(); },
preferredLocale: function () { return _this.<span class="apidocCodeKeywordSpan">preferredLocale</span>(); },
gettext: function () {
    var args = [];
    for (var _i = 0; _i &#x3c; arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    return Session.prototype.gettext.call(_this, args);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.prepareMessage" id="apidoc.element.botbuilder.Session.prototype.prepareMessage">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>prepareMessage
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepareMessage = function (msg) {
    if (!msg.type) {
        msg.type = &#x27;message&#x27;;
    }
    if (!msg.address) {
        msg.address = this.message.address;
    }
    if (!msg.textLocale &#x26;&#x26; this.message.textLocale) {
        msg.textLocale = this.message.textLocale;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
        else if (message.toMessage) {
            m = message.toMessage();
        }
        else {
            m = message;
        }
        this.<span class="apidocCodeKeywordSpan">prepareMessage</span>(m);
        this.batch.push(m);
        logger.info(this, &#x27;session.send()&#x27;);
    }
    this.startBatch();
    return this;
};
Session.prototype.sendTyping = function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.pushDialog" id="apidoc.element.botbuilder.Session.prototype.pushDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>pushDialog
        <span class="apidocSignatureSpan">(ds)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushDialog = function (ds) {
    var ss = this.sessionState;
    var cur = this.curDialog();
    if (cur) {
        cur.state = this.dialogData || {};
    }
    ss.callstack.push(ds);
    this.dialogData = ds.state || {};
    return ds;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.<span class="apidocCodeKeywordSpan">pushDialog</span>({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.replaceDialog" id="apidoc.element.botbuilder.Session.prototype.replaceDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>replaceDialog
        <span class="apidocSignatureSpan">(id, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.popDialog();
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">replaceDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.popDialog();
    this.pushDialog({ id: id, state: {} });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.reset" id="apidoc.element.botbuilder.Session.prototype.reset">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>reset
        <span class="apidocSignatureSpan">(dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (dialogId, dialogArgs) {
    logger.info(this, &#x27;session.reset()&#x27;);
    this._isReset = true;
    this.sessionState.callstack = [];
    if (!dialogId) {
        dialogId = this.options.dialogId;
        dialogArgs = this.options.dialogArgs;
    }
    this.beginDialog(dialogId, dialogArgs);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
            }
        }
    }
    return this;
};
Session.prototype.reset = function (dialogId, dialogArgs) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">reset</span>()&#x27;);
    this._isReset = true;
    this.sessionState.callstack = [];
    if (!dialogId) {
        dialogId = this.options.dialogId;
        dialogArgs = this.options.dialogArgs;
    }
    this.beginDialog(dialogId, dialogArgs);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.resolveDialogId" id="apidoc.element.botbuilder.Session.prototype.resolveDialogId">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>resolveDialogId
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolveDialogId = function (id) {
    return id.indexOf(&#x27;:&#x27;) &#x3e;= 0 ? id : this.curLibraryName() + &#x27;:&#x27; + id;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
    var id = this.<span class="apidocCodeKeywordSpan">resolveDialogId</span>(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.begin(this, args);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.routeToActiveDialog" id="apidoc.element.botbuilder.Session.prototype.routeToActiveDialog">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>routeToActiveDialog
        <span class="apidocSignatureSpan">(recognizeResult)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.replyReceived(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.save" id="apidoc.element.botbuilder.Session.prototype.save">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>save
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function () {
    logger.info(this, &#x27;session.save()&#x27;);
    this.startBatch();
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    else {
        tmpl = messageid_plural;
    }
    return sprintf.sprintf(tmpl, count);
};
Session.prototype.save = function () {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">save</span>()&#x27;);
    this.startBatch();
    return this;
};
Session.prototype.send = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.send" id="apidoc.element.botbuilder.Session.prototype.send">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>send
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    args.unshift(this.curLibraryName(), message);
    return Session.prototype.sendLocalized.apply(this, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.<span class="apidocCodeKeywordSpan">send</span>(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
    console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.sendBatch" id="apidoc.element.botbuilder.Session.prototype.sendBatch">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendBatch
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendBatch = function (callback) {
    var _this = this;
    logger.info(this, &#x27;session.sendBatch() sending %d messages&#x27;, this.batch.length);
    if (this.sendingBatch) {
        return;
    }
    if (this.batchTimer) {
        clearTimeout(this.batchTimer);
        this.batchTimer = null;
    }
    this.batchTimer = null;
    var batch = this.batch;
    this.batch = [];
    this.batchStarted = false;
    this.sendingBatch = true;
    var cur = this.curDialog();
    if (cur) {
        cur.state = this.dialogData;
    }
    this.options.onSave(function (err) {
        if (!err) {
            if (batch.length) {
                _this.options.onSend(batch, function (err) {
                    _this.sendingBatch = false;
                    if (_this.batchStarted) {
                        _this.startBatch();
                    }
                    if (callback) {
                        callback(err);
                    }
                });
            }
            else {
                _this.sendingBatch = false;
                if (_this.batchStarted) {
                    _this.startBatch();
                }
                if (callback) {
                    callback(err);
                }
            }
        }
        else {
            _this.sendingBatch = false;
            switch (err.code || &#x27;&#x27;) {
                case consts.Errors.EBADMSG:
                case consts.Errors.EMSGSIZE:
                    _this.userData = {};
                    _this.batch = [];
                    _this.endConversation(_this.options.dialogErrorMessage || &#x27;Oops. Something went wrong and we need to start over
.&#x27;);
                    break;
            }
            if (callback) {
                callback(err);
            }
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.sendTyping = function () {
    this.msgSent = true;
    var m = { type: &#x27;typing&#x27; };
    this.prepareMessage(m);
    this.batch.push(m);
    logger.info(this, &#x27;session.sendTyping()&#x27;);
    this.<span class="apidocCodeKeywordSpan">sendBatch</span>();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.beginDialog(%s)&#x27;, id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.sendLocalized" id="apidoc.element.botbuilder.Session.prototype.sendLocalized">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendLocalized
        <span class="apidocSignatureSpan">(localizationNamespace, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendLocalized = function (localizationNamespace, message) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    this.msgSent = true;
    if (message) {
        var m;
        if (typeof message == &#x27;string&#x27; || Array.isArray(message)) {
            m = this.createMessage(localizationNamespace, message, args);
        }
        else if (message.toMessage) {
            m = message.toMessage();
        }
        else {
            m = message;
        }
        this.prepareMessage(m);
        this.batch.push(m);
        logger.info(this, &#x27;session.send()&#x27;);
    }
    this.startBatch();
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.sendTyping" id="apidoc.element.botbuilder.Session.prototype.sendTyping">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>sendTyping
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendTyping = function () {
    this.msgSent = true;
    var m = { type: &#x27;typing&#x27; };
    this.prepareMessage(m);
    this.batch.push(m);
    logger.info(this, &#x27;session.sendTyping()&#x27;);
    this.sendBatch();
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this;
};
Session.prototype.sendTyping = function () {
    this.msgSent = true;
    var m = { type: &#x27;typing&#x27; };
    this.prepareMessage(m);
    this.batch.push(m);
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">sendTyping</span>()&#x27;);
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.startBatch" id="apidoc.element.botbuilder.Session.prototype.startBatch">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>startBatch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startBatch = function () {
    var _this = this;
    this.batchStarted = true;
    if (!this.sendingBatch) {
        if (this.batchTimer) {
            clearTimeout(this.batchTimer);
        }
        this.batchTimer = setTimeout(function () {
            _this.sendBatch();
        }, this.options.autoBatchDelay);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    else {
        tmpl = messageid_plural;
    }
    return sprintf.sprintf(tmpl, count);
};
Session.prototype.save = function () {
    logger.info(this, &#x27;session.save()&#x27;);
    this.<span class="apidocCodeKeywordSpan">startBatch</span>();
    return this;
};
Session.prototype.send = function (message) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.toRecognizeContext" id="apidoc.element.botbuilder.Session.prototype.toRecognizeContext">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>toRecognizeContext
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toRecognizeContext = function () {
    var _this = this;
    return {
        message: this.message,
        userData: this.userData,
        conversationData: this.conversationData,
        privateConversationData: this.privateConversationData,
        localizer: this.localizer,
        dialogStack: function () { return _this.dialogStack(); },
        preferredLocale: function () { return _this.preferredLocale(); },
        gettext: function () {
            var args = [];
            for (var _i = 0; _i &#x3c; arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return Session.prototype.gettext.call(_this, args);
        },
        ngettext: function () {
            var args = [];
            for (var _i = 0; _i &#x3c; arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return Session.prototype.ngettext.call(_this, args);
        },
        locale: this.preferredLocale()
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.validateCallstack" id="apidoc.element.botbuilder.Session.prototype.validateCallstack">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>validateCallstack
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateCallstack = function () {
    var ss = this.sessionState;
    for (var i = 0; i &#x3c; ss.callstack.length; i++) {
        var id = ss.callstack[i].id;
        if (!this.findDialog(id)) {
            return false;
        }
    }
    return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.Session.prototype.vgettext" id="apidoc.element.botbuilder.Session.prototype.vgettext">
        function <span class="apidocSignatureSpan">botbuilder.Session.prototype.</span>vgettext
        <span class="apidocSignatureSpan">(localizationNamespace, messageid, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">vgettext = function (localizationNamespace, messageid, args) {
    var tmpl;
    if (this.localizer &#x26;&#x26; this.message) {
        tmpl = this.localizer.gettext(this.preferredLocale(), messageid, localizationNamespace);
    }
    else {
        tmpl = messageid;
    }
    return args &#x26;&#x26; args.length &#x3e; 0 ? sprintf.vsprintf(tmpl, args) : tmpl;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return this._locale;
};
Session.prototype.gettext = function (messageid) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    return this.<span class="apidocCodeKeywordSpan">vgettext</span>(this.curLibraryName(), messageid, args);
};
Session.prototype.ngettext = function (messageid, messageid_plural, count) {
    var tmpl;
    if (this.localizer &#x26;&#x26; this.message) {
        tmpl = this.localizer.ngettext(this.preferredLocale(), messageid, messageid_plural, count, this.curLibraryName());
    }
    else if (count == 1) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SigninCard" id="apidoc.module.botbuilder.SigninCard">module botbuilder.SigninCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SigninCard.SigninCard" id="apidoc.element.botbuilder.SigninCard.SigninCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>SigninCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SigninCard(session) {
    this.session = session;
    this.data = {
        contentType: &#x27;application/vnd.microsoft.card.signin&#x27;,
        content: {}
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SigninCard.prototype" id="apidoc.module.botbuilder.SigninCard.prototype">module botbuilder.SigninCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SigninCard.prototype.button" id="apidoc.element.botbuilder.SigninCard.prototype.button">
        function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>button
        <span class="apidocSignatureSpan">(title, url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">button = function (title, url) {
    if (title &#x26;&#x26; url) {
        this.data.content.buttons = [{
                type: &#x27;signin&#x27;,
                title: Message_1.fmtText(this.session, title),
                value: url
            }];
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SigninCard.prototype.text" id="apidoc.element.botbuilder.SigninCard.prototype.text">
        function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>text
        <span class="apidocSignatureSpan">(prompts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (prompts) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (prompts) {
        this.data.content.text = Message_1.fmtText(this.session, prompts, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SigninCard.prototype.toAttachment" id="apidoc.element.botbuilder.SigninCard.prototype.toAttachment">
        function <span class="apidocSignatureSpan">botbuilder.SigninCard.prototype.</span>toAttachment
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toAttachment = function () {
    return this.data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            this.addAttachment(list[i]);
        }
    }
    return this;
};
Message.prototype.addAttachment = function (attachment) {
    if (attachment) {
        var a = attachment.toAttachment ? attachment.<span class="apidocCodeKeywordSpan">toAttachment</span>() : attachment;
        a = this.upgradeAttachment(a);
        if (!this.data.attachments) {
            this.data.attachments = [a];
        }
        else {
            this.data.attachments.push(a);
        }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SimpleDialog" id="apidoc.module.botbuilder.SimpleDialog">module botbuilder.SimpleDialog</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog.SimpleDialog" id="apidoc.element.botbuilder.SimpleDialog.SimpleDialog">
        function <span class="apidocSignatureSpan">botbuilder.</span>SimpleDialog
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SimpleDialog(fn) {
    var _this = _super.call(this) || this;
    _this.fn = fn;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SimpleDialog.prototype" id="apidoc.module.botbuilder.SimpleDialog.prototype">module botbuilder.SimpleDialog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog.prototype.begin" id="apidoc.element.botbuilder.SimpleDialog.prototype.begin">
        function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>begin
        <span class="apidocSignatureSpan">(session, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">begin = function (session, args) {
    this.fn(session, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
    dialog.<span class="apidocCodeKeywordSpan">begin</span>(this, args);
    return this;
};
Session.prototype.replaceDialog = function (id, args) {
    logger.info(this, &#x27;session.replaceDialog(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog.prototype.constructor" id="apidoc.element.botbuilder.SimpleDialog.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>constructor
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SimpleDialog(fn) {
    var _this = _super.call(this) || this;
    _this.fn = fn;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog.prototype.dialogResumed" id="apidoc.element.botbuilder.SimpleDialog.prototype.dialogResumed">
        function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>dialogResumed
        <span class="apidocSignatureSpan">(session, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dialogResumed = function (session, result) {
    this.fn(session, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.info(this, &#x27;session.endDialog()&#x27;);
    var childId = cur.id;
    cur = this.popDialog();
    this.startBatch();
    if (cur) {
        var dialog = this.findDialog(cur.id);
        if (dialog) {
            dialog.<span class="apidocCodeKeywordSpan">dialogResumed</span>(this, { resumed: Dialog_1.ResumeReason.completed, response
: true, childId: childId });
        }
        else {
            this.error(new Error(&#x22;Can&#x27;t resume missing parent dialog &#x27;&#x22; + cur.id + &#x22;&#x27;.&#x22;));
        }
    }
}
return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.SimpleDialog.prototype.replyReceived" id="apidoc.element.botbuilder.SimpleDialog.prototype.replyReceived">
        function <span class="apidocSignatureSpan">botbuilder.SimpleDialog.prototype.</span>replyReceived
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replyReceived = function (session) {
    this.fn(session);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
Session.prototype.routeToActiveDialog = function (recognizeResult) {
    var dialogStack = this.dialogStack();
    if (Session.validateDialogStack(dialogStack, this.library)) {
        var active = Session.activeDialogStackEntry(dialogStack);
        if (active) {
            var dialog = this.findDialog(active.id);
            dialog.<span class="apidocCodeKeywordSpan">replyReceived</span>(this, recognizeResult);
        }
        else {
            this.beginDialog(this.options.dialogId, this.options.dialogArgs);
        }
    }
    else {
        this.error(new Error(&#x27;Invalid Dialog Stack.&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SimplePromptRecognizer" id="apidoc.module.botbuilder.SimplePromptRecognizer">module botbuilder.SimplePromptRecognizer</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SimplePromptRecognizer.SimplePromptRecognizer" id="apidoc.element.botbuilder.SimplePromptRecognizer.SimplePromptRecognizer">
        function <span class="apidocSignatureSpan">botbuilder.</span>SimplePromptRecognizer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function SimplePromptRecognizer() {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.SimplePromptRecognizer.prototype" id="apidoc.module.botbuilder.SimplePromptRecognizer.prototype">module botbuilder.SimplePromptRecognizer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.SimplePromptRecognizer.prototype.recognize" id="apidoc.element.botbuilder.SimplePromptRecognizer.prototype.recognize">
        function <span class="apidocSignatureSpan">botbuilder.SimplePromptRecognizer.prototype.</span>recognize
        <span class="apidocSignatureSpan">(args, callback, session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recognize = function (args, callback, session) {
    function findChoice(args, text) {
        var best = EntityRecognizer_1.EntityRecognizer.findBestMatch(args.enumValues, text);
        if (!best) {
            var n = EntityRecognizer_1.EntityRecognizer.parseNumber(text);
            if (!isNaN(n) &#x26;&#x26; n &#x3e; 0 &#x26;&#x26; n &#x3c;= args.enumValues.length) {
                best = { index: n - 1, entity: args.enumValues[n - 1], score: 1.0 };
            }
        }
        return best;
    }
    var score = 0.0;
    var response;
    var text = args.utterance.trim();
    switch (args.promptType) {
        default:
        case PromptType.text:
            score = 0.5;
            response = text;
            break;
        case PromptType.number:
            var n = EntityRecognizer_1.EntityRecognizer.parseNumber(text);
            if (!isNaN(n)) {
                var score = n.toString().length / text.length;
                response = n;
            }
            break;
        case PromptType.confirm:
            var b = EntityRecognizer_1.EntityRecognizer.parseBoolean(text);
            if (typeof b !== &#x27;boolean&#x27;) {
                var best = findChoice(args, text);
                if (best) {
                    b = (best.index === 0);
                }
            }
            if (typeof b == &#x27;boolean&#x27;) {
                score = 1.0;
                response = b;
            }
            break;
        case PromptType.time:
            var entity = EntityRecognizer_1.EntityRecognizer.recognizeTime(text, args.refDate ? new Date(args.refDate) : null);
            if (entity) {
                score = entity.entity.length / text.length;
                response = entity;
            }
            break;
        case PromptType.choice:
            var best = findChoice(args, text);
            if (best) {
                score = best.score;
                response = best;
            }
            break;
        case PromptType.attachment:
            if (args.attachments &#x26;&#x26; args.attachments.length &#x3e; 0) {
                score = 1.0;
                response = args.attachments;
            }
            break;
    }
    if (score &#x3e; 0) {
        callback({ score: score, resumed: Dialog_1.ResumeReason.completed, promptType: args.promptType, response: response });
    }
    else {
        callback({ score: score, resumed: Dialog_1.ResumeReason.notCompleted, promptType: args.promptType });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.TextBot" id="apidoc.module.botbuilder.TextBot">module botbuilder.TextBot</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.TextBot" id="apidoc.element.botbuilder.TextBot.TextBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>TextBot
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function TextBot(options) {
    if (options === void 0) { options = {}; }
    console.warn(&#x27;TextBot class is deprecated. Use UniversalBot with a ConsoleConnector class.&#x27;);
    var oBot = {};
    for (var key in options) {
        switch (key) {
            case &#x27;defaultDialogId&#x27;:
                oBot.defaultDialogId = options.defaultDialogId;
                break;
            case &#x27;defaultDialogArgs&#x27;:
                oBot.defaultDialogArgs = options.defaultDialogArgs;
                break;
            case &#x27;groupWelcomeMessage&#x27;:
                this.groupWelcomeMessage = options.groupWelcomeMessage;
                break;
            case &#x27;userWelcomeMessage&#x27;:
                this.userWelcomeMessage = options.userWelcomeMessage;
                break;
            case &#x27;goodbyeMessage&#x27;:
                this.goodbyeMessage = options.goodbyeMessage;
                break;
            case &#x27;userStore&#x27;:
            case &#x27;sessionStore&#x27;:
                console.error(&#x27;TextBot custom stores no longer supported. Use UniversalBot with a custom IBotStorage implementation
 instead.&#x27;);
                throw new Error(&#x27;TextBot custom stores no longer supported.&#x27;);
        }
    }
    this.connector = new ConsoleConnector_1.ConsoleConnector();
    this.bot = new UniversalBot_1.UniversalBot(this.connector, oBot);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.TextBot.prototype" id="apidoc.module.botbuilder.TextBot.prototype">module botbuilder.TextBot.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.add" id="apidoc.element.botbuilder.TextBot.prototype.add">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>add
        <span class="apidocSignatureSpan">(id, dialog)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (id, dialog) {
    this.bot.dialog(id, dialog);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.beginDialog" id="apidoc.element.botbuilder.TextBot.prototype.beginDialog">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>beginDialog
        <span class="apidocSignatureSpan">(address, dialogId, dialogArgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialog = function (address, dialogId, dialogArgs) {
    console.error(&#x22;TextBot.beginDialog() is no longer supported. The schema for sending proactive messages has changed and you should
 update your code to use the new UniversalBot class.&#x22;);
    throw new Error(&#x22;TextBot.beginDialog() is no longer supported.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">beginDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.configure" id="apidoc.element.botbuilder.TextBot.prototype.configure">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>configure
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configure = function (options) {
    console.error(&#x22;TextBot.configure() is no longer supported. You should either pass all options into the constructor or update
 code to use the new UniversalBot class.&#x22;);
    throw new Error(&#x22;TextBot.configure() is no longer supported.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.listenStdin" id="apidoc.element.botbuilder.TextBot.prototype.listenStdin">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>listenStdin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenStdin = function () {
    return this.connector.listen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.on" id="apidoc.element.botbuilder.TextBot.prototype.on">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>on
        <span class="apidocSignatureSpan">(event, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function (event, listener) {
    this.bot.on(event, listener);
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.TextBot.prototype.processMessage" id="apidoc.element.botbuilder.TextBot.prototype.processMessage">
        function <span class="apidocSignatureSpan">botbuilder.TextBot.prototype.</span>processMessage
        <span class="apidocSignatureSpan">(message, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processMessage = function (message, callback) {
    console.error(&#x22;TextBot.processMessage() is no longer supported. The schema for messages has changed and you should update your
 code to use the new UniversalBot class.&#x22;);
    throw new Error(&#x22;TextBot.processMessage() is no longer supported.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ThumbnailCard" id="apidoc.module.botbuilder.ThumbnailCard">module botbuilder.ThumbnailCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.ThumbnailCard" id="apidoc.element.botbuilder.ThumbnailCard.ThumbnailCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>ThumbnailCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ThumbnailCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.thumbnail&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.ThumbnailCard.prototype" id="apidoc.module.botbuilder.ThumbnailCard.prototype">module botbuilder.ThumbnailCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.constructor" id="apidoc.element.botbuilder.ThumbnailCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ThumbnailCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.thumbnail&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.images" id="apidoc.element.botbuilder.ThumbnailCard.prototype.images">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>images
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">images = function (list) {
    this.data.content.images = [];
    if (list) {
        for (var i = 0; i &#x3c; list.length; i++) {
            var image = list[i];
            this.data.content.images.push(image.toImage ? image.toImage() : image);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.<span class="apidocCodeKeywordSpan">images</span>([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.subtitle" id="apidoc.element.botbuilder.ThumbnailCard.prototype.subtitle">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>subtitle
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subtitle = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.subtitle = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.tap" id="apidoc.element.botbuilder.ThumbnailCard.prototype.tap">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>tap
        <span class="apidocSignatureSpan">(action)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tap = function (action) {
    if (action) {
        this.data.content.tap = action.toAction ? action.toAction() : action;
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (v2.text) {
    card.text(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.<span class="apidocCodeKeywordSpan">tap</span>(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
if (v2.actions) {
    var list = [];
    for (var i = 0; i &#x3c; v2.actions.length; i++) {
        var old = v2.actions[i];
        var btn = old.message ?
            CardAction_1.CardAction.imBack(null, old.message, old.title) :
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.text" id="apidoc.element.botbuilder.ThumbnailCard.prototype.text">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>text
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">text = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.text = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
var v2 = a;
var card = new HeroCard_1.HeroCard();
if (v2.title) {
    card.title(v2.title);
}
if (v2.text) {
    card.<span class="apidocCodeKeywordSpan">text</span>(v2.text);
}
if (v2.thumbnailUrl) {
    card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
}
if (v2.titleLink) {
    card.tap(CardAction_1.CardAction.openUrl(null, v2.titleLink));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.ThumbnailCard.prototype.title" id="apidoc.element.botbuilder.ThumbnailCard.prototype.title">
        function <span class="apidocSignatureSpan">botbuilder.ThumbnailCard.prototype.</span>title
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">title = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.title = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
if (isOldSchema) {
    console.warn(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.<span class="apidocCodeKeywordSpan">title</span>(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
    }
    if (v2.thumbnailUrl) {
        card.images([new CardImage_1.CardImage().url(v2.thumbnailUrl)]);
    }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.UniversalBot" id="apidoc.module.botbuilder.UniversalBot">module botbuilder.UniversalBot</a></h1>




    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.UniversalBot" id="apidoc.element.botbuilder.UniversalBot.UniversalBot">
        function <span class="apidocSignatureSpan">botbuilder.</span>UniversalBot
        <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function UniversalBot(connector, defaultDialog, libraryName) {
    var _this = _super.call(this, libraryName || consts.Library.default) || this;
    _this.settings = {
        processLimit: 4,
        persistUserData: true,
        persistConversationData: false
    };
    _this.connectors = {};
    _this.mwReceive = [];
    _this.mwSend = [];
    _this.mwSession = [];
    _this.localePath(&#x27;./locale/&#x27;);
    _this.library(Library_1.systemLib);
    if (defaultDialog) {
        if (typeof defaultDialog === &#x27;function&#x27; || Array.isArray(defaultDialog)) {
            _this.dialog(&#x27;/&#x27;, defaultDialog);
        }
        else {
            var settings = defaultDialog;
            for (var name in settings) {
                if (settings.hasOwnProperty(name)) {
                    _this.set(name, settings[name]);
                }
            }
        }
    }
    if (connector) {
        _this.connector(consts.defaultConnector, connector);
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var builder = require(&#x27;botbuilder&#x27;);

// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.<span class="apidocCodeKeywordSpan">UniversalBot</span>(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.send(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.EventEmitter" id="apidoc.element.botbuilder.UniversalBot.EventEmitter">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>EventEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.addRouteResult" id="apidoc.element.botbuilder.UniversalBot.addRouteResult">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>addRouteResult
        <span class="apidocSignatureSpan">(route, current)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRouteResult = function (route, current) {
    if (!current || current.length &#x3c; 1 || route.score &#x3e; current[0].score) {
        current = [route];
    }
    else if (route.score == current[0].score) {
        current.push(route);
    }
    return current;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.bestRouteResult" id="apidoc.element.botbuilder.UniversalBot.bestRouteResult">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>bestRouteResult
        <span class="apidocSignatureSpan">(routes, dialogStack, rootLibraryName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bestRouteResult = function (routes, dialogStack, rootLibraryName) {
    var bestLibrary = rootLibraryName;
    if (dialogStack) {
        dialogStack.forEach(function (entry) {
            var parts = entry.id.split(&#x27;:&#x27;);
            for (var i = 0; i &#x3c; routes.length; i++) {
                if (routes[i].libraryName == parts[0]) {
                    bestLibrary = parts[0];
                    break;
                }
            }
        });
    }
    var best;
    var bestPriority = 5;
    for (var i = 0; i &#x3c; routes.length; i++) {
        var r = routes[i];
        if (r.score &#x3e; 0.0) {
            var priority;
            switch (r.routeType) {
                default:
                    priority = 1;
                    break;
                case Library.RouteTypes.ActiveDialog:
                    priority = 2;
                    break;
                case Library.RouteTypes.StackAction:
                    priority = 3;
                    break;
                case Library.RouteTypes.GlobalAction:
                    priority = 4;
                    break;
            }
            if (priority &#x3c; bestPriority) {
                best = r;
                bestPriority = priority;
            }
            else if (priority == bestPriority) {
                switch (priority) {
                    case 3:
                        if (r.routeData.dialogIndex &#x3e; best.routeData.dialogIndex) {
                            best = r;
                        }
                        break;
                    case 4:
                        if (bestLibrary &#x26;&#x26; best.libraryName !== bestLibrary &#x26;&#x26; r.libraryName == bestLibrary) {
                            best = r;
                        }
                        break;
                }
            }
        }
    }
    return best;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.init" id="apidoc.element.botbuilder.UniversalBot.init">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  this.domain = null;
  if (EventEmitter.usingDomains) {
    // if there is an active domain, then attach to it.
    domain = domain || require(&#x27;domain&#x27;);
    if (domain.active &#x26;&#x26; !(this instanceof domain.Domain)) {
      this.domain = domain.active;
    }
  }

  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {
    this._events = new EventHandlers();
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.listenerCount" id="apidoc.element.botbuilder.UniversalBot.listenerCount">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.</span>listenerCount
        <span class="apidocSignatureSpan">(emitter, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenerCount = function (emitter, type) {
  if (typeof emitter.listenerCount === &#x27;function&#x27;) {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.UniversalBot.prototype" id="apidoc.module.botbuilder.UniversalBot.prototype">module botbuilder.UniversalBot.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.beginDialog" id="apidoc.element.botbuilder.UniversalBot.prototype.beginDialog">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>beginDialog
        <span class="apidocSignatureSpan">(address, dialogId, dialogArgs, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beginDialog = function (address, dialogId, dialogArgs, done) {
    var _this = this;
    this.lookupUser(address, function (user) {
        var msg = {
            type: consts.messageType,
            agent: consts.agent,
            source: address.channelId,
            sourceEvent: {},
            address: utils.clone(address),
            text: &#x27;&#x27;,
            user: user
        };
        _this.ensureConversation(msg.address, function (adr) {
            msg.address = adr;
            var conversationId = msg.address.conversation ? msg.address.conversation.id : null;
            var storageCtx = {
                userId: msg.user.id,
                conversationId: conversationId,
                address: msg.address,
                persistUserData: _this.settings.persistUserData,
                persistConversationData: _this.settings.persistConversationData
            };
            _this.dispatch(storageCtx, msg, dialogId, dialogArgs, _this.errorLogger(done), true);
        }, _this.errorLogger(done));
    }, this.errorLogger(done));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.sendBatch();
    return this;
};
Session.prototype.messageSent = function () {
    return this.msgSent;
};
Session.prototype.beginDialog = function (id, args) {
    logger.info(this, &#x27;session.<span class="apidocCodeKeywordSpan">beginDialog</span>(%s)&#x27;, id);
    var id = this.resolveDialogId(id);
    var dialog = this.findDialog(id);
    if (!dialog) {
        throw new Error(&#x27;Dialog[&#x27; + id + &#x27;] not found.&#x27;);
    }
    this.pushDialog({ id: id, state: {} });
    this.startBatch();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.clone" id="apidoc.element.botbuilder.UniversalBot.prototype.clone">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>clone
        <span class="apidocSignatureSpan">(copyTo, newName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function (copyTo, newName) {
    var obj = copyTo || new UniversalBot(null, null, newName || this.name);
    for (var name in this.settings) {
        if (this.settings.hasOwnProperty(name)) {
            this.set(name, this.settings[name]);
        }
    }
    for (var channel in this.connectors) {
        obj.connector(channel, this.connectors[channel]);
    }
    obj.mwReceive = this.mwReceive.slice(0);
    obj.mwSession = this.mwSession.slice(0);
    obj.mwSend = this.mwSend.slice(0);
    return _super.prototype.clone.call(this, obj);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else if (map.hasOwnProperty(&#x27;*&#x27;)) {
            this.data.sourceEvent = map[&#x27;*&#x27;];
        }
    }
    return this;
};
Message.prototype.toMessage = function () {
    return utils.<span class="apidocCodeKeywordSpan">clone</span>(this.data);
};
Message.prototype.upgradeAttachment = function (a) {
    var isOldSchema = false;
    for (var prop in a) {
        switch (prop) {
            case &#x27;actions&#x27;:
            case &#x27;fallbackText&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.connector" id="apidoc.element.botbuilder.UniversalBot.prototype.connector">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>connector
        <span class="apidocSignatureSpan">(channelId, connector)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connector = function (channelId, connector) {
    var _this = this;
    var c;
    if (connector) {
        this.connectors[channelId || consts.defaultConnector] = c = connector;
        c.onEvent(function (events, cb) { return _this.receive(events, cb); });
        var asStorage = connector;
        if (!this.settings.storage &#x26;&#x26;
            typeof asStorage.getData === &#x27;function&#x27; &#x26;&#x26;
            typeof asStorage.saveData === &#x27;function&#x27;) {
            this.settings.storage = asStorage;
        }
    }
    else if (this.connectors.hasOwnProperty(channelId)) {
        c = this.connectors[channelId];
    }
    else if (this.connectors.hasOwnProperty(consts.defaultConnector)) {
        c = this.connectors[consts.defaultConnector];
    }
    return c;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.constructor" id="apidoc.element.botbuilder.UniversalBot.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>constructor
        <span class="apidocSignatureSpan">(connector, defaultDialog, libraryName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function UniversalBot(connector, defaultDialog, libraryName) {
    var _this = _super.call(this, libraryName || consts.Library.default) || this;
    _this.settings = {
        processLimit: 4,
        persistUserData: true,
        persistConversationData: false
    };
    _this.connectors = {};
    _this.mwReceive = [];
    _this.mwSend = [];
    _this.mwSession = [];
    _this.localePath(&#x27;./locale/&#x27;);
    _this.library(Library_1.systemLib);
    if (defaultDialog) {
        if (typeof defaultDialog === &#x27;function&#x27; || Array.isArray(defaultDialog)) {
            _this.dialog(&#x27;/&#x27;, defaultDialog);
        }
        else {
            var settings = defaultDialog;
            for (var name in settings) {
                if (settings.hasOwnProperty(name)) {
                    _this.set(name, settings[name]);
                }
            }
        }
    }
    if (connector) {
        _this.connector(consts.defaultConnector, connector);
    }
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.createSession" id="apidoc.element.botbuilder.UniversalBot.prototype.createSession">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>createSession
        <span class="apidocSignatureSpan">(storageCtx, message, dialogId, dialogArgs, done, newStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createSession = function (storageCtx, message, dialogId, dialogArgs, done, newStack) {
    var _this = this;
    if (newStack === void 0) { newStack = false; }
    var loadedData;
    this.getStorageData(storageCtx, function (data) {
        if (!_this.localizer) {
            var defaultLocale = _this.settings.localizerSettings ? _this.settings.localizerSettings.defaultLocale : null;
            _this.localizer = new DefaultLocalizer_1.DefaultLocalizer(_this, defaultLocale);
        }
        var session = new Session_1.Session({
            localizer: _this.localizer,
            autoBatchDelay: _this.settings.autoBatchDelay,
            library: _this,
            middleware: _this.mwSession,
            dialogId: dialogId,
            dialogArgs: dialogArgs,
            dialogErrorMessage: _this.settings.dialogErrorMessage,
            onSave: function (cb) {
                var finish = _this.errorLogger(cb);
                loadedData.userData = utils.clone(session.userData);
                loadedData.conversationData = utils.clone(session.conversationData);
                loadedData.privateConversationData = utils.clone(session.privateConversationData);
                loadedData.privateConversationData[consts.Data.SessionState] = session.sessionState;
                _this.saveStorageData(storageCtx, loadedData, finish, finish);
            },
            onSend: function (messages, cb) {
                _this.send(messages, cb);
            }
        });
        session.on(&#x27;error&#x27;, function (err) { return _this.emitError(err); });
        var sessionState;
        session.userData = data.userData || {};
        session.conversationData = data.conversationData || {};
        session.privateConversationData = data.privateConversationData || {};
        if (session.privateConversationData.hasOwnProperty(consts.Data.SessionState)) {
            sessionState = newStack ? null : session.privateConversationData[consts.Data.SessionState];
            delete session.privateConversationData[consts.Data.SessionState];
        }
        loadedData = data;
        session.dispatch(sessionState, message, function () { return done(null, session); });
    }, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.dispatch" id="apidoc.element.botbuilder.UniversalBot.prototype.dispatch">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>dispatch
        <span class="apidocSignatureSpan">(storageCtx, message, dialogId, dialogArgs, done, newStack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatch = function (storageCtx, message, dialogId, dialogArgs, done, newStack) {
    var _this = this;
    if (newStack === void 0) { newStack = false; }
    this.createSession(storageCtx, message, dialogId, dialogArgs, function (err, session) {
        if (!err) {
            _this.emit(&#x27;routing&#x27;, session);
            _this.routeMessage(session, done);
        }
        else {
            done(err);
        }
    }, newStack);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.emitError" id="apidoc.element.botbuilder.UniversalBot.prototype.emitError">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>emitError
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emitError = function (err) {
    var m = err.toString();
    var e = err instanceof Error ? err : new Error(m);
    if (this.listenerCount(&#x27;error&#x27;) &#x3e; 0) {
        this.emit(&#x27;error&#x27;, e);
    }
    else {
        console.error(e.stack);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.ensureConversation" id="apidoc.element.botbuilder.UniversalBot.prototype.ensureConversation">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>ensureConversation
        <span class="apidocSignatureSpan">(address, done, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ensureConversation = function (address, done, error) {
    var _this = this;
    this.tryCatch(function () {
        if (!address.conversation) {
            var connector = _this.connector(address.channelId);
            if (!connector) {
                throw new Error(&#x22;Invalid channelId=&#x27;&#x22; + address.channelId + &#x22;&#x27;&#x22;);
            }
            connector.startConversation(address, function (err, adr) {
                if (!err) {
                    _this.tryCatch(function () { return done(adr); }, error);
                }
                else if (error) {
                    error(err);
                }
            });
        }
        else {
            _this.tryCatch(function () { return done(address); }, error);
        }
    }, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.errorLogger" id="apidoc.element.botbuilder.UniversalBot.prototype.errorLogger">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>errorLogger
        <span class="apidocSignatureSpan">(done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">errorLogger = function (done) {
    var _this = this;
    return function (err) {
        if (err) {
            _this.emitError(err);
        }
        if (done) {
            done(err);
            done = null;
        }
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.eventMiddleware" id="apidoc.element.botbuilder.UniversalBot.prototype.eventMiddleware">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>eventMiddleware
        <span class="apidocSignatureSpan">(event, middleware, done, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eventMiddleware = function (event, middleware, done, error) {
    var i = -1;
    var _that = this;
    function next() {
        if (++i &#x3c; middleware.length) {
            _that.tryCatch(function () {
                middleware[i](event, next);
            }, function () { return next(); });
        }
        else {
            _that.tryCatch(function () { return done(); }, error);
        }
    }
    next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.get" id="apidoc.element.botbuilder.UniversalBot.prototype.get">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>get
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (name) {
    return this.settings[name];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.getStorage" id="apidoc.element.botbuilder.UniversalBot.prototype.getStorage">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>getStorage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getStorage = function () {
    if (!this.settings.storage) {
        this.settings.storage = new BotStorage_1.MemoryBotStorage();
    }
    return this.settings.storage;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.getStorageData" id="apidoc.element.botbuilder.UniversalBot.prototype.getStorageData">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>getStorageData
        <span class="apidocSignatureSpan">(storageCtx, done, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getStorageData = function (storageCtx, done, error) {
    var _this = this;
    this.tryCatch(function () {
        _this.emit(&#x27;getStorageData&#x27;, storageCtx);
        var storage = _this.getStorage();
        storage.getData(storageCtx, function (err, data) {
            if (!err) {
                _this.tryCatch(function () { return done(data || {}); }, error);
            }
            else if (error) {
                error(err);
            }
        });
    }, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.isInConversation" id="apidoc.element.botbuilder.UniversalBot.prototype.isInConversation">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>isInConversation
        <span class="apidocSignatureSpan">(address, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isInConversation = function (address, cb) {
    var _this = this;
    this.lookupUser(address, function (user) {
        var conversationId = address.conversation ? address.conversation.id : null;
        var storageCtx = {
            userId: user.id,
            conversationId: conversationId,
            address: address,
            persistUserData: false,
            persistConversationData: false
        };
        _this.getStorageData(storageCtx, function (data) {
            var lastAccess;
            if (data &#x26;&#x26; data.privateConversationData &#x26;&#x26; data.privateConversationData.hasOwnProperty(consts.Data.SessionState)) {
                var ss = data.privateConversationData[consts.Data.SessionState];
                if (ss &#x26;&#x26; ss.lastAccess) {
                    lastAccess = new Date(ss.lastAccess);
                }
            }
            cb(null, lastAccess);
        }, _this.errorLogger(cb));
    }, this.errorLogger(cb));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.isMessage" id="apidoc.element.botbuilder.UniversalBot.prototype.isMessage">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>isMessage
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isMessage = function (message) {
    return (message &#x26;&#x26; message.type &#x26;&#x26; message.type.toLowerCase() == consts.messageType);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.loadSession" id="apidoc.element.botbuilder.UniversalBot.prototype.loadSession">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>loadSession
        <span class="apidocSignatureSpan">(address, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadSession = function (address, done) {
    var _this = this;
    this.lookupUser(address, function (user) {
        var msg = {
            type: consts.messageType,
            agent: consts.agent,
            source: address.channelId,
            sourceEvent: {},
            address: utils.clone(address),
            text: &#x27;&#x27;,
            user: user
        };
        _this.ensureConversation(msg.address, function (adr) {
            msg.address = adr;
            var conversationId = msg.address.conversation ? msg.address.conversation.id : null;
            var storageCtx = {
                userId: msg.user.id,
                conversationId: conversationId,
                address: msg.address,
                persistUserData: _this.settings.persistUserData,
                persistConversationData: _this.settings.persistConversationData
            };
            _this.createSession(storageCtx, msg, _this.settings.defaultDialogId || &#x27;/&#x27;, _this.settings.defaultDialogArgs, done);
        }, _this.errorLogger(done));
    }, this.errorLogger(done));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.lookupUser" id="apidoc.element.botbuilder.UniversalBot.prototype.lookupUser">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>lookupUser
        <span class="apidocSignatureSpan">(address, done, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lookupUser = function (address, done, error) {
    var _this = this;
    this.tryCatch(function () {
        _this.emit(&#x27;lookupUser&#x27;, address);
        if (_this.settings.lookupUser) {
            _this.settings.lookupUser(address, function (err, user) {
                if (!err) {
                    _this.tryCatch(function () { return done(user || address.user); }, error);
                }
                else if (error) {
                    error(err);
                }
            });
        }
        else {
            _this.tryCatch(function () { return done(address.user); }, error);
        }
    }, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.onDisambiguateRoute" id="apidoc.element.botbuilder.UniversalBot.prototype.onDisambiguateRoute">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>onDisambiguateRoute
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onDisambiguateRoute = function (handler) {
    this._onDisambiguateRoute = handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.receive" id="apidoc.element.botbuilder.UniversalBot.prototype.receive">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>receive
        <span class="apidocSignatureSpan">(events, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">receive = function (events, done) {
    var _this = this;
    var list = Array.isArray(events) ? events : [events];
    async.eachLimit(list, this.settings.processLimit, function (message, cb) {
        message.agent = consts.agent;
        message.type = message.type || consts.messageType;
        _this.lookupUser(message.address, function (user) {
            if (user) {
                message.user = user;
            }
            _this.emit(&#x27;receive&#x27;, message);
            _this.eventMiddleware(message, _this.mwReceive, function () {
                if (_this.isMessage(message)) {
                    _this.emit(&#x27;incoming&#x27;, message);
                    var userId = message.user.id;
                    var conversationId = message.address.conversation ? message.address.conversation.id : null;
                    var storageCtx = {
                        userId: userId,
                        conversationId: conversationId,
                        address: message.address,
                        persistUserData: _this.settings.persistUserData,
                        persistConversationData: _this.settings.persistConversationData
                    };
                    _this.dispatch(storageCtx, message, _this.settings.defaultDialogId || &#x27;/&#x27;, _this.settings.defaultDialogArgs,
cb);
                }
                else {
                    _this.emit(message.type, message);
                    cb(null);
                }
            }, cb);
        }, cb);
    }, this.errorLogger(done));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.routeMessage" id="apidoc.element.botbuilder.UniversalBot.prototype.routeMessage">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>routeMessage
        <span class="apidocSignatureSpan">(session, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">routeMessage = function (session, done) {
    var _this = this;
    var context = session.toRecognizeContext();
    this.recognize(context, function (err, topIntent) {
        if (session.message.entities) {
            session.message.entities.forEach(function (entity) {
                if (entity.type === consts.intentEntityType &#x26;&#x26;
                    entity.score &#x3e; topIntent.score) {
                    topIntent = entity;
                }
            });
        }
        context.intent = topIntent;
        context.libraryName = _this.name;
        var results = Library_1.Library.addRouteResult({ score: 0.0, libraryName: _this.name });
        async.each(_this.libraryList(), function (lib, cb) {
            lib.findRoutes(context, function (err, routes) {
                if (!err &#x26;&#x26; routes) {
                    routes.forEach(function (r) { return results = Library_1.Library.addRouteResult(r, results); });
                }
                cb(err);
            });
        }, function (err) {
            if (!err) {
                var disambiguateRoute = function (session, routes) {
                    var route = Library_1.Library.bestRouteResult(results, session.dialogStack(), _this.name);
                    if (route) {
                        _this.library(route.libraryName).selectRoute(session, route);
                    }
                    else {
                        session.routeToActiveDialog();
                    }
                };
                if (_this._onDisambiguateRoute) {
                    disambiguateRoute = _this._onDisambiguateRoute;
                }
                disambiguateRoute(session, results);
                done(null);
            }
            else {
                session.error(err);
                done(err);
            }
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.saveStorageData" id="apidoc.element.botbuilder.UniversalBot.prototype.saveStorageData">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>saveStorageData
        <span class="apidocSignatureSpan">(storageCtx, data, done, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saveStorageData = function (storageCtx, data, done, error) {
    var _this = this;
    this.tryCatch(function () {
        _this.emit(&#x27;saveStorageData&#x27;, storageCtx);
        var storage = _this.getStorage();
        storage.saveData(storageCtx, data, function (err) {
            if (!err) {
                if (done) {
                    _this.tryCatch(function () { return done(); }, error);
                }
            }
            else if (error) {
                error(err);
            }
        });
    }, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.send" id="apidoc.element.botbuilder.UniversalBot.prototype.send">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>send
        <span class="apidocSignatureSpan">(messages, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (messages, done) {
    var _this = this;
    var list;
    if (Array.isArray(messages)) {
        list = messages;
    }
    else if (messages.toMessage) {
        list = [messages.toMessage()];
    }
    else {
        list = [messages];
    }
    async.eachLimit(list, this.settings.processLimit, function (message, cb) {
        _this.ensureConversation(message.address, function (adr) {
            message.address = adr;
            _this.emit(&#x27;send&#x27;, message);
            _this.eventMiddleware(message, _this.mwSend, function () {
                _this.emit(&#x27;outgoing&#x27;, message);
                cb(null);
            }, cb);
        }, cb);
    }, this.errorLogger(function (err) {
        if (!err) {
            _this.tryCatch(function () {
                var channelId = list[0].address.channelId;
                var connector = _this.connector(channelId);
                if (!connector) {
                    throw new Error(&#x22;Invalid channelId=&#x27;&#x22; + channelId + &#x22;&#x27;&#x22;);
                }
                connector.send(list, _this.errorLogger(done));
            }, _this.errorLogger(done));
        }
        else if (done) {
            done(null);
        }
    }));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Create bot and add dialogs
var connector = new builder.ChatConnector({
    appId: &#x22;YourAppId&#x22;,
    appPassword: &#x22;YourAppSecret&#x22;
});
var bot = new builder.UniversalBot(connector);
bot.dialog(&#x27;/&#x27;, function (session) {
    session.<span class="apidocCodeKeywordSpan">send</span>(&#x27;Hello World&#x27;);
});

// Setup Restify Server
var server = restify.createServer();
server.post(&#x27;/api/messages&#x27;, connector.listen());
server.listen(process.env.port || 3978, function () {
    console.log(&#x27;%s listening to %s&#x27;, server.name, server.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.set" id="apidoc.element.botbuilder.UniversalBot.prototype.set">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>set
        <span class="apidocSignatureSpan">(name, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (name, value) {
    this.settings[name] = value;
    if (value &#x26;&#x26; name === &#x27;localizerSettings&#x27;) {
        var settings = value;
        if (settings.botLocalePath) {
            this.localePath(settings.botLocalePath);
        }
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.tryCatch" id="apidoc.element.botbuilder.UniversalBot.prototype.tryCatch">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>tryCatch
        <span class="apidocSignatureSpan">(fn, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tryCatch = function (fn, error) {
    try {
        fn();
    }
    catch (e) {
        try {
            if (error) {
                error(e);
            }
        }
        catch (e2) {
            this.emitError(e2);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.UniversalBot.prototype.use" id="apidoc.element.botbuilder.UniversalBot.prototype.use">
        function <span class="apidocSignatureSpan">botbuilder.UniversalBot.prototype.</span>use
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">use = function () {
    var _this = this;
    var args = [];
    for (var _i = 0; _i &#x3c; arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    args.forEach(function (mw) {
        var added = 0;
        if (mw.receive) {
            Array.prototype.push.apply(_this.mwReceive, Array.isArray(mw.receive) ? mw.receive : [mw.receive]);
            added++;
        }
        if (mw.send) {
            Array.prototype.push.apply(_this.mwSend, Array.isArray(mw.send) ? mw.send : [mw.send]);
            added++;
        }
        if (mw.botbuilder) {
            Array.prototype.push.apply(_this.mwSession, Array.isArray(mw.botbuilder) ? mw.botbuilder : [mw.botbuilder]);
            added++;
        }
        if (added &#x3c; 1) {
            console.warn(&#x27;UniversalBot.use: no compatible middleware hook found to install.&#x27;);
        }
    });
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.VideoCard" id="apidoc.module.botbuilder.VideoCard">module botbuilder.VideoCard</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.VideoCard.VideoCard" id="apidoc.element.botbuilder.VideoCard.VideoCard">
        function <span class="apidocSignatureSpan">botbuilder.</span>VideoCard
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function VideoCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.video&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.VideoCard.prototype" id="apidoc.module.botbuilder.VideoCard.prototype">module botbuilder.VideoCard.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.VideoCard.prototype.aspect" id="apidoc.element.botbuilder.VideoCard.prototype.aspect">
        function <span class="apidocSignatureSpan">botbuilder.VideoCard.prototype.</span>aspect
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">aspect = function (text) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    if (text) {
        this.data.content.aspect = Message_1.fmtText(this.session, text, args);
    }
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.VideoCard.prototype.constructor" id="apidoc.element.botbuilder.VideoCard.prototype.constructor">
        function <span class="apidocSignatureSpan">botbuilder.VideoCard.prototype.</span>constructor
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function VideoCard(session) {
    var _this = _super.call(this, session) || this;
    _this.data.contentType = &#x27;application/vnd.microsoft.card.video&#x27;;
    return _this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.logger" id="apidoc.module.botbuilder.logger">module botbuilder.logger</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.logger.debug" id="apidoc.element.botbuilder.logger.debug">
        function <span class="apidocSignatureSpan">botbuilder.logger.</span>debug
        <span class="apidocSignatureSpan">(fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function debug(fmt) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    debugLog(false, fmt, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    else {
        return this._defaultLocale;
    }
};
DefaultLocalizer.prototype.load = function (locale, done) {
    var _this = this;
    logger.<span class="apidocCodeKeywordSpan">debug</span>(&#x22;localizer.load(%s)&#x22;, locale);
    locale = locale ? locale : this._defaultLocale;
    var fbDefault = this.getFallback(this._defaultLocale);
    var fbLocale = this.getFallback(locale);
    var locales = [&#x27;en&#x27;];
    if (fbDefault !== &#x27;en&#x27;) {
        locales.push(fbDefault);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.logger.error" id="apidoc.element.botbuilder.logger.error">
        function <span class="apidocSignatureSpan">botbuilder.logger.</span>error
        <span class="apidocSignatureSpan">(fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function error(fmt) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var msg = args.length &#x3e; 0 ? sprintf.vsprintf(fmt, args) : fmt;
    console.error(&#x27;ERROR: &#x27; + msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (file.substring(file.length - 5).toLowerCase() == &#x22;.json&#x22;) {
        logger.debug(&#x22;localizer.load(%s) - Loading %s/%s&#x22;, locale, dir, file);
        _this.parseFile(locale, dir, file)
            .then(function (count) {
            entryCount += count;
            cb();
        }, function (err) {
            logger.<span class="apidocCodeKeywordSpan">error</span>(&#x22;localizer.load(%s) - Error reading %s/%s: %s&#x22;, locale
, dir, file, err.toString());
            cb();
        });
    }
    else {
        cb();
    }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.logger.info" id="apidoc.element.botbuilder.logger.info">
        function <span class="apidocSignatureSpan">botbuilder.logger.</span>info
        <span class="apidocSignatureSpan">(addressable, fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function info(addressable, fmt) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var channelId = Channel.getChannelId(addressable);
    if (channelId === Channel.channels.emulator || debugLoggingEnabled) {
        var prefix = getPrefix(addressable);
        var msg = args.length &#x3e; 0 ? sprintf.vsprintf(fmt, args) : fmt;
        console.info(prefix + msg);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else {
            next();
        }
    });
    return this;
};
Session.prototype.error = function (err) {
    logger.<span class="apidocCodeKeywordSpan">info</span>(this, &#x27;session.error()&#x27;);
    if (this.options.dialogErrorMessage) {
        this.endConversation(this.options.dialogErrorMessage);
    }
    else {
        var locale = this.preferredLocale();
        this.endConversation(this.localizer.gettext(locale, &#x27;default_error&#x27;, consts.Library.system));
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.logger.trace" id="apidoc.element.botbuilder.logger.trace">
        function <span class="apidocSignatureSpan">botbuilder.logger.</span>trace
        <span class="apidocSignatureSpan">(fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function trace(fmt) {
    var args = [];
    for (var _i = 1; _i &#x3c; arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    debugLog(true, fmt, args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
exports.trace = trace;
function debugLog(trace, fmt, args) {
if (!debugLoggingEnabled) {
    return;
}
var msg = args.length &#x3e; 0 ? sprintf.vsprintf(fmt, args) : fmt;
if (trace) {
    console.<span class="apidocCodeKeywordSpan">trace</span>(msg);
}
else {
    console.log(msg);
}
}
function getPrefix(addressable) {
var prefix = &#x27;&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.logger.warn" id="apidoc.element.botbuilder.logger.warn">
        function <span class="apidocSignatureSpan">botbuilder.logger.</span>warn
        <span class="apidocSignatureSpan">(addressable, fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function warn(addressable, fmt) {
    var args = [];
    for (var _i = 2; _i &#x3c; arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var prefix = getPrefix(addressable);
    var msg = args.length &#x3e; 0 ? sprintf.vsprintf(fmt, args) : fmt;
    console.warn(prefix + &#x27;WARN: &#x27; + msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        case &#x27;text&#x27;:
        case &#x27;thumbnailUrl&#x27;:
            isOldSchema = true;
            break;
    }
}
if (isOldSchema) {
    console.<span class="apidocCodeKeywordSpan">warn</span>(&#x27;Using old attachment schema. Upgrade to new card schema.&#x27;);
    var v2 = a;
    var card = new HeroCard_1.HeroCard();
    if (v2.title) {
        card.title(v2.title);
    }
    if (v2.text) {
        card.text(v2.text);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.botbuilder.utils" id="apidoc.module.botbuilder.utils">module botbuilder.utils</a></h1>


    <h2>
        <a href="#apidoc.element.botbuilder.utils.clone" id="apidoc.element.botbuilder.utils.clone">
        function <span class="apidocSignatureSpan">botbuilder.utils.</span>clone
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function clone(obj) {
    var cpy = {};
    if (obj) {
        for (var key in obj) {
            if (obj.hasOwnProperty(key)) {
                cpy[key] = obj[key];
            }
        }
    }
    return cpy;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        else if (map.hasOwnProperty(&#x27;*&#x27;)) {
            this.data.sourceEvent = map[&#x27;*&#x27;];
        }
    }
    return this;
};
Message.prototype.toMessage = function () {
    return utils.<span class="apidocCodeKeywordSpan">clone</span>(this.data);
};
Message.prototype.upgradeAttachment = function (a) {
    var isOldSchema = false;
    for (var prop in a) {
        switch (prop) {
            case &#x27;actions&#x27;:
            case &#x27;fallbackText&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.utils.copyFieldsTo" id="apidoc.element.botbuilder.utils.copyFieldsTo">
        function <span class="apidocSignatureSpan">botbuilder.utils.</span>copyFieldsTo
        <span class="apidocSignatureSpan">(frm, to, fields)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function copyFieldsTo(frm, to, fields) {
    if (frm &#x26;&#x26; to) {
        fields.split(&#x27;|&#x27;).forEach(function (f) {
            if (frm.hasOwnProperty(f)) {
                if (typeof to[f] === &#x27;function&#x27;) {
                    to[f](frm[f]);
                }
                else {
                    to[f] = frm[f];
                }
            }
        });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.utils.copyTo" id="apidoc.element.botbuilder.utils.copyTo">
        function <span class="apidocSignatureSpan">botbuilder.utils.</span>copyTo
        <span class="apidocSignatureSpan">(frm, to)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function copyTo(frm, to) {
    if (frm) {
        for (var key in frm) {
            if (frm.hasOwnProperty(key)) {
                if (typeof to[key] === &#x27;function&#x27;) {
                    to[key](frm[key]);
                }
                else {
                    to[key] = frm[key];
                }
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.utils.moveFieldsTo" id="apidoc.element.botbuilder.utils.moveFieldsTo">
        function <span class="apidocSignatureSpan">botbuilder.utils.</span>moveFieldsTo
        <span class="apidocSignatureSpan">(frm, to, fields)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function moveFieldsTo(frm, to, fields) {
    if (frm &#x26;&#x26; to) {
        for (var f in fields) {
            if (frm.hasOwnProperty(f)) {
                if (typeof to[f] === &#x27;function&#x27;) {
                    to[fields[f]](frm[f]);
                }
                else {
                    to[fields[f]] = frm[f];
                }
                delete frm[f];
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.botbuilder.utils.toDate8601" id="apidoc.element.botbuilder.utils.toDate8601">
        function <span class="apidocSignatureSpan">botbuilder.utils.</span>toDate8601
        <span class="apidocSignatureSpan">(date)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toDate8601(date) {
    return sprintf.sprintf(&#x27;%04d-%02d-%02d&#x27;, date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
